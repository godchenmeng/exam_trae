<Window x:Class="ExamSystem.UI.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="考试系统 - 主界面" 
        Height="800" 
        Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="{DynamicResource MaterialDesignPaper}">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- 顶部标题栏 -->
        <Border Grid.Row="0" Grid.ColumnSpan="2" 
                Background="{DynamicResource PrimaryHueMidBrush}" 
                Height="60">
            <Grid>
                <StackPanel Orientation="Horizontal" 
                           VerticalAlignment="Center" 
                           Margin="20,0">
                    <materialDesign:PackIcon Kind="School" 
                                           Width="32" 
                                           Height="32" 
                                           Foreground="White"
                                           VerticalAlignment="Center"/>
                    <TextBlock Text="考试系统" 
                              FontSize="20" 
                              FontWeight="Bold" 
                              Foreground="White"
                              VerticalAlignment="Center"
                              Margin="10,0,0,0"/>
                </StackPanel>
                
                <StackPanel Orientation="Horizontal" 
                           HorizontalAlignment="Right" 
                           VerticalAlignment="Center"
                           Margin="0,0,20,0">
                    <TextBlock Text="{Binding CurrentUser.RealName}" 
                              Foreground="White" 
                              VerticalAlignment="Center"
                              Margin="0,0,10,0"/>
                    <TextBlock Text="{Binding CurrentUser.Role}" 
                              Foreground="White" 
                              VerticalAlignment="Center"
                              Margin="0,0,20,0"/>
                    <Button Content="退出" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           Foreground="White"
                           Command="{Binding LogoutCommand}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 左侧导航菜单 -->
        <Border Grid.Row="1" Grid.Column="0" 
                Background="{DynamicResource MaterialDesignCardBackground}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="0,20,0,0">
                    
                    <!-- 仪表板 -->
                    <Button Content="仪表板" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="Dashboard">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ViewDashboard" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="仪表板" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 用户管理 (仅管理员可见) -->
                    <Button Content="用户管理" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="UserManagement"
                           Visibility="{Binding CanAccessUserManagement, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="AccountGroup" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="用户管理" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 题库管理 (管理员和教师可见) -->
                    <Button Content="题库管理" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="QuestionBank"
                           Visibility="{Binding CanAccessQuestionBank, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="BookOpenPageVariant" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="题库管理" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 试卷管理 (管理员和教师可见) -->
                    <Button Content="试卷管理" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="ExamPaper"
                           Visibility="{Binding CanAccessExamPaper, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="FileDocument" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="试卷管理" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 考试管理 (管理员和教师可见) -->
                    <Button Content="考试管理" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="ExamManagement"
                           Visibility="{Binding IsAdminOrTeacher, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ClipboardCheck" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="考试管理" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 成绩管理 (管理员和教师可见) -->
                    <Button Content="成绩管理" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="GradeManagement"
                           Visibility="{Binding CanAccessGradeManagement, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ChartLine" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="成绩管理" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 我的考试 (学生可见) -->
                    <Button Content="我的考试" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="MyExams"
                           Visibility="{Binding IsStudent, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="AccountSchool" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="我的考试" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 考试列表 (学生可见) -->
                    <Button Content="考试列表" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="ExamList"
                           Visibility="{Binding IsStudent, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="FormatListBulleted" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="考试列表" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 考试结果 (所有用户可见) -->
                    <Button Content="考试结果" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="ExamResult">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ChartBox" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="考试结果" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>

                    <!-- 系统设置 (仅管理员可见) -->
                    <Button Content="系统设置" 
                           Style="{StaticResource MaterialDesignFlatButton}"
                           HorizontalAlignment="Stretch"
                           HorizontalContentAlignment="Left"
                           Height="50"
                           Margin="10,5"
                           Command="{Binding NavigateCommand}"
                           CommandParameter="SystemSettings"
                           Visibility="{Binding CanAccessSystemSettings, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Settings" 
                                                       Width="20" Height="20" 
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>
                                <TextBlock Text="系统设置" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- 主内容区域 -->
        <Border Grid.Row="1" Grid.Column="1" 
                Background="{DynamicResource MaterialDesignBackground}"
                Margin="10">
            <ContentPresenter Content="{Binding CurrentView}"/>
        </Border>

        <!-- 底部状态栏 -->
        <Border Grid.Row="2" Grid.ColumnSpan="2" 
                Background="{DynamicResource MaterialDesignCardBackground}"
                BorderBrush="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,1,0,0"
                Height="30">
            <Grid>
                <TextBlock Text="就绪" 
                          VerticalAlignment="Center" 
                          Margin="20,0"/>
                <TextBlock Text="{Binding CurrentTime, StringFormat='yyyy-MM-dd HH:mm:ss'}" 
                          HorizontalAlignment="Right" 
                          VerticalAlignment="Center" 
                          Margin="0,0,20,0"/>
            </Grid>
        </Border>
    </Grid>
</Window>