<Window x:Class="ExamSystem.WPF.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        x:Name="RootWindow"
        Title="在线考试系统 - WPF版本" 
        Height="800" 
        Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5"
        FontFamily="Microsoft YaHei UI"
        FontSize="14">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题栏 -->
        <Border Grid.Row="0" 
                Background="#2196F3" 
                Padding="16">
            <DockPanel>
                <TextBlock Text="📚" 
                          DockPanel.Dock="Left"
                          FontSize="24" 
                          VerticalAlignment="Center" 
                          Margin="0,0,16,0"
                          Foreground="White"/>
                <TextBlock Text="在线考试系统" 
                          FontSize="20" 
                          FontWeight="Bold" 
                          VerticalAlignment="Center"
                          Foreground="White"/>
                
                <StackPanel Orientation="Horizontal" 
                           DockPanel.Dock="Right" 
                           HorizontalAlignment="Right">
                    <!-- 用户信息显示 -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="👤" FontSize="16" Margin="0,0,6,0" Foreground="White"/>
                        <TextBlock Text="{Binding ElementName=RootWindow, Path=CurrentUsername}" 
                                   Foreground="White" 
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <!-- 上次登录时间显示 -->
                    <StackPanel Orientation="Horizontal" Margin="16,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="🕒" FontSize="16" Margin="0,0,6,0" Foreground="White"/>
                        <TextBlock Text="上次登录：" Foreground="White" VerticalAlignment="Center"/>
                        <TextBlock Foreground="White" VerticalAlignment="Center">
                            <TextBlock.Text>
                                <Binding ElementName="RootWindow" Path="PreviousLoginAt" StringFormat="{}{0:yyyy-MM-dd HH:mm}" TargetNullValue="首次登录" />
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>

                    <!-- 功能按钮：修改密码、退出系统 -->
                    <Button Content="修改密码"
                            Style="{StaticResource HeaderButton}"
                            Margin="16,0,0,0"
                            Click="ChangePasswordButton_Click"/>
                    <Button Content="退出系统"
                            Style="{StaticResource HeaderButton}"
                            Margin="8,0,0,0"
                            Click="LogoutButton_Click"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- 主内容区域 -->
        <TabControl x:Name="MainTabControl"
                    Grid.Row="1" 
                    Style="{StaticResource ModernTabControl}"
                    Margin="16">
            
            <!-- 仪表板 -->
            <TabItem x:Name="TabDashboard" Header="仪表板" Style="{StaticResource ModernTabItem}" IsSelected="True">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🏠" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="仪表板" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="DashboardFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>
            
            <!-- 题库管理 -->
            <TabItem x:Name="TabQuestionBank" Header="题库管理" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📖" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="题库管理" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="QuestionBankFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 试卷管理 -->
            <TabItem x:Name="TabExamPaper" Header="试卷管理" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📄" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="试卷管理" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="ExamPaperFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 考试管理 -->
            <TabItem x:Name="TabExamManagement" Header="考试管理" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="✏️" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="考试管理" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="ExamFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 考试结果 -->
            <TabItem x:Name="TabExamResult" Header="考试结果" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📊" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="考试结果" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="ExamResultFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 成绩管理（教师/管理员） -->
            <TabItem x:Name="TabGradeManagement" Header="成绩管理" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🏫" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="成绩管理" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="GradeManagementFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 消息中心 -->
            <TabItem x:Name="TabMessageCenter" Header="消息中心" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="💬" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="消息中心" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="MessageCenterFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 学习资源 -->
            <TabItem x:Name="TabLearningResources" Header="学习资源" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📚" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="学习资源" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="LearningResourcesFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 统计报表 -->
            <TabItem x:Name="TabStatistics" Header="统计报表" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📈" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="统计报表" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="StatisticsFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>

            <!-- 用户管理 -->
            <TabItem x:Name="TabUserManagement" Header="用户管理" Style="{StaticResource ModernTabItem}">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👥" 
                                      FontSize="16" 
                                      VerticalAlignment="Center" 
                                      Margin="0,0,4,0"/>
                            <TextBlock Text="用户管理" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Frame Name="UserManagementFrame" NavigationUIVisibility="Hidden"/>
            </TabItem>
        </TabControl>

        <!-- 状态栏 -->
        <Border Grid.Row="2" 
                Background="#E3F2FD" 
                Padding="16,8">
            <DockPanel>
                <TextBlock Text="就绪" 
                          DockPanel.Dock="Left" 
                          VerticalAlignment="Center"
                          Foreground="#1976D2"/>
                <TextBlock Text="{Binding Source={x:Static sys:DateTime.Now}, StringFormat='当前时间: {0:yyyy-MM-dd HH:mm:ss}'}" 
                          DockPanel.Dock="Right" 
                          HorizontalAlignment="Right" 
                          VerticalAlignment="Center"
                          Foreground="#1976D2"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>