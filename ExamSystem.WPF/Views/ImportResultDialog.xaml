<Window x:Class="ExamSystem.WPF.Views.ImportResultDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="题目导入结果" Height="600" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
    
    <Window.Resources>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
        
        <Style x:Key="StatTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        
        <Style x:Key="SuccessTextStyle" TargetType="TextBlock" BasedOn="{StaticResource StatTextStyle}">
            <Setter Property="Foreground" Value="Green"/>
        </Style>
        
        <Style x:Key="ErrorTextStyle" TargetType="TextBlock" BasedOn="{StaticResource StatTextStyle}">
            <Setter Property="Foreground" Value="Red"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题 -->
        <TextBlock Grid.Row="0" Text="题目导入结果报告" 
                   FontSize="20" FontWeight="Bold" 
                   HorizontalAlignment="Center" Margin="0,0,0,20"/>
        
        <!-- 统计信息 -->
        <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" 
                Background="LightBlue" Padding="15" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock Text="导入统计" Style="{StaticResource HeaderTextStyle}"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="总题目数：" Style="{StaticResource StatTextStyle}"/>
                        <TextBlock x:Name="TotalCountText" Text="{Binding TotalCount}" 
                                   Style="{StaticResource StatTextStyle}" FontWeight="Bold"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="成功导入：" Style="{StaticResource StatTextStyle}"/>
                        <TextBlock x:Name="SuccessCountText" Text="{Binding SuccessCount}" 
                                   Style="{StaticResource SuccessTextStyle}" FontWeight="Bold"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2">
                        <TextBlock Text="导入失败：" Style="{StaticResource StatTextStyle}"/>
                        <TextBlock x:Name="FailureCountText" Text="{Binding FailureCount}" 
                                   Style="{StaticResource ErrorTextStyle}" FontWeight="Bold"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>
        
        <!-- 详细信息 -->
        <TabControl Grid.Row="2" Margin="0,0,0,10">
            <!-- 成功导入的题目 -->
            <TabItem Header="成功导入" x:Name="SuccessTab">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="成功导入的题目列表" 
                               Style="{StaticResource HeaderTextStyle}"/>
                    
                    <DataGrid Grid.Row="1" x:Name="SuccessDataGrid" 
                              ItemsSource="{Binding SuccessfulQuestions}"
                              AutoGenerateColumns="False" 
                              IsReadOnly="True"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="行号" Binding="{Binding RowNumber}" Width="60"/>
                            <DataGridTextColumn Header="题目标题" Binding="{Binding Title}" Width="200"/>
                            <DataGridTextColumn Header="题目类型" Binding="{Binding QuestionType}" Width="100"/>
                            <DataGridTextColumn Header="难度" Binding="{Binding Difficulty}" Width="80"/>
                            <DataGridTextColumn Header="分值" Binding="{Binding Score}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            
            <!-- 导入失败的题目 -->
            <TabItem Header="导入失败" x:Name="FailureTab">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="导入失败的题目及错误信息" 
                               Style="{StaticResource HeaderTextStyle}"/>
                    
                    <DataGrid Grid.Row="1" x:Name="FailureDataGrid" 
                              ItemsSource="{Binding FailedQuestions}"
                              AutoGenerateColumns="False" 
                              IsReadOnly="True"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="行号" Binding="{Binding RowNumber}" Width="60"/>
                            <DataGridTextColumn Header="题目标题" Binding="{Binding Title}" Width="150"/>
                            <DataGridTextColumn Header="错误信息" Binding="{Binding ErrorMessage}" Width="300"/>
                            <DataGridTextColumn Header="原始数据" Binding="{Binding RawData}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- 按钮区域 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" 
                    HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button x:Name="ExportReportButton" Content="导出报告" 
                    Width="100" Height="35" Margin="0,0,10,0"
                    Click="ExportReportButton_Click"/>
            <Button x:Name="CloseButton" Content="关闭" 
                    Width="100" Height="35" 
                    IsDefault="True" Click="CloseButton_Click"/>
        </StackPanel>
    </Grid>
</Window>