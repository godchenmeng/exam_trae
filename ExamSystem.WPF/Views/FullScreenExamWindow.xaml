<Window x:Class="ExamSystem.WPF.Views.FullScreenExamWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:ExamSystem.WPF.Converters"
        Title="在线考试系统 - 考试进行中" 
        WindowState="Maximized"
        WindowStyle="None"
        ResizeMode="NoResize"
        Topmost="True"
        KeyDown="Window_KeyDown">
    
    <Window.Resources>
        <conv:ItemsSourceWhenTrueConverter x:Key="ItemsSourceWhenTrueConverter"/>
        <!-- 样式定义 -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        
        <Style x:Key="InfoTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="0,0,15,0"/>
        </Style>
        
        <Style x:Key="TimerTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#E74C3C"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>
        
        <Style x:Key="QuestionTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="LineHeight" Value="28"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
        
        <Style x:Key="OptionRadioButtonStyle" TargetType="RadioButton">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Margin" Value="0,8,0,8"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Background" Value="#F8F9FA"/>
            <Setter Property="BorderBrush" Value="#DEE2E6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="18" Height="18" 
                                        BorderBrush="#6C757D" 
                                        BorderThickness="2"
                                        CornerRadius="9"
                                        Margin="0,0,10,0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType=RadioButton}}" Value="True">
                                                    <Setter Property="Background" Value="#007BFF"/>
                                                    <Setter Property="BorderBrush" Value="#007BFF"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Ellipse Width="8" Height="8" 
                                             Fill="White"
                                             HorizontalAlignment="Center" 
                                             VerticalAlignment="Center">
                                        <Ellipse.Style>
                                            <Style TargetType="Ellipse">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType=RadioButton}}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Ellipse.Style>
                                    </Ellipse>
                                </Border>
                                <ContentPresenter VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E9ECEF"/>
                                <Setter Property="BorderBrush" Value="#ADB5BD"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="#E3F2FD"/>
                                <Setter Property="BorderBrush" Value="#007BFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="OptionCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Margin" Value="0,8,0,8"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Background" Value="#F8F9FA"/>
            <Setter Property="BorderBrush" Value="#DEE2E6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="18" Height="18" 
                                        BorderBrush="#6C757D" 
                                        BorderThickness="2"
                                        CornerRadius="3"
                                        Margin="0,0,10,0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType=CheckBox}}" Value="True">
                                                    <Setter Property="Background" Value="#28A745"/>
                                                    <Setter Property="BorderBrush" Value="#28A745"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="✓" 
                                               Foreground="White" 
                                               FontSize="12" 
                                               FontWeight="Bold"
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource AncestorType=CheckBox}}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Border>
                                <ContentPresenter VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E9ECEF"/>
                                <Setter Property="BorderBrush" Value="#ADB5BD"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="#E8F5E8"/>
                                <Setter Property="BorderBrush" Value="#28A745"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="45"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="Margin" Value="10,5"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="1" 
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="PrimaryButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
        </Style>
        
        <Style x:Key="SuccessButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="Background" Value="#28A745"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#1E7E34"/>
        </Style>
        
        <Style x:Key="DangerButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="Background" Value="#DC3545"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#C82333"/>
        </Style>
        
        <Style x:Key="SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource ActionButtonStyle}">
            <Setter Property="Background" Value="#6C757D"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#545B62"/>
        </Style>
        
        <Style x:Key="NavigationButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Margin" Value="3"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="2" 
                                CornerRadius="20">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid Background="#F8F9FA">
        <Grid.RowDefinitions>
            <RowDefinition Height="80"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="80"/>
        </Grid.RowDefinitions>
        
        <!-- 顶部状态栏 -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="30,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- 考试信息 -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="考试：" Style="{StaticResource InfoTextStyle}"/>
                    <TextBlock Text="{Binding ExamTitle}" Style="{StaticResource InfoTextStyle}" FontWeight="Bold"/>
                    <TextBlock Text="第" Style="{StaticResource InfoTextStyle}" Margin="40,0,0,0"/>
                    <TextBlock Text="{Binding CurrentQuestionIndex}" Style="{StaticResource InfoTextStyle}" FontWeight="Bold"/>
                    <TextBlock Text="/" Style="{StaticResource InfoTextStyle}"/>
                    <TextBlock Text="{Binding TotalQuestions}" Style="{StaticResource InfoTextStyle}" FontWeight="Bold"/>
                    <TextBlock Text="题" Style="{StaticResource InfoTextStyle}"/>
                </StackPanel>
                
                <!-- 倒计时 -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="0,0,30,0">
                    <TextBlock Text="剩余时间" Foreground="White" FontSize="12" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding RemainingTimeText}" Style="{StaticResource TimerTextStyle}"/>
                </StackPanel>
                
                <!-- 退出按钮 -->
                <Button Grid.Column="2" Content="退出考试" 
                        Style="{StaticResource DangerButtonStyle}"
                        Command="{Binding ExitExamCommand}"
                        VerticalAlignment="Center"/>
            </Grid>
        </Border>
        
        <!-- 主要内容区域 -->
        <Grid Grid.Row="1" Margin="40,30">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- 题目显示区域 -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,30,0">
                <StackPanel>
                    <!-- 题目标题 -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <TextBlock Text="第" Style="{StaticResource HeaderTextStyle}" Foreground="#2C3E50"/>
                        <TextBlock Text="{Binding CurrentQuestionIndex}" Style="{StaticResource HeaderTextStyle}" Foreground="#2C3E50"/>
                        <TextBlock Text="题" Style="{StaticResource HeaderTextStyle}" Foreground="#2C3E50"/>
                        <Border Background="{StaticResource PrimaryBrush}" CornerRadius="12" Padding="8,4" Margin="15,0,0,0">
                            <TextBlock Text="{Binding CurrentQuestion.QuestionType}" 
                                       Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                        </Border>
                        <Border Background="#28A745" CornerRadius="12" Padding="8,4" Margin="10,0,0,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding CurrentQuestion.Score}" 
                                           Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                <TextBlock Text="分" 
                                           Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                    
                    <!-- 题目内容 -->
                    <Border Background="White" BorderBrush="#DEE2E6" BorderThickness="1" 
                            CornerRadius="8" Padding="25" Margin="0,0,0,25">
                        <TextBlock Text="{Binding CurrentQuestion.Content}" Style="{StaticResource QuestionTextStyle}"/>
                    </Border>
                    
                    <!-- 答题区域 -->
                    <Border Background="White" BorderBrush="#DEE2E6" BorderThickness="1" 
                            CornerRadius="8" Padding="25">
                        <StackPanel Name="AnswerPanel">
                            <!-- 单选题 -->
                            <ItemsControl Visibility="{Binding IsSingleChoice, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <ItemsControl.ItemsSource>
                                    <MultiBinding Converter="{StaticResource ItemsSourceWhenTrueConverter}">
                                        <Binding Path="CurrentQuestion.Options"/>
                                        <Binding Path="IsSingleChoice"/>
                                    </MultiBinding>
                                </ItemsControl.ItemsSource>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <RadioButton Content="{Binding Text}" 
                                                     GroupName="SingleChoice"
                                                     Style="{StaticResource OptionRadioButtonStyle}"
                                                     IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                     Click="SingleChoiceOption_Click"
                                                     Tag="{Binding}"/>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <!-- 多选题 -->
                            <ItemsControl Visibility="{Binding IsMultipleChoice, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <ItemsControl.ItemsSource>
                                    <MultiBinding Converter="{StaticResource ItemsSourceWhenTrueConverter}">
                                        <Binding Path="CurrentQuestion.Options"/>
                                        <Binding Path="IsMultipleChoice"/>
                                    </MultiBinding>
                                </ItemsControl.ItemsSource>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox Content="{Binding Text}" 
                                                  Style="{StaticResource OptionCheckBoxStyle}"
                                                  IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                  Tag="{Binding}"/>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <!-- 判断题 -->
                            <StackPanel Visibility="{Binding IsTrueFalse, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <RadioButton Content="✓ 正确" GroupName="TrueFalse" Style="{StaticResource OptionRadioButtonStyle}"
                                             IsChecked="{Binding CurrentQuestion.TrueFalseAnswer, Converter={StaticResource BooleanToTrueConverter}, Mode=TwoWay}"/>
                                <RadioButton Content="✗ 错误" GroupName="TrueFalse" Style="{StaticResource OptionRadioButtonStyle}"
                                             IsChecked="{Binding CurrentQuestion.TrueFalseAnswer, Converter={StaticResource BooleanToFalseConverter}, Mode=TwoWay}"/>
                            </StackPanel>
                            
                            <!-- 填空题 -->
                            <TextBox Text="{Binding CurrentQuestion.FillInBlankAnswer, UpdateSourceTrigger=PropertyChanged}"
                                     Visibility="{Binding IsFillInBlank, Converter={StaticResource BooleanToVisibilityConverter}}"
                                     Height="120" TextWrapping="Wrap" AcceptsReturn="True"
                                     FontSize="16" Padding="15" Margin="0,10"
                                     BorderBrush="#DEE2E6" BorderThickness="1"/>
                            
                            <!-- 简答/论述题 -->
                            <TextBox Text="{Binding CurrentQuestion.EssayAnswer, UpdateSourceTrigger=PropertyChanged}"
                                     Visibility="{Binding IsEssay, Converter={StaticResource BooleanToVisibilityConverter}}"
                                     Height="250" TextWrapping="Wrap" AcceptsReturn="True"
                                     FontSize="16" Padding="15" Margin="0,10"
                                     BorderBrush="#DEE2E6" BorderThickness="1"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
            
            <!-- 右侧导航面板 -->
            <Border Grid.Column="1" Background="White" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="8">
                <StackPanel Margin="20">
                    <TextBlock Text="答题卡" Style="{StaticResource HeaderTextStyle}" 
                               Foreground="#2C3E50" HorizontalAlignment="Center" FontSize="16"/>
                    
                    <!-- 题目导航 -->
                    <ScrollViewer MaxHeight="400" VerticalScrollBarVisibility="Auto" Margin="0,15">
                        <ItemsControl ItemsSource="{Binding QuestionNavigations}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Content="{Binding QuestionNumber}" 
                                            Command="{Binding DataContext.NavigateToQuestionCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding QuestionIndex}">
                                        <Button.Style>
                                            <Style TargetType="Button" BasedOn="{StaticResource NavigationButtonStyle}">
                                                <Setter Property="Background" Value="#F8F9FA"/>
                                                <Setter Property="Foreground" Value="#6C757D"/>
                                                <Setter Property="BorderBrush" Value="#DEE2E6"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsAnswered}" Value="True">
                                                        <Setter Property="Background" Value="#28A745"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                        <Setter Property="BorderBrush" Value="#1E7E34"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding IsCurrent}" Value="True">
                                                        <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                        <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- 统计信息 -->
                    <Border Background="#F8F9FA" BorderBrush="#DEE2E6" BorderThickness="1" 
                            CornerRadius="6" Padding="15" Margin="0,15,0,0">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <Ellipse Width="12" Height="12" Fill="#28A745" Margin="0,0,8,0"/>
                                <TextBlock Text="已答：" FontSize="14"/>
                                <TextBlock Text="{Binding AnsweredCount}" FontSize="14" FontWeight="Bold"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <Ellipse Width="12" Height="12" Fill="#DEE2E6" Margin="0,0,8,0"/>
                                <TextBlock Text="未答：" FontSize="14"/>
                                <TextBlock Text="{Binding UnansweredCount}" FontSize="14" FontWeight="Bold"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    
                    <!-- 操作按钮 -->
                    <StackPanel Margin="0,20,0,0">
                        <Button Content="保存答案" Style="{StaticResource SuccessButtonStyle}" 
                                Command="{Binding SaveAnswerCommand}" Margin="0,0,0,10"/>
                        <Button Content="提交考试" Style="{StaticResource DangerButtonStyle}" 
                                Command="{Binding SubmitExamCommand}"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
        
        <!-- 底部导航栏 -->
        <Border Grid.Row="2" Background="White" BorderBrush="#DEE2E6" BorderThickness="0,1,0,0" Padding="40,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Button Content="◀ 上一题" Style="{StaticResource SecondaryButtonStyle}" 
                        Command="{Binding PreviousQuestionCommand}" 
                        IsEnabled="{Binding CanGoPrevious}"/>
                <Button Content="下一题 ▶" Style="{StaticResource PrimaryButtonStyle}" 
                        Command="{Binding NextQuestionCommand}" 
                        IsEnabled="{Binding CanGoNext}"/>
            </StackPanel>
        </Border>
        
        <!-- 加载指示器 -->
        <Grid Grid.RowSpan="3" Background="#80000000" 
              Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="300" Height="6" Margin="0,0,0,15"/>
                <TextBlock Text="正在加载考试..." Foreground="White" FontSize="18" HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>