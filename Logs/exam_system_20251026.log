2025-10-26 22:26:33.392 +08:00 [DBG] Hosting starting
2025-10-26 22:26:33.412 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-26 22:26:33.414 +08:00 [INF] Hosting environment: Production
2025-10-26 22:26:33.414 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-26 22:26:33.414 +08:00 [DBG] Hosting started
2025-10-26 22:26:33.447 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-26 22:26:33.457 +08:00 [INF] SQLite 数据库路径: E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db
2025-10-26 22:26:33.541 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:26:33.559 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:26:33.609 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:26:33.610 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:26:33.623 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-26 22:26:33.735 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 22:26:33.739 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:26:33.743 +08:00 [DBG] Created DbConnection. (2ms).
2025-10-26 22:26:33.744 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.746 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:26:33.746 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:26:33.747 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.750 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.752 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.753 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.757 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:26:33.759 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-10-26 22:26:33.759 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-10-26 22:26:33.760 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.766 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.768 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.776 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.778 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.778 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.779 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:26:33.779 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:26:33.779 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.779 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.779 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.779 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.780 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:26:33.780 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:26:33.780 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:26:33.780 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.780 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.780 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.780 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.780 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.780 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.785 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.785 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.785 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:26:33.785 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.785 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.785 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:26:33.786 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:26:33.787 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.788 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 22:26:33.788 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.788 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.795 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 22:26:33.797 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.797 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:26:33.797 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:26:33.797 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.797 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.797 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.797 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.797 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:26:33.797 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:26:33.797 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:26:33.797 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.797 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.797 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.797 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.797 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.797 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.797 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:26:33.797 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:26:33.797 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.798 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:26:33.798 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:26:33.798 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:26:33.798 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.798 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:26:33.798 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.798 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:26:33.798 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.798 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.798 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:26:33.798 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:26:33.798 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:26:33.798 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.798 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.798 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 22:26:33.814 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-26 22:26:33.864 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:26:33.873 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.873 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.873 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:26:33.873 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.873 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.873 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 22:26:33.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 22:26:33.874 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.874 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:26:33.874 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.874 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.874 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-26 22:26:33.875 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:26:33.875 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.875 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.875 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:26:33.875 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.875 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.875 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 22:26:33.876 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 22:26:33.876 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.876 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:26:33.876 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.876 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.876 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-26 22:26:33.876 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:26:33.877 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.877 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.877 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:26:33.877 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.877 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:26:33.877 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 22:26:33.877 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 22:26:33.877 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.877 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:26:33.877 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.877 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.877 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 22:26:33.878 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:26:33.878 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:26:33.882 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 22:39:50.511 +08:00 [INF] === 开始登录流程 ===
2025-10-26 22:39:50.511 +08:00 [INF] 用户名: student
2025-10-26 22:39:50.511 +08:00 [INF] 密码长度: 10
2025-10-26 22:39:50.511 +08:00 [INF] AuthService是否为null: False
2025-10-26 22:39:50.511 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 22:39:50.513 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 22:39:50.513 +08:00 [INF] 接收到的用户名: student
2025-10-26 22:39:50.513 +08:00 [INF] 接收到的密码长度: 10
2025-10-26 22:39:50.513 +08:00 [INF] 开始查询用户
2025-10-26 22:39:50.513 +08:00 [INF] UserRepository是否为null: False
2025-10-26 22:39:50.513 +08:00 [INF] Context是否为null: False
2025-10-26 22:39:50.513 +08:00 [INF] 测试数据库连接...
2025-10-26 22:39:50.514 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:39:50.514 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:39:50.514 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.515 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.515 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.515 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.515 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 22:39:50.516 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-26 22:39:50.524 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:39:50.526 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:39:50.526 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:39:50.526 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.527 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.527 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.527 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.527 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.527 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:39:50.529 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:39:50.529 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.529 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.529 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.529 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.529 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 22:39:50.530 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-26 22:39:50.544 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:39:50.547 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.547 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.547 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.547 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.547 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.548 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:39:50.549 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:39:50.560 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:50.573 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.573 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 23ms reading results.
2025-10-26 22:39:50.573 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.573 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.573 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 22:39:50.574 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-26 22:39:50.574 +08:00 [INF] 用户是否激活: True
2025-10-26 22:39:50.574 +08:00 [INF] 登录失败次数: 0
2025-10-26 22:39:50.574 +08:00 [INF] 检查账户锁定状态
2025-10-26 22:39:50.576 +08:00 [INF] 开始验证密码
2025-10-26 22:39:50.576 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 22:39:50.576 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 22:39:50.576 +08:00 [INF] 密码哈希前20字符: $2a$12$RSCC/MKIxSSeo...
2025-10-26 22:39:50.576 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-26 22:39:50.576 +08:00 [INF] 密码哈希长度: 60
2025-10-26 22:39:50.576 +08:00 [INF] 密码哈希前缀: $2a$12$RSC
2025-10-26 22:39:50.796 +08:00 [INF] 密码验证结果: True
2025-10-26 22:39:50.796 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 22:39:50.797 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 22:39:50.798 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 22:39:50.805 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 22:39:50.807 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:50.810 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 22:39:50.826 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.827 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.827 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.827 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.827 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.827 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:39:50.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:39:50.834 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.834 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 6ms reading results.
2025-10-26 22:39:50.834 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.834 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.836 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:50.836 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 22:39:50.836 +08:00 [INF] 用户信息更新完成
2025-10-26 22:39:50.836 +08:00 [INF] 用户登录成功 - student
2025-10-26 22:39:50.836 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 22:39:50.837 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 22:39:50.837 +08:00 [INF] 成功: True
2025-10-26 22:39:50.837 +08:00 [INF] 消息: 登录成功
2025-10-26 22:39:50.837 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:39:50.837 +08:00 [INF] 用户 student 登录成功
2025-10-26 22:39:50.838 +08:00 [INF] 上次登录时间: 2025-10-26 22:23:07
2025-10-26 22:39:50.838 +08:00 [INF] 触发登录成功事件
2025-10-26 22:39:50.839 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 22:39:50.839 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-26 22:39:50.839 +08:00 [INF] 用户ID: 2
2025-10-26 22:39:50.839 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:39:50.852 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 22:39:50.852 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 22:39:50.853 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-26 22:39:50.858 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 22:39:50.861 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.UserId == __id_0)'
2025-10-26 22:39:50.864 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.UserId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:39:50.864 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.864 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.864 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.864 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.864 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.864 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:50.864 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:50.865 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.865 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.865 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.865 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.868 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Where(ep => ep.IsPublished || ep.Status == "已发布" && ep.StartTime <= __currentTime_0 && ep.EndTime >= __currentTime_0)
    .Select(ep => new StudentExamInfo{ 
        PaperId = ep.PaperId, 
        Title = ep.Name, 
        Subject = "通用", 
        Duration = ep.Duration, 
        TotalQuestions = ep.PaperQuestions != null ? ep.PaperQuestions.Count : 0, 
        StartTime = ep.StartTime ?? DateTime.Now, 
        EndTime = ep.EndTime ?? DateTime.Now.AddDays(30), 
        Description = ep.Description ?? "", 
        HasTaken = DbSet<ExamRecord>()
            .Any(er => er.UserId == __userId_1 && er.PaperId == ep.PaperId) 
    }
    )
    .OrderBy(e => e.StartTime)'
2025-10-26 22:39:50.893 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<StudentExamInfo>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 3], [Property: PaperQuestion.OrderIndex (int) Required, 4], [Property: PaperQuestion.PaperId (int) Required FK Index, 5], [Property: PaperQuestion.QuestionId (int) Required FK Index, 6], [Property: PaperQuestion.Score (decimal) Required, 7] }
            4 -> 3
            5 -> 8
            6 -> 9
            7 -> 10
            8 -> 11
            9 -> 12
        SELECT e.PaperId, e.Name, e.Duration, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, (
            SELECT COUNT(*)
            FROM PaperQuestions AS p0
            WHERE (e.PaperId != NULL) && (e.PaperId == p0.PaperId)), COALESCE(e.StartTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE(e.EndTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) + ' days'), '0'), '.')), COALESCE(e.Description, ''), EXISTS (
            SELECT 1
            FROM ExamRecords AS e0
            WHERE (e0.UserId == @__userId_1) && (e0.PaperId == e.PaperId))
        FROM ExamPapers AS e
        LEFT JOIN PaperQuestions AS p ON e.PaperId == p.PaperId
        WHERE ((e.IsPublished || (e.Status == '已发布')) && (e.StartTime <= @__currentTime_0)) && (e.EndTime >= @__currentTime_0)
        ORDER BY COALESCE(e.StartTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')) ASC, e.PaperId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, StudentExamInfo>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:39:50.895 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.896 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.896 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.896 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.896 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.896 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:50.896 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:50.896 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.896 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.896 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.896 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.899 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .AsNoTracking()
    .Include(er => er.ExamPaper)
    .ThenInclude(ep => ep.PaperQuestions)
    .Where(er => er.UserId == __userId_0 && (int)er.Status == 4 || (int)er.Status == 3 || (int)er.Status == 5)
    .OrderByDescending(er => er.StartTime)'
2025-10-26 22:39:50.902 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-26 22:39:50.902 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-26 22:39:50.910 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (DateTime?), 3], [Property: ExamRecord.GradedAt (DateTime?), 4], [Property: ExamRecord.GraderId (int?) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (DateTime?), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (DateTime?), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16] }
            1 -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: ExamPaper.AllowRetake (bool) Required, 18], [Property: ExamPaper.AllowViewAnswer (bool) Required, 19], [Property: ExamPaper.CreatedAt (DateTime) Required, 20], [Property: ExamPaper.CreatorId (int) Required FK Index, 21], [Property: ExamPaper.Description (string) MaxLength(500), 22], [Property: ExamPaper.Duration (int) Required, 23], [Property: ExamPaper.EndTime (DateTime?), 24], [Property: ExamPaper.IsActive (bool) Required, 25], [Property: ExamPaper.IsPublished (bool) Required, 26], [Property: ExamPaper.IsRandomOrder (bool) Required, 27], [Property: ExamPaper.Name (string) Required MaxLength(100), 28], [Property: ExamPaper.PassScore (decimal) Required, 29], [Property: ExamPaper.StartTime (DateTime?), 30], [Property: ExamPaper.Status (string) Required MaxLength(20), 31], [Property: ExamPaper.TotalScore (decimal) Required, 32], [Property: ExamPaper.UpdatedAt (DateTime) Required, 33] }
            2 -> 0
            3 -> 17
            4 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 34], [Property: PaperQuestion.OrderIndex (int) Required, 35], [Property: PaperQuestion.PaperId (int) Required FK Index, 36], [Property: PaperQuestion.QuestionId (int) Required FK Index, 37], [Property: PaperQuestion.Score (decimal) Required, 38] }
            5 -> 34
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score
        FROM ExamRecords AS e
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        LEFT JOIN PaperQuestions AS p ON e0.PaperId == p.PaperId
        WHERE (e.UserId == @__userId_0) && e.Status IN (4, 3, 5)
        ORDER BY e.StartTime DESC, e.RecordId ASC, e0.PaperId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:39:50.912 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.912 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.912 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.912 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.912 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.912 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:50.912 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:50.912 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.912 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.912 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.912 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.913 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()'
2025-10-26 22:39:50.914 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (DateTime?), 3], [Property: ExamRecord.GradedAt (DateTime?), 4], [Property: ExamRecord.GraderId (int?) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (DateTime?), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (DateTime?), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16] }
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
        FROM ExamRecords AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:39:50.915 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.915 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.915 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.915 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.915 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.915 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:50.915 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:50.915 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.915 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.915 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.915 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.919 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-26 22:39:50.920 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6] }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:39:50.921 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.921 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.921 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.921 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.921 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.921 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:39:50.921 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:39:50.923 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:50.926 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.926 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 5ms reading results.
2025-10-26 22:39:50.926 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.926 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.934 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 22:39:50.934 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 22:39:50.934 +08:00 [INF] 接收到的用户: student (Student)
2025-10-26 22:39:50.934 +08:00 [INF] 用户ID: 2
2025-10-26 22:39:50.934 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:39:50.934 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-26 22:39:50.934 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 22:39:50.934 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 22:39:50.936 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-26 22:39:50.937 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (DateTime?), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (DateTime?), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16] }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:39:50.938 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.938 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.938 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.938 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.938 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.938 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:39:50.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:39:50.938 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.938 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.938 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.938 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.939 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 22:39:50.945 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-26 22:39:50.945 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-26 22:39:50.946 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-26 22:39:50.947 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.Creator)
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .Where(p => p.IsPublished)
    .OrderByDescending(p => p.CreatedAt)'
2025-10-26 22:39:50.947 +08:00 [DBG] Including navigation: 'ExamPaper.Creator'.
2025-10-26 22:39:50.947 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-26 22:39:50.947 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-26 22:39:50.955 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (DateTime?), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (DateTime?), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16] }
            1 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: User.CreatedAt (DateTime) Required, 18], [Property: User.Email (string) Index MaxLength(200), 19], [Property: User.IsActive (bool) Required, 20], [Property: User.LastLoginAt (DateTime?), 21], [Property: User.LockoutEnd (DateTime?), 22], [Property: User.LoginFailCount (int) Required, 23], [Property: User.PasswordHash (string) Required MaxLength(255), 24], [Property: User.Phone (string) MaxLength(20), 25], [Property: User.RealName (string) MaxLength(100), 26], [Property: User.Role (UserRole) Required, 27], [Property: User.Username (string) Required Index MaxLength(50), 28] }
            2 -> 0
            3 -> 17
            4 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 29], [Property: PaperQuestion.OrderIndex (int) Required, 30], [Property: PaperQuestion.PaperId (int) Required FK Index, 31], [Property: PaperQuestion.QuestionId (int) Required FK Index, 32], [Property: PaperQuestion.Score (decimal) Required, 33] }
            5 -> Dictionary<IProperty, int> { [Property: Question.QuestionId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 34], [Property: Question.Analysis (string), 35], [Property: Question.Answer (string) Required, 36], [Property: Question.BankId (int) Required FK Index, 37], [Property: Question.Content (string) Required, 38], [Property: Question.CreatedAt (DateTime) Required, 39], [Property: Question.Difficulty (Difficulty) Required, 40], [Property: Question.IsActive (bool) Required, 41], [Property: Question.QuestionType (QuestionType) Required, 42], [Property: Question.Score (decimal) Required, 43], [Property: Question.Tags (string) MaxLength(200), 44], [Property: Question.Title (string) Required MaxLength(200), 45], [Property: Question.UpdatedAt (DateTime) Required, 46] }
            6 -> 29
            7 -> 34
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, t.Id, t.OrderIndex, t.PaperId, t.QuestionId, t.Score, t.QuestionId0, t.Analysis, t.Answer, t.BankId, t.Content, t.CreatedAt, t.Difficulty, t.IsActive, t.QuestionType, t.Score0, t.Tags, t.Title, t.UpdatedAt
        FROM ExamPapers AS e
        INNER JOIN Users AS u ON e.CreatorId == u.UserId
        LEFT JOIN 
        (
            SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
            FROM PaperQuestions AS p
            INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
        ) AS t ON e.PaperId == t.PaperId
        WHERE e.IsPublished
        ORDER BY e.CreatedAt DESC, e.PaperId ASC, u.UserId ASC, t.Id ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:39:50.955 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.955 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.955 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.955 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.955 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.956 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 22:39:50.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 22:39:50.956 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.956 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.956 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.956 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.956 +08:00 [INF] 成功获取 0 个已发布的试卷
2025-10-26 22:39:50.956 +08:00 [INF] 成功加载 0 个可参加的考试
2025-10-26 22:39:50.960 +08:00 [INF] 开始加载学生考试结果
2025-10-26 22:39:50.961 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.961 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.961 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.961 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.961 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.961 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:50.962 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:50.962 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.962 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.962 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.962 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.962 +08:00 [INF] 成功加载 0 条考试结果
2025-10-26 22:39:50.980 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .Count()'
2025-10-26 22:39:50.982 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM NotificationRecipients AS n
            WHERE n.ReceiverId == @__receiverId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:39:50.982 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.982 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.982 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.982 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.982 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.982 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 22:39:50.983 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 22:39:50.983 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.983 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.983 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.983 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:50.983 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .OrderByDescending(r => r.Notification.CreatedAt)
    .Skip(__p_1)
    .Take(__p_2)'
2025-10-26 22:39:50.984 +08:00 [DBG] Including navigation: 'NotificationRecipient.Notification'.
2025-10-26 22:39:50.984 +08:00 [DBG] Including navigation: 'Notification.Sender'.
2025-10-26 22:39:50.990 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<NotificationRecipient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: NotificationRecipient.NotificationRecipientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: NotificationRecipient.CreatedAt (DateTime) Required, 1], [Property: NotificationRecipient.DeliveryStatus (DeliveryStatus) Required, 2], [Property: NotificationRecipient.NotificationId (int) Required FK Index, 3], [Property: NotificationRecipient.ReadAt (DateTime?), 4], [Property: NotificationRecipient.ReceiverId (int) Required FK Index, 5] }
            1 -> Dictionary<IProperty, int> { [Property: Notification.NotificationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Notification.Content (string) Required, 7], [Property: Notification.CreatedAt (DateTime) Required, 8], [Property: Notification.Priority (NotificationPriority) Required, 9], [Property: Notification.Scope (NotificationScope) Required, 10], [Property: Notification.SenderId (int) Required FK Index, 11], [Property: Notification.Status (NotificationStatus) Required, 12], [Property: Notification.Title (string) Required MaxLength(200), 13] }
            2 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: User.CreatedAt (DateTime) Required, 15], [Property: User.Email (string) Index MaxLength(200), 16], [Property: User.IsActive (bool) Required, 17], [Property: User.LastLoginAt (DateTime?), 18], [Property: User.LockoutEnd (DateTime?), 19], [Property: User.LoginFailCount (int) Required, 20], [Property: User.PasswordHash (string) Required MaxLength(255), 21], [Property: User.Phone (string) MaxLength(20), 22], [Property: User.RealName (string) MaxLength(100), 23], [Property: User.Role (UserRole) Required, 24], [Property: User.Username (string) Required Index MaxLength(50), 25] }
        SELECT t.NotificationRecipientId, t.CreatedAt, t.DeliveryStatus, t.NotificationId, t.ReadAt, t.ReceiverId, t.NotificationId0, t.Content, t.CreatedAt0, t.Priority, t.Scope, t.SenderId, t.Status, t.Title, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM 
        (
            SELECT n.NotificationRecipientId, n.CreatedAt, n.DeliveryStatus, n.NotificationId, n.ReadAt, n.ReceiverId, n0.NotificationId AS NotificationId0, n0.Content, n0.CreatedAt AS CreatedAt0, n0.Priority, n0.Scope, n0.SenderId, n0.Status, n0.Title
            FROM NotificationRecipients AS n
            INNER JOIN Notifications AS n0 ON n.NotificationId == n0.NotificationId
            WHERE n.ReceiverId == @__receiverId_0
            ORDER BY n0.CreatedAt DESC
            OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
        ) AS t
        INNER JOIN Users AS u ON t.SenderId == u.UserId
        ORDER BY t.CreatedAt0 DESC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, NotificationRecipient>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:39:50.990 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.990 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.990 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:50.990 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.990 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:50.990 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 22:39:50.990 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 22:39:50.991 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.991 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:50.991 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:50.991 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:51.004 +08:00 [INF] 所有页面加载完成
2025-10-26 22:39:51.005 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 22:39:51.005 +08:00 [INF] 当前用户: student (Student)
2025-10-26 22:39:51.005 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 22:39:51.005 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 22:39:51.005 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 22:39:51.005 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 22:39:51.005 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 22:39:51.005 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 22:39:51.005 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 22:39:51.005 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 22:39:51.005 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 22:39:51.005 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 22:39:51.005 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 22:39:51.005 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 22:39:51.005 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 22:39:51.005 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 22:39:51.005 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 22:39:51.039 +08:00 [INF] 关闭登录窗口
2025-10-26 22:39:51.043 +08:00 [INF] === 登录流程结束 ===
2025-10-26 22:39:51.058 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.059 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.059 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:51.059 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.059 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.059 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:51.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:51.060 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:51.060 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.060 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:51.060 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.060 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:51.061 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.061 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.061 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:51.061 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.061 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.061 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:51.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:51.061 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.061 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:51.061 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.061 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:51.061 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.061 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.061 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:51.061 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.061 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.061 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:51.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:51.062 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.062 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:51.062 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.062 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:51.062 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.062 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.062 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:51.062 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.062 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:51.062 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:51.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:51.062 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.062 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:51.062 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:51.062 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:56.131 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.131 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.131 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:56.131 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.131 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.131 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:56.131 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:56.131 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:56.132 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.132 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:56.132 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.132 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:56.132 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.132 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.132 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:56.132 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.132 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.132 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:56.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:56.132 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.132 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:56.132 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.132 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:56.133 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:56.133 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.133 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.133 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:56.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:56.133 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:56.133 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:56.133 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:56.133 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.133 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:56.133 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:56.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:56.133 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:56.133 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:56.133 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:57.537 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.537 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.537 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:57.537 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.537 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.537 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:57.537 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:57.537 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:57.537 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.537 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:57.537 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.537 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:57.538 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:57.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:57.538 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:57.538 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:57.538 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:57.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:57.538 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:57.538 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:57.538 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:57.538 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:57.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:57.538 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:57.538 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:57.538 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:58.814 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.814 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.814 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:58.814 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.814 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.814 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:58.814 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:39:58.814 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:39:58.815 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.815 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:58.815 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.815 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:58.815 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.815 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.815 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:58.815 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.815 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.815 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:58.816 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:39:58.816 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:58.816 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:58.816 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:58.816 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.816 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.816 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:58.816 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:39:58.816 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:58.816 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:39:58.816 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:39:58.816 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.816 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:39:58.816 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:58.816 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:39:58.816 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:39:58.816 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:39:58.816 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:00.847 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 22:40:04.532 +08:00 [INF] === 开始登录流程 ===
2025-10-26 22:40:04.532 +08:00 [INF] 用户名: admin
2025-10-26 22:40:04.532 +08:00 [INF] 密码长度: 8
2025-10-26 22:40:04.532 +08:00 [INF] AuthService是否为null: False
2025-10-26 22:40:04.532 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 22:40:04.532 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 22:40:04.532 +08:00 [INF] 接收到的用户名: admin
2025-10-26 22:40:04.532 +08:00 [INF] 接收到的密码长度: 8
2025-10-26 22:40:04.532 +08:00 [INF] 开始查询用户
2025-10-26 22:40:04.532 +08:00 [INF] UserRepository是否为null: False
2025-10-26 22:40:04.532 +08:00 [INF] Context是否为null: False
2025-10-26 22:40:04.532 +08:00 [INF] 测试数据库连接...
2025-10-26 22:40:04.533 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:40:04.533 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:40:04.533 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.533 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.533 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.533 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.533 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 22:40:04.533 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.533 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.533 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.533 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.533 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.533 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:40:04.534 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:40:04.534 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.534 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.534 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.534 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.534 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 22:40:04.534 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.534 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.534 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.534 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.534 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.534 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:40:04.534 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:40:04.534 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:04.534 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.534 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.534 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.534 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.534 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 22:40:04.534 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-26 22:40:04.534 +08:00 [INF] 用户是否激活: True
2025-10-26 22:40:04.534 +08:00 [INF] 登录失败次数: 0
2025-10-26 22:40:04.534 +08:00 [INF] 检查账户锁定状态
2025-10-26 22:40:04.534 +08:00 [INF] 开始验证密码
2025-10-26 22:40:04.534 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 22:40:04.534 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 22:40:04.534 +08:00 [INF] 密码哈希前20字符: $2a$12$h/NrNAeZeayrs...
2025-10-26 22:40:04.534 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-26 22:40:04.534 +08:00 [INF] 密码哈希长度: 60
2025-10-26 22:40:04.534 +08:00 [INF] 密码哈希前缀: $2a$12$h/N
2025-10-26 22:40:04.727 +08:00 [INF] 密码验证结果: True
2025-10-26 22:40:04.727 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 22:40:04.727 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 22:40:04.727 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 22:40:04.727 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 22:40:04.727 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:04.728 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 22:40:04.728 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.728 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.729 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.729 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.729 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.729 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:40:04.729 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:40:04.730 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.731 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 22:40:04.731 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.731 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.731 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:04.731 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 22:40:04.731 +08:00 [INF] 用户信息更新完成
2025-10-26 22:40:04.731 +08:00 [INF] 用户登录成功 - admin
2025-10-26 22:40:04.731 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 22:40:04.731 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 22:40:04.731 +08:00 [INF] 成功: True
2025-10-26 22:40:04.731 +08:00 [INF] 消息: 登录成功
2025-10-26 22:40:04.731 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:40:04.731 +08:00 [INF] 用户 admin 登录成功
2025-10-26 22:40:04.731 +08:00 [INF] 上次登录时间: 2025-10-26 22:23:21
2025-10-26 22:40:04.731 +08:00 [INF] 触发登录成功事件
2025-10-26 22:40:04.731 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 22:40:04.731 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-26 22:40:04.731 +08:00 [INF] 用户ID: 1
2025-10-26 22:40:04.731 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:40:04.733 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 22:40:04.733 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 22:40:04.734 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 22:40:04.736 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.736 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.736 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.736 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.736 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.736 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:04.736 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:04.739 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:04.739 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.739 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 3ms reading results.
2025-10-26 22:40:04.739 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.739 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.739 +08:00 [DBG] Compiling query expression: 
'DbSet<Question>()'
2025-10-26 22:40:04.742 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Question>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Question.QuestionId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Question.Analysis (string), 1], [Property: Question.Answer (string) Required, 2], [Property: Question.BankId (int) Required FK Index, 3], [Property: Question.Content (string) Required, 4], [Property: Question.CreatedAt (DateTime) Required, 5], [Property: Question.Difficulty (Difficulty) Required, 6], [Property: Question.IsActive (bool) Required, 7], [Property: Question.QuestionType (QuestionType) Required, 8], [Property: Question.Score (decimal) Required, 9], [Property: Question.Tags (string) MaxLength(200), 10], [Property: Question.Title (string) Required MaxLength(200), 11], [Property: Question.UpdatedAt (DateTime) Required, 12] }
        SELECT q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt
        FROM Questions AS q), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Question>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:40:04.742 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.743 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:04.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:04.743 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.743 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.743 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.743 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.743 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.743 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:04.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:04.743 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.743 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.743 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.743 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-10-26 22:40:04.745 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
        SELECT u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Users AS u), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:40:04.745 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.745 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.745 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.745 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.745 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.745 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:04.745 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:04.745 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:04.745 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:04.745 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.745 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.745 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.745 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.745 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.746 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.746 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.746 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.746 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.746 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.746 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.746 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.746 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.746 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.746 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.746 +08:00 [DBG] Compiling query expression: 
'DbSet<Notification>()'
2025-10-26 22:40:04.747 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Notification>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Notification.NotificationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Notification.Content (string) Required, 1], [Property: Notification.CreatedAt (DateTime) Required, 2], [Property: Notification.Priority (NotificationPriority) Required, 3], [Property: Notification.Scope (NotificationScope) Required, 4], [Property: Notification.SenderId (int) Required FK Index, 5], [Property: Notification.Status (NotificationStatus) Required, 6], [Property: Notification.Title (string) Required MaxLength(200), 7] }
        SELECT n.NotificationId, n.Content, n.CreatedAt, n.Priority, n.Scope, n.SenderId, n.Status, n.Title
        FROM Notifications AS n), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Notification>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 22:40:04.747 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.747 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.747 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.748 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.748 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.748 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:04.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:04.748 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.748 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.748 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.748 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.748 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.748 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.748 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.748 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.748 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.748 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:04.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:04.748 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.748 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.748 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.748 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.751 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 22:40:04.751 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 22:40:04.751 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-26 22:40:04.751 +08:00 [INF] 用户ID: 1
2025-10-26 22:40:04.751 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:40:04.751 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-26 22:40:04.751 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 22:40:04.751 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 22:40:04.751 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.751 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.751 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.751 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.751 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.751 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.751 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.751 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.751 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.751 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.751 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.751 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 22:40:04.765 +08:00 [INF] 所有页面加载完成
2025-10-26 22:40:04.766 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 22:40:04.766 +08:00 [INF] 当前用户: admin (Admin)
2025-10-26 22:40:04.766 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 22:40:04.766 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 22:40:04.766 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 22:40:04.766 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 22:40:04.766 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 22:40:04.766 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 22:40:04.766 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 22:40:04.766 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 22:40:04.766 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 22:40:04.766 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 22:40:04.766 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 22:40:04.766 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 22:40:04.766 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 22:40:04.766 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 22:40:04.766 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 22:40:04.787 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:04.800 +08:00 [INF] 关闭登录窗口
2025-10-26 22:40:04.802 +08:00 [INF] === 登录流程结束 ===
2025-10-26 22:40:04.807 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.807 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:04.807 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:04.807 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.807 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.807 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:04.807 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:04.807 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.807 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.807 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.807 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.807 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.807 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.807 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.807 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.807 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:04.807 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:04.807 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.808 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.808 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:04.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:04.808 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.808 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.808 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:04.808 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.808 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:04.808 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:04.808 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:04.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:04.808 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:04.808 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:04.808 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:04.851 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:05.980 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:06.025 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:06.239 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.239 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.239 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:06.239 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.239 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.239 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:06.239 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:06.239 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.239 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:06.239 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.239 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:06.240 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:06.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:06.240 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:06.240 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:06.240 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:06.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:06.240 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:06.240 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:06.240 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:06.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:06.240 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:06.240 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:06.240 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:06.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:06.240 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:06.240 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:06.240 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:06.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:06.240 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:06.240 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:06.240 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:06.240 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:06.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:06.240 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:06.240 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:06.240 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:06.257 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:06.304 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:07.040 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:07.133 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:07.383 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:07.384 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:07.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:07.384 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:07.384 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:07.384 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:07.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 22:40:07.384 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:07.384 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:07.384 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.384 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:07.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:07.384 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:07.384 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.384 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:07.385 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:07.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:07.385 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:07.385 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:07.385 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:07.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 22:40:07.385 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:07.385 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:07.385 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:07.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:07.385 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:07.385 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:07.385 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:07.385 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:07.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 22:40:07.385 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:07.385 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:07.385 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:07.398 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:07.459 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:19.407 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:19.491 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 22:40:19.566 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:20.476 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.409 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.518 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.641 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.716 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.722 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.829 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.893 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:21.969 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.019 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.154 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.185 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.309 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.472 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.588 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.792 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:22.918 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:23.444 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:23.523 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:23.571 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:23.664 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:23.867 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:23.990 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.021 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.114 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.163 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.319 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.350 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.412 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.489 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.504 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.613 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.707 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.769 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.785 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.862 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:24.900 +08:00 [INF] === 开始登录流程 ===
2025-10-26 22:40:24.901 +08:00 [INF] 用户名: student
2025-10-26 22:40:24.901 +08:00 [INF] 密码长度: 10
2025-10-26 22:40:24.901 +08:00 [INF] AuthService是否为null: False
2025-10-26 22:40:24.901 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 22:40:24.901 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 22:40:24.901 +08:00 [INF] 接收到的用户名: student
2025-10-26 22:40:24.901 +08:00 [INF] 接收到的密码长度: 10
2025-10-26 22:40:24.901 +08:00 [INF] 开始查询用户
2025-10-26 22:40:24.901 +08:00 [INF] UserRepository是否为null: False
2025-10-26 22:40:24.901 +08:00 [INF] Context是否为null: False
2025-10-26 22:40:24.901 +08:00 [INF] 测试数据库连接...
2025-10-26 22:40:24.901 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:40:24.901 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:40:24.901 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.901 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.901 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.901 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:24.901 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 22:40:24.902 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.902 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.902 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:24.902 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:24.902 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:24.902 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:40:24.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:40:24.902 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.902 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:24.902 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.902 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:24.902 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 22:40:24.902 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.902 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.902 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:24.902 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:24.902 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:24.902 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:40:24.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:40:24.903 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.903 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:24.903 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:24.903 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:24.903 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 22:40:24.903 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-26 22:40:24.903 +08:00 [INF] 用户是否激活: True
2025-10-26 22:40:24.903 +08:00 [INF] 登录失败次数: 0
2025-10-26 22:40:24.903 +08:00 [INF] 检查账户锁定状态
2025-10-26 22:40:24.903 +08:00 [INF] 开始验证密码
2025-10-26 22:40:24.903 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 22:40:24.903 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 22:40:24.903 +08:00 [INF] 密码哈希前20字符: $2a$12$RSCC/MKIxSSeo...
2025-10-26 22:40:24.903 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-26 22:40:24.903 +08:00 [INF] 密码哈希长度: 60
2025-10-26 22:40:24.903 +08:00 [INF] 密码哈希前缀: $2a$12$RSC
2025-10-26 22:40:25.069 +08:00 [INF] 密码验证结果: True
2025-10-26 22:40:25.069 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 22:40:25.069 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 22:40:25.069 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 22:40:25.072 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 22:40:25.072 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:25.072 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 22:40:25.072 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.072 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.072 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.072 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.072 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.072 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:40:25.072 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:40:25.074 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.074 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 22:40:25.074 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.074 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.074 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:25.074 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 22:40:25.074 +08:00 [INF] 用户信息更新完成
2025-10-26 22:40:25.074 +08:00 [INF] 用户登录成功 - student
2025-10-26 22:40:25.074 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 22:40:25.074 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 22:40:25.074 +08:00 [INF] 成功: True
2025-10-26 22:40:25.074 +08:00 [INF] 消息: 登录成功
2025-10-26 22:40:25.074 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:40:25.074 +08:00 [INF] 用户 student 登录成功
2025-10-26 22:40:25.074 +08:00 [INF] 上次登录时间: 2025-10-26 22:39:50
2025-10-26 22:40:25.074 +08:00 [INF] 触发登录成功事件
2025-10-26 22:40:25.074 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 22:40:25.074 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-26 22:40:25.074 +08:00 [INF] 用户ID: 2
2025-10-26 22:40:25.074 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:40:25.076 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 22:40:25.076 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 22:40:25.076 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-26 22:40:25.078 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 22:40:25.078 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.078 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.078 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.078 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.078 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.078 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:40:25.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:40:25.079 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.079 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.079 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.079 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.079 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.079 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:40:25.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:40:25.079 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.079 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.079 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.079 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.079 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.079 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.079 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:40:25.080 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:40:25.080 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.080 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.080 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.080 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.080 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.080 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.080 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.080 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.080 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.080 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:25.080 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:25.080 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.080 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.080 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.080 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.081 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.081 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.081 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.081 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.081 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.081 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:25.082 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 22:40:25.082 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:25.082 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.082 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.082 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.082 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.083 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 22:40:25.083 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 22:40:25.083 +08:00 [INF] 接收到的用户: student (Student)
2025-10-26 22:40:25.083 +08:00 [INF] 用户ID: 2
2025-10-26 22:40:25.083 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:40:25.083 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-26 22:40:25.083 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 22:40:25.083 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 22:40:25.084 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.084 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.084 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.084 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.084 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.084 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:25.084 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 22:40:25.084 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.084 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.084 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.084 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.084 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 22:40:25.085 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-26 22:40:25.085 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-26 22:40:25.085 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-26 22:40:25.086 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.086 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.086 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.086 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.086 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.086 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 22:40:25.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 22:40:25.086 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.086 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.086 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.086 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.086 +08:00 [INF] 成功获取 0 个已发布的试卷
2025-10-26 22:40:25.086 +08:00 [INF] 成功加载 0 个可参加的考试
2025-10-26 22:40:25.087 +08:00 [INF] 开始加载学生考试结果
2025-10-26 22:40:25.087 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.087 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.087 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.087 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.087 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.087 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:40:25.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:40:25.087 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.087 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.087 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.087 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.087 +08:00 [INF] 成功加载 0 条考试结果
2025-10-26 22:40:25.089 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.089 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.089 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.089 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 22:40:25.089 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 22:40:25.089 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.089 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.089 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.089 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.089 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.089 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 22:40:25.089 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 22:40:25.089 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.089 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.089 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.094 +08:00 [INF] 所有页面加载完成
2025-10-26 22:40:25.094 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 22:40:25.094 +08:00 [INF] 当前用户: student (Student)
2025-10-26 22:40:25.094 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 22:40:25.094 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 22:40:25.094 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 22:40:25.094 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 22:40:25.094 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 22:40:25.094 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 22:40:25.094 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 22:40:25.094 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 22:40:25.094 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 22:40:25.094 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 22:40:25.094 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 22:40:25.094 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 22:40:25.094 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 22:40:25.094 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 22:40:25.094 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 22:40:25.128 +08:00 [INF] 关闭登录窗口
2025-10-26 22:40:25.130 +08:00 [INF] === 登录流程结束 ===
2025-10-26 22:40:25.136 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.136 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.136 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.136 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.136 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.136 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:40:25.136 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 22:40:25.136 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:40:25.136 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.136 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.136 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.136 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.137 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:40:25.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 22:40:25.137 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.137 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.137 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:40:25.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 22:40:25.137 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.137 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:40:25.137 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:40:25.137 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:25.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 22:40:25.137 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:40:25.137 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:40:25.137 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:40:25.143 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:25.172 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:30.333 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:31.270 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:33.811 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:35.697 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:40:39.957 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 22:48:56.749 +08:00 [DBG] Hosting starting
2025-10-26 22:48:56.769 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-26 22:48:56.771 +08:00 [INF] Hosting environment: Production
2025-10-26 22:48:56.771 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-26 22:48:56.772 +08:00 [DBG] Hosting started
2025-10-26 22:48:56.804 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-26 22:48:56.815 +08:00 [INF] SQLite 数据库路径: E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db
2025-10-26 22:48:56.907 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:48:56.927 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:48:56.984 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:48:56.984 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:48:57.000 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-26 22:48:57.118 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 22:48:57.121 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:48:57.125 +08:00 [DBG] Created DbConnection. (2ms).
2025-10-26 22:48:57.127 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.128 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:48:57.129 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:48:57.129 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.133 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.134 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.136 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.140 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:48:57.142 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-10-26 22:48:57.142 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-10-26 22:48:57.143 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.149 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.151 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.159 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.160 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.161 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.162 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:48:57.162 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:48:57.162 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.162 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.162 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.162 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.162 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:48:57.162 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:48:57.162 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:48:57.162 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.162 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.163 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.163 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.163 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.163 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.168 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.168 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.168 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:48:57.168 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.168 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.168 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:48:57.168 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:48:57.170 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.171 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 22:48:57.171 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.171 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.176 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 22:48:57.177 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.177 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:48:57.177 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:48:57.177 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.177 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.177 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.177 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.177 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:48:57.177 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:48:57.177 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:48:57.177 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.177 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.177 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.177 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.177 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:48:57.178 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:48:57.178 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.178 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:48:57.178 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:48:57.178 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.178 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:48:57.178 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:48:57.178 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:48:57.178 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.178 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.178 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 22:48:57.193 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-26 22:48:57.246 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:48:57.254 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.254 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.254 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:48:57.254 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.254 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.254 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 22:48:57.254 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 22:48:57.255 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.255 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:48:57.255 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.255 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.255 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-26 22:48:57.257 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:48:57.257 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.257 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.257 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:48:57.257 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.257 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.257 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 22:48:57.257 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 22:48:57.257 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.257 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:48:57.257 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.257 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.257 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-26 22:48:57.258 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:48:57.258 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.258 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.258 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:48:57.258 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.258 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:48:57.258 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 22:48:57.258 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 22:48:57.258 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.258 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:48:57.259 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.259 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.259 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 22:48:57.259 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:48:57.259 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:48:57.263 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 22:49:26.689 +08:00 [INF] === 开始登录流程 ===
2025-10-26 22:49:26.689 +08:00 [INF] 用户名: admin
2025-10-26 22:49:26.689 +08:00 [INF] 密码长度: 8
2025-10-26 22:49:26.689 +08:00 [INF] AuthService是否为null: False
2025-10-26 22:49:26.689 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 22:49:26.691 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 22:49:26.691 +08:00 [INF] 接收到的用户名: admin
2025-10-26 22:49:26.691 +08:00 [INF] 接收到的密码长度: 8
2025-10-26 22:49:26.691 +08:00 [INF] 开始查询用户
2025-10-26 22:49:26.691 +08:00 [INF] UserRepository是否为null: False
2025-10-26 22:49:26.691 +08:00 [INF] Context是否为null: False
2025-10-26 22:49:26.691 +08:00 [INF] 测试数据库连接...
2025-10-26 22:49:26.693 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:49:26.693 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:49:26.693 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.693 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.693 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.693 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:49:26.693 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 22:49:26.694 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-26 22:49:26.702 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:49:26.705 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:49:26.705 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:49:26.705 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.705 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.705 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:49:26.705 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:49:26.705 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:49:26.705 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:49:26.705 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:49:26.705 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.705 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:49:26.705 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.705 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:49:26.705 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 22:49:26.706 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-26 22:49:26.719 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:49:26.722 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.722 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.722 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:49:26.722 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:49:26.722 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:49:26.723 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:49:26.724 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:49:26.734 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:49:26.747 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.747 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 22ms reading results.
2025-10-26 22:49:26.747 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:26.747 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:49:26.747 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 22:49:26.748 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-26 22:49:26.748 +08:00 [INF] 用户是否激活: True
2025-10-26 22:49:26.748 +08:00 [INF] 登录失败次数: 0
2025-10-26 22:49:26.748 +08:00 [INF] 检查账户锁定状态
2025-10-26 22:49:26.750 +08:00 [INF] 开始验证密码
2025-10-26 22:49:26.750 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 22:49:26.750 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 22:49:26.750 +08:00 [INF] 密码哈希前20字符: $2a$12$h/NrNAeZeayrs...
2025-10-26 22:49:26.750 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-26 22:49:26.750 +08:00 [INF] 密码哈希长度: 60
2025-10-26 22:49:26.750 +08:00 [INF] 密码哈希前缀: $2a$12$h/N
2025-10-26 22:49:26.978 +08:00 [INF] 密码验证结果: True
2025-10-26 22:49:26.979 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 22:49:26.980 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 22:49:26.981 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 22:49:26.987 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 22:49:26.990 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:49:26.994 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 22:49:27.022 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:27.022 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:27.023 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:49:27.023 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:49:27.023 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:49:27.023 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:49:27.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:49:27.028 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:27.029 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 5ms reading results.
2025-10-26 22:49:27.029 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:27.029 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:49:27.031 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:49:27.032 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 22:49:27.032 +08:00 [INF] 用户信息更新完成
2025-10-26 22:49:27.032 +08:00 [INF] 用户登录成功 - admin
2025-10-26 22:49:27.032 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 22:49:27.032 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 22:49:27.032 +08:00 [INF] 成功: True
2025-10-26 22:49:27.032 +08:00 [INF] 消息: 登录成功
2025-10-26 22:49:27.032 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:49:27.032 +08:00 [INF] 用户 admin 登录成功
2025-10-26 22:49:27.034 +08:00 [INF] 上次登录时间: 2025-10-26 22:47:25
2025-10-26 22:49:27.034 +08:00 [INF] 触发登录成功事件
2025-10-26 22:49:27.034 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 22:49:27.035 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-26 22:49:27.035 +08:00 [INF] 用户ID: 1
2025-10-26 22:49:27.035 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:49:27.049 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 22:49:27.049 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 22:49:27.053 +08:00 [ERR] 加载页面时发生错误
System.Windows.Markup.XamlParseException: “在“System.Windows.Markup.StaticResourceHolder”上提供值时引发了异常。”，行号为“63”，行位置为“28”。
 ---> System.Exception: 无法找到名为“Card”的资源。资源名称区分大小写。
   at System.Windows.StaticResourceExtension.ProvideValueInternal(IServiceProvider serviceProvider, Boolean allowDeferredReference)
   at MS.Internal.Xaml.Runtime.ClrObjectRuntime.CallProvideValue(MarkupExtension me, IServiceProvider serviceProvider)
   --- End of inner exception stack trace ---
   at System.Windows.Markup.XamlReader.RewrapException(Exception e, IXamlLineInfo lineInfo, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri)
   at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)
   at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)
   at ExamSystem.WPF.Views.DashboardView.InitializeComponent() in E:\Project\exam_trae\ExamSystem.WPF\Views\DashboardView.xaml:line 1
   at ExamSystem.WPF.Views.DashboardView..ctor(DashboardViewModel viewModel) in E:\Project\exam_trae\ExamSystem.WPF\Views\DashboardView.xaml.cs:line 12
   at ExamSystem.WPF.App.<>c.<CreateHostBuilder>b__8_2(IServiceProvider provider) in E:\Project\exam_trae\ExamSystem.WPF\App.xaml.cs:line 143
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ExamSystem.WPF.Views.MainWindow.LoadPages() in E:\Project\exam_trae\ExamSystem.WPF\Views\MainWindow.xaml.cs:line 145
2025-10-26 22:49:29.350 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 22:49:29.350 +08:00 [INF] 当前用户: admin (Admin)
2025-10-26 22:49:29.350 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 22:49:29.350 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 22:49:29.350 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 22:49:29.350 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 22:49:29.350 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 22:49:29.350 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 22:49:29.350 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 22:49:29.350 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 22:49:29.350 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 22:49:29.350 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 22:49:29.350 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 22:49:29.350 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 22:49:29.350 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 22:49:29.350 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 22:49:29.350 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 22:49:29.371 +08:00 [INF] 关闭登录窗口
2025-10-26 22:49:29.375 +08:00 [INF] === 登录流程结束 ===
2025-10-26 22:49:31.481 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 22:49:33.548 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 22:49:33.549 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:49:33.549 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:52.819 +08:00 [DBG] Hosting starting
2025-10-26 22:50:52.838 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-26 22:50:52.840 +08:00 [INF] Hosting environment: Production
2025-10-26 22:50:52.841 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-26 22:50:52.841 +08:00 [DBG] Hosting started
2025-10-26 22:50:52.873 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-26 22:50:52.885 +08:00 [INF] SQLite 数据库路径: E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db
2025-10-26 22:50:52.972 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:50:52.989 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:50:53.040 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:50:53.040 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 22:50:53.054 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-26 22:50:53.165 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 22:50:53.168 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:50:53.172 +08:00 [DBG] Created DbConnection. (2ms).
2025-10-26 22:50:53.174 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.177 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:50:53.178 +08:00 [DBG] Created DbConnection. (1ms).
2025-10-26 22:50:53.179 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.183 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.184 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.186 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.190 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:50:53.192 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-10-26 22:50:53.193 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (4ms).
2025-10-26 22:50:53.193 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.199 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.201 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.210 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.211 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.212 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.213 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:50:53.213 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:50:53.213 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.213 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.213 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.213 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.213 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:50:53.213 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:50:53.213 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:50:53.213 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.213 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.213 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.213 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.213 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.213 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.218 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.218 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.218 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:50:53.218 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.218 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.219 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:50:53.219 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:50:53.221 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.221 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 22:50:53.221 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.221 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.227 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 22:50:53.228 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.228 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:50:53.228 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:50:53.228 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.228 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:50:53.229 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.229 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.229 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:50:53.229 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 22:50:53.229 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.229 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 22:50:53.229 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:50:53.229 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.229 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:50:53.229 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 22:50:53.229 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:50:53.229 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.229 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.230 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 22:50:53.245 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-26 22:50:53.296 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:50:53.304 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.304 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.304 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:50:53.304 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.304 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.304 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 22:50:53.304 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 22:50:53.305 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.305 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:50:53.305 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.305 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.305 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-26 22:50:53.306 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:50:53.306 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.306 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.306 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:50:53.306 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.306 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.307 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 22:50:53.307 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 22:50:53.307 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.307 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:50:53.307 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.307 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.307 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-26 22:50:53.308 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:50:53.308 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.309 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.309 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:50:53.309 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.309 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:50:53.309 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 22:50:53.309 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 22:50:53.309 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.309 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:50:53.309 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.309 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.310 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 22:50:53.310 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:50:53.310 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:50:53.322 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 22:51:32.235 +08:00 [INF] === 开始登录流程 ===
2025-10-26 22:51:32.235 +08:00 [INF] 用户名: student
2025-10-26 22:51:32.235 +08:00 [INF] 密码长度: 10
2025-10-26 22:51:32.235 +08:00 [INF] AuthService是否为null: False
2025-10-26 22:51:32.235 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 22:51:32.237 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 22:51:32.237 +08:00 [INF] 接收到的用户名: student
2025-10-26 22:51:32.237 +08:00 [INF] 接收到的密码长度: 10
2025-10-26 22:51:32.237 +08:00 [INF] 开始查询用户
2025-10-26 22:51:32.237 +08:00 [INF] UserRepository是否为null: False
2025-10-26 22:51:32.237 +08:00 [INF] Context是否为null: False
2025-10-26 22:51:32.237 +08:00 [INF] 测试数据库连接...
2025-10-26 22:51:32.239 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:51:32.239 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:51:32.239 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.239 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.239 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.239 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:51:32.239 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 22:51:32.240 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-26 22:51:32.249 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:51:32.251 +08:00 [DBG] Creating DbConnection.
2025-10-26 22:51:32.251 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 22:51:32.251 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.251 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.251 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:51:32.251 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:51:32.251 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:51:32.251 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:51:32.251 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 22:51:32.251 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.251 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 22:51:32.251 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.251 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:51:32.251 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 22:51:32.252 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-26 22:51:32.265 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 22:51:32.268 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.268 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.268 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:51:32.268 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:51:32.268 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:51:32.269 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:51:32.270 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 22:51:32.282 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:51:32.295 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.295 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 24ms reading results.
2025-10-26 22:51:32.295 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.295 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:51:32.295 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 22:51:32.296 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-26 22:51:32.296 +08:00 [INF] 用户是否激活: True
2025-10-26 22:51:32.296 +08:00 [INF] 登录失败次数: 0
2025-10-26 22:51:32.296 +08:00 [INF] 检查账户锁定状态
2025-10-26 22:51:32.298 +08:00 [INF] 开始验证密码
2025-10-26 22:51:32.298 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 22:51:32.298 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 22:51:32.298 +08:00 [INF] 密码哈希前20字符: $2a$12$RSCC/MKIxSSeo...
2025-10-26 22:51:32.298 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-26 22:51:32.298 +08:00 [INF] 密码哈希长度: 60
2025-10-26 22:51:32.298 +08:00 [INF] 密码哈希前缀: $2a$12$RSC
2025-10-26 22:51:32.518 +08:00 [INF] 密码验证结果: True
2025-10-26 22:51:32.519 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 22:51:32.520 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 22:51:32.521 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 22:51:32.527 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 22:51:32.530 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:51:32.532 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 22:51:32.549 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.549 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.550 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 22:51:32.550 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:51:32.550 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 22:51:32.550 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:51:32.550 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 22:51:32.557 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.557 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' is being disposed after spending 6ms reading results.
2025-10-26 22:51:32.557 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:32.557 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 22:51:32.559 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 22:51:32.560 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 22:51:32.560 +08:00 [INF] 用户信息更新完成
2025-10-26 22:51:32.560 +08:00 [INF] 用户登录成功 - student
2025-10-26 22:51:32.560 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 22:51:32.561 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 22:51:32.561 +08:00 [INF] 成功: True
2025-10-26 22:51:32.561 +08:00 [INF] 消息: 登录成功
2025-10-26 22:51:32.561 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:51:32.561 +08:00 [INF] 用户 student 登录成功
2025-10-26 22:51:32.562 +08:00 [INF] 上次登录时间: 2025-10-26 22:40:25
2025-10-26 22:51:32.562 +08:00 [INF] 触发登录成功事件
2025-10-26 22:51:32.563 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 22:51:32.563 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-26 22:51:32.563 +08:00 [INF] 用户ID: 2
2025-10-26 22:51:32.563 +08:00 [INF] 用户对象是否为null: False
2025-10-26 22:51:32.577 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 22:51:32.577 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 22:51:32.578 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-26 22:51:32.583 +08:00 [ERR] 加载页面时发生错误
System.Windows.Markup.XamlParseException: “在“System.Windows.Markup.StaticResourceHolder”上提供值时引发了异常。”，行号为“63”，行位置为“28”。
 ---> System.Exception: 无法找到名为“Card”的资源。资源名称区分大小写。
   at System.Windows.StaticResourceExtension.ProvideValueInternal(IServiceProvider serviceProvider, Boolean allowDeferredReference)
   at MS.Internal.Xaml.Runtime.ClrObjectRuntime.CallProvideValue(MarkupExtension me, IServiceProvider serviceProvider)
   --- End of inner exception stack trace ---
   at System.Windows.Markup.XamlReader.RewrapException(Exception e, IXamlLineInfo lineInfo, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri)
   at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)
   at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)
   at ExamSystem.WPF.Views.DashboardView.InitializeComponent() in E:\Project\exam_trae\ExamSystem.WPF\Views\DashboardView.xaml:line 1
   at ExamSystem.WPF.Views.DashboardView..ctor(DashboardViewModel viewModel) in E:\Project\exam_trae\ExamSystem.WPF\Views\DashboardView.xaml.cs:line 12
   at ExamSystem.WPF.App.<>c.<CreateHostBuilder>b__8_2(IServiceProvider provider) in E:\Project\exam_trae\ExamSystem.WPF\App.xaml.cs:line 143
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ExamSystem.WPF.Views.MainWindow.LoadPages() in E:\Project\exam_trae\ExamSystem.WPF\Views\MainWindow.xaml.cs:line 145
2025-10-26 22:51:33.944 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 22:51:33.944 +08:00 [INF] 当前用户: student (Student)
2025-10-26 22:51:33.944 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 22:51:33.944 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 22:51:33.944 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 22:51:33.944 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 22:51:33.944 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 22:51:33.944 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 22:51:33.944 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 22:51:33.944 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 22:51:33.944 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 22:51:33.944 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 22:51:33.944 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 22:51:33.944 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 22:51:33.944 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 22:51:33.944 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 22:51:33.945 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 22:51:33.961 +08:00 [INF] 关闭登录窗口
2025-10-26 22:51:33.965 +08:00 [INF] === 登录流程结束 ===
2025-10-26 22:51:35.202 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 22:51:39.736 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 22:51:39.736 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db'.
2025-10-26 22:51:39.737 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows\exam_system.db' (0ms).
2025-10-26 23:01:27.104 +08:00 [DBG] Hosting starting
2025-10-26 23:01:27.124 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-26 23:01:27.126 +08:00 [INF] Hosting environment: Production
2025-10-26 23:01:27.126 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-26 23:01:27.126 +08:00 [DBG] Hosting started
2025-10-26 23:01:27.158 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-26 23:01:27.169 +08:00 [INF] SQLite 数据库路径: E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db
2025-10-26 23:01:27.517 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:01:27.535 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:01:27.589 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:01:27.589 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:01:27.604 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-26 23:01:27.718 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:01:27.721 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:01:27.725 +08:00 [DBG] Created DbConnection. (2ms).
2025-10-26 23:01:27.727 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.728 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:01:27.729 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:01:27.729 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.733 +08:00 [DBG] An error occurred using the connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.733 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.735 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.735 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:01:27.735 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:01:27.735 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.735 +08:00 [DBG] An error occurred using the connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.735 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.735 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.735 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.738 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.741 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.743 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-10-26 23:01:27.744 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (3ms).
2025-10-26 23:01:27.746 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
PRAGMA journal_mode = 'wal';
2025-10-26 23:01:27.765 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
PRAGMA journal_mode = 'wal';
2025-10-26 23:01:27.766 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.767 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.794 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.794 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.794 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.795 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.796 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.796 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-26 23:01:27.804 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-10-26 23:01:27.806 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.806 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.807 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:01:27.807 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:01:27.807 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.808 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.809 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.809 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.811 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:01:27.811 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:01:27.811 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:01:27.811 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.811 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.811 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:01:27.813 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:01:27.813 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.813 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.815 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.815 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.815 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:01:27.815 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.815 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.815 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:01:27.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:01:27.818 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.819 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:01:27.819 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.819 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.827 +08:00 [INF] Applying migration '20251017032241_InitialCreate'.
2025-10-26 23:01:27.862 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.862 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.863 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-26 23:01:27.864 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-26 23:01:27.865 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.865 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.865 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.865 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Users" (
    "UserId" INTEGER NOT NULL CONSTRAINT "PK_Users" PRIMARY KEY AUTOINCREMENT,
    "Username" TEXT NOT NULL,
    "PasswordHash" TEXT NOT NULL,
    "RealName" TEXT NULL,
    "Role" INTEGER NOT NULL,
    "Email" TEXT NULL,
    "Phone" TEXT NULL,
    "IsActive" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "LastLoginAt" TEXT NULL,
    "LoginFailCount" INTEGER NOT NULL,
    "LockoutEnd" TEXT NULL
);
2025-10-26 23:01:27.865 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Users" (
    "UserId" INTEGER NOT NULL CONSTRAINT "PK_Users" PRIMARY KEY AUTOINCREMENT,
    "Username" TEXT NOT NULL,
    "PasswordHash" TEXT NOT NULL,
    "RealName" TEXT NULL,
    "Role" INTEGER NOT NULL,
    "Email" TEXT NULL,
    "Phone" TEXT NULL,
    "IsActive" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "LastLoginAt" TEXT NULL,
    "LoginFailCount" INTEGER NOT NULL,
    "LockoutEnd" TEXT NULL
);
2025-10-26 23:01:27.865 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.865 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.865 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.865 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ExamPapers" (
    "PaperId" INTEGER NOT NULL CONSTRAINT "PK_ExamPapers" PRIMARY KEY AUTOINCREMENT,
    "Name" TEXT NOT NULL,
    "Description" TEXT NULL,
    "TotalScore" decimal(6,2) NOT NULL,
    "Duration" INTEGER NOT NULL,
    "CreatorId" INTEGER NOT NULL,
    "Status" TEXT NOT NULL,
    "StartTime" TEXT NULL,
    "EndTime" TEXT NULL,
    "CreatedAt" TEXT NOT NULL,
    "UpdatedAt" TEXT NOT NULL,
    "IsActive" INTEGER NOT NULL,
    "IsRandomOrder" INTEGER NOT NULL,
    "AllowRetake" INTEGER NOT NULL,
    "AllowViewAnswer" INTEGER NOT NULL,
    "PassScore" decimal(6,2) NOT NULL,
    CONSTRAINT "FK_ExamPapers_Users_CreatorId" FOREIGN KEY ("CreatorId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.865 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ExamPapers" (
    "PaperId" INTEGER NOT NULL CONSTRAINT "PK_ExamPapers" PRIMARY KEY AUTOINCREMENT,
    "Name" TEXT NOT NULL,
    "Description" TEXT NULL,
    "TotalScore" decimal(6,2) NOT NULL,
    "Duration" INTEGER NOT NULL,
    "CreatorId" INTEGER NOT NULL,
    "Status" TEXT NOT NULL,
    "StartTime" TEXT NULL,
    "EndTime" TEXT NULL,
    "CreatedAt" TEXT NOT NULL,
    "UpdatedAt" TEXT NOT NULL,
    "IsActive" INTEGER NOT NULL,
    "IsRandomOrder" INTEGER NOT NULL,
    "AllowRetake" INTEGER NOT NULL,
    "AllowViewAnswer" INTEGER NOT NULL,
    "PassScore" decimal(6,2) NOT NULL,
    CONSTRAINT "FK_ExamPapers_Users_CreatorId" FOREIGN KEY ("CreatorId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.865 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.865 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.865 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.865 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "QuestionBanks" (
    "BankId" INTEGER NOT NULL CONSTRAINT "PK_QuestionBanks" PRIMARY KEY AUTOINCREMENT,
    "Name" TEXT NOT NULL,
    "Description" TEXT NULL,
    "CreatorId" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "UpdatedAt" TEXT NOT NULL,
    "IsActive" INTEGER NOT NULL,
    CONSTRAINT "FK_QuestionBanks_Users_CreatorId" FOREIGN KEY ("CreatorId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "QuestionBanks" (
    "BankId" INTEGER NOT NULL CONSTRAINT "PK_QuestionBanks" PRIMARY KEY AUTOINCREMENT,
    "Name" TEXT NOT NULL,
    "Description" TEXT NULL,
    "CreatorId" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "UpdatedAt" TEXT NOT NULL,
    "IsActive" INTEGER NOT NULL,
    CONSTRAINT "FK_QuestionBanks_Users_CreatorId" FOREIGN KEY ("CreatorId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ExamRecords" (
    "RecordId" INTEGER NOT NULL CONSTRAINT "PK_ExamRecords" PRIMARY KEY AUTOINCREMENT,
    "UserId" INTEGER NOT NULL,
    "PaperId" INTEGER NOT NULL,
    "StartTime" TEXT NULL,
    "EndTime" TEXT NULL,
    "SubmitTime" TEXT NULL,
    "Status" INTEGER NOT NULL,
    "TotalScore" decimal(6,2) NOT NULL,
    "ObjectiveScore" decimal(6,2) NOT NULL,
    "SubjectiveScore" decimal(6,2) NOT NULL,
    "CorrectCount" INTEGER NOT NULL,
    "TotalCount" INTEGER NOT NULL,
    "IsPassed" INTEGER NOT NULL,
    "RemainingTime" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "GradedAt" TEXT NULL,
    "GraderId" INTEGER NULL,
    CONSTRAINT "FK_ExamRecords_ExamPapers_PaperId" FOREIGN KEY ("PaperId") REFERENCES "ExamPapers" ("PaperId") ON DELETE RESTRICT,
    CONSTRAINT "FK_ExamRecords_Users_GraderId" FOREIGN KEY ("GraderId") REFERENCES "Users" ("UserId") ON DELETE SET NULL,
    CONSTRAINT "FK_ExamRecords_Users_UserId" FOREIGN KEY ("UserId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ExamRecords" (
    "RecordId" INTEGER NOT NULL CONSTRAINT "PK_ExamRecords" PRIMARY KEY AUTOINCREMENT,
    "UserId" INTEGER NOT NULL,
    "PaperId" INTEGER NOT NULL,
    "StartTime" TEXT NULL,
    "EndTime" TEXT NULL,
    "SubmitTime" TEXT NULL,
    "Status" INTEGER NOT NULL,
    "TotalScore" decimal(6,2) NOT NULL,
    "ObjectiveScore" decimal(6,2) NOT NULL,
    "SubjectiveScore" decimal(6,2) NOT NULL,
    "CorrectCount" INTEGER NOT NULL,
    "TotalCount" INTEGER NOT NULL,
    "IsPassed" INTEGER NOT NULL,
    "RemainingTime" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "GradedAt" TEXT NULL,
    "GraderId" INTEGER NULL,
    CONSTRAINT "FK_ExamRecords_ExamPapers_PaperId" FOREIGN KEY ("PaperId") REFERENCES "ExamPapers" ("PaperId") ON DELETE RESTRICT,
    CONSTRAINT "FK_ExamRecords_Users_GraderId" FOREIGN KEY ("GraderId") REFERENCES "Users" ("UserId") ON DELETE SET NULL,
    CONSTRAINT "FK_ExamRecords_Users_UserId" FOREIGN KEY ("UserId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Questions" (
    "QuestionId" INTEGER NOT NULL CONSTRAINT "PK_Questions" PRIMARY KEY AUTOINCREMENT,
    "BankId" INTEGER NOT NULL,
    "QuestionType" INTEGER NOT NULL,
    "Title" TEXT NOT NULL,
    "Content" TEXT NOT NULL,
    "Answer" TEXT NOT NULL,
    "Analysis" TEXT NULL,
    "Score" decimal(5,2) NOT NULL,
    "Difficulty" INTEGER NOT NULL,
    "Tags" TEXT NULL,
    "CreatedAt" TEXT NOT NULL,
    "UpdatedAt" TEXT NOT NULL,
    "IsActive" INTEGER NOT NULL,
    CONSTRAINT "FK_Questions_QuestionBanks_BankId" FOREIGN KEY ("BankId") REFERENCES "QuestionBanks" ("BankId") ON DELETE CASCADE
);
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Questions" (
    "QuestionId" INTEGER NOT NULL CONSTRAINT "PK_Questions" PRIMARY KEY AUTOINCREMENT,
    "BankId" INTEGER NOT NULL,
    "QuestionType" INTEGER NOT NULL,
    "Title" TEXT NOT NULL,
    "Content" TEXT NOT NULL,
    "Answer" TEXT NOT NULL,
    "Analysis" TEXT NULL,
    "Score" decimal(5,2) NOT NULL,
    "Difficulty" INTEGER NOT NULL,
    "Tags" TEXT NULL,
    "CreatedAt" TEXT NOT NULL,
    "UpdatedAt" TEXT NOT NULL,
    "IsActive" INTEGER NOT NULL,
    CONSTRAINT "FK_Questions_QuestionBanks_BankId" FOREIGN KEY ("BankId") REFERENCES "QuestionBanks" ("BankId") ON DELETE CASCADE
);
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AnswerRecords" (
    "AnswerId" INTEGER NOT NULL CONSTRAINT "PK_AnswerRecords" PRIMARY KEY AUTOINCREMENT,
    "RecordId" INTEGER NOT NULL,
    "QuestionId" INTEGER NOT NULL,
    "UserAnswer" TEXT NULL,
    "Score" decimal(5,2) NOT NULL,
    "IsCorrect" INTEGER NOT NULL,
    "IsGraded" INTEGER NOT NULL,
    "Comment" TEXT NULL,
    "AnswerTime" TEXT NULL,
    "GradeTime" TEXT NULL,
    "GraderId" INTEGER NULL,
    CONSTRAINT "FK_AnswerRecords_ExamRecords_RecordId" FOREIGN KEY ("RecordId") REFERENCES "ExamRecords" ("RecordId") ON DELETE CASCADE,
    CONSTRAINT "FK_AnswerRecords_Questions_QuestionId" FOREIGN KEY ("QuestionId") REFERENCES "Questions" ("QuestionId") ON DELETE RESTRICT,
    CONSTRAINT "FK_AnswerRecords_Users_GraderId" FOREIGN KEY ("GraderId") REFERENCES "Users" ("UserId") ON DELETE SET NULL
);
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "AnswerRecords" (
    "AnswerId" INTEGER NOT NULL CONSTRAINT "PK_AnswerRecords" PRIMARY KEY AUTOINCREMENT,
    "RecordId" INTEGER NOT NULL,
    "QuestionId" INTEGER NOT NULL,
    "UserAnswer" TEXT NULL,
    "Score" decimal(5,2) NOT NULL,
    "IsCorrect" INTEGER NOT NULL,
    "IsGraded" INTEGER NOT NULL,
    "Comment" TEXT NULL,
    "AnswerTime" TEXT NULL,
    "GradeTime" TEXT NULL,
    "GraderId" INTEGER NULL,
    CONSTRAINT "FK_AnswerRecords_ExamRecords_RecordId" FOREIGN KEY ("RecordId") REFERENCES "ExamRecords" ("RecordId") ON DELETE CASCADE,
    CONSTRAINT "FK_AnswerRecords_Questions_QuestionId" FOREIGN KEY ("QuestionId") REFERENCES "Questions" ("QuestionId") ON DELETE RESTRICT,
    CONSTRAINT "FK_AnswerRecords_Users_GraderId" FOREIGN KEY ("GraderId") REFERENCES "Users" ("UserId") ON DELETE SET NULL
);
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "PaperQuestions" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK_PaperQuestions" PRIMARY KEY AUTOINCREMENT,
    "PaperId" INTEGER NOT NULL,
    "QuestionId" INTEGER NOT NULL,
    "OrderIndex" INTEGER NOT NULL,
    "Score" decimal(5,2) NOT NULL,
    CONSTRAINT "FK_PaperQuestions_ExamPapers_PaperId" FOREIGN KEY ("PaperId") REFERENCES "ExamPapers" ("PaperId") ON DELETE CASCADE,
    CONSTRAINT "FK_PaperQuestions_Questions_QuestionId" FOREIGN KEY ("QuestionId") REFERENCES "Questions" ("QuestionId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "PaperQuestions" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK_PaperQuestions" PRIMARY KEY AUTOINCREMENT,
    "PaperId" INTEGER NOT NULL,
    "QuestionId" INTEGER NOT NULL,
    "OrderIndex" INTEGER NOT NULL,
    "Score" decimal(5,2) NOT NULL,
    CONSTRAINT "FK_PaperQuestions_ExamPapers_PaperId" FOREIGN KEY ("PaperId") REFERENCES "ExamPapers" ("PaperId") ON DELETE CASCADE,
    CONSTRAINT "FK_PaperQuestions_Questions_QuestionId" FOREIGN KEY ("QuestionId") REFERENCES "Questions" ("QuestionId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "QuestionOptions" (
    "OptionId" INTEGER NOT NULL CONSTRAINT "PK_QuestionOptions" PRIMARY KEY AUTOINCREMENT,
    "QuestionId" INTEGER NOT NULL,
    "OptionLabel" TEXT NOT NULL,
    "Content" TEXT NOT NULL,
    "IsCorrect" INTEGER NOT NULL,
    "OrderIndex" INTEGER NOT NULL,
    CONSTRAINT "FK_QuestionOptions_Questions_QuestionId" FOREIGN KEY ("QuestionId") REFERENCES "Questions" ("QuestionId") ON DELETE CASCADE
);
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "QuestionOptions" (
    "OptionId" INTEGER NOT NULL CONSTRAINT "PK_QuestionOptions" PRIMARY KEY AUTOINCREMENT,
    "QuestionId" INTEGER NOT NULL,
    "OptionLabel" TEXT NOT NULL,
    "Content" TEXT NOT NULL,
    "IsCorrect" INTEGER NOT NULL,
    "OrderIndex" INTEGER NOT NULL,
    CONSTRAINT "FK_QuestionOptions_Questions_QuestionId" FOREIGN KEY ("QuestionId") REFERENCES "Questions" ("QuestionId") ON DELETE CASCADE
);
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("UserId", "CreatedAt", "Email", "IsActive", "LastLoginAt", "LockoutEnd", "LoginFailCount", "PasswordHash", "Phone", "RealName", "Role", "Username")
VALUES (1, '2025-10-17 11:22:41.2195357', 'admin@exam.com', 1, NULL, NULL, 0, 'admin123', NULL, '系统管理员', 2, 'admin');
SELECT changes();
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("UserId", "CreatedAt", "Email", "IsActive", "LastLoginAt", "LockoutEnd", "LoginFailCount", "PasswordHash", "Phone", "RealName", "Role", "Username")
VALUES (1, '2025-10-17 11:22:41.2195357', 'admin@exam.com', 1, NULL, NULL, 0, 'admin123', NULL, '系统管理员', 2, 'admin');
SELECT changes();
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "QuestionBanks" ("BankId", "CreatedAt", "CreatorId", "Description", "IsActive", "Name", "UpdatedAt")
VALUES (1, '2025-10-17 11:22:41.2203938', 1, '系统默认题库', 1, '默认题库', '2025-10-17 11:22:41.2204049');
SELECT changes();
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "QuestionBanks" ("BankId", "CreatedAt", "CreatorId", "Description", "IsActive", "Name", "UpdatedAt")
VALUES (1, '2025-10-17 11:22:41.2203938', 1, '系统默认题库', 1, '默认题库', '2025-10-17 11:22:41.2204049');
SELECT changes();
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AnswerRecords_GraderId" ON "AnswerRecords" ("GraderId");
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AnswerRecords_GraderId" ON "AnswerRecords" ("GraderId");
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AnswerRecords_QuestionId" ON "AnswerRecords" ("QuestionId");
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AnswerRecords_QuestionId" ON "AnswerRecords" ("QuestionId");
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AnswerRecords_RecordId" ON "AnswerRecords" ("RecordId");
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_AnswerRecords_RecordId" ON "AnswerRecords" ("RecordId");
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamPapers_CreatorId" ON "ExamPapers" ("CreatorId");
2025-10-26 23:01:27.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamPapers_CreatorId" ON "ExamPapers" ("CreatorId");
2025-10-26 23:01:27.866 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.866 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.866 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamRecords_GraderId" ON "ExamRecords" ("GraderId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamRecords_GraderId" ON "ExamRecords" ("GraderId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamRecords_PaperId" ON "ExamRecords" ("PaperId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamRecords_PaperId" ON "ExamRecords" ("PaperId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamRecords_UserId" ON "ExamRecords" ("UserId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ExamRecords_UserId" ON "ExamRecords" ("UserId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_PaperQuestions_PaperId" ON "PaperQuestions" ("PaperId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_PaperQuestions_PaperId" ON "PaperQuestions" ("PaperId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_PaperQuestions_QuestionId" ON "PaperQuestions" ("QuestionId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_PaperQuestions_QuestionId" ON "PaperQuestions" ("QuestionId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_QuestionBanks_CreatorId" ON "QuestionBanks" ("CreatorId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_QuestionBanks_CreatorId" ON "QuestionBanks" ("CreatorId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_QuestionOptions_QuestionId" ON "QuestionOptions" ("QuestionId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_QuestionOptions_QuestionId" ON "QuestionOptions" ("QuestionId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Questions_BankId" ON "Questions" ("BankId");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Questions_BankId" ON "Questions" ("BankId");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_Users_Email" ON "Users" ("Email");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_Users_Email" ON "Users" ("Email");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_Users_Username" ON "Users" ("Username");
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_Users_Username" ON "Users" ("Username");
2025-10-26 23:01:27.867 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.867 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.867 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251017032241_InitialCreate', '8.0.8');
2025-10-26 23:01:27.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251017032241_InitialCreate', '8.0.8');
2025-10-26 23:01:27.868 +08:00 [DBG] Committing transaction.
2025-10-26 23:01:27.871 +08:00 [DBG] Committed transaction.
2025-10-26 23:01:27.872 +08:00 [DBG] Disposing transaction.
2025-10-26 23:01:27.872 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.872 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.873 +08:00 [INF] Applying migration '20251019171711_AddNotifications'.
2025-10-26 23:01:27.883 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.883 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.883 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-26 23:01:27.883 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-26 23:01:27.883 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.883 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.883 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.883 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Notifications" (
    "NotificationId" INTEGER NOT NULL CONSTRAINT "PK_Notifications" PRIMARY KEY AUTOINCREMENT,
    "Title" TEXT NOT NULL,
    "Content" TEXT NOT NULL,
    "Priority" INTEGER NOT NULL,
    "Status" INTEGER NOT NULL,
    "Scope" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "SenderId" INTEGER NOT NULL,
    CONSTRAINT "FK_Notifications_Users_SenderId" FOREIGN KEY ("SenderId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.883 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Notifications" (
    "NotificationId" INTEGER NOT NULL CONSTRAINT "PK_Notifications" PRIMARY KEY AUTOINCREMENT,
    "Title" TEXT NOT NULL,
    "Content" TEXT NOT NULL,
    "Priority" INTEGER NOT NULL,
    "Status" INTEGER NOT NULL,
    "Scope" INTEGER NOT NULL,
    "CreatedAt" TEXT NOT NULL,
    "SenderId" INTEGER NOT NULL,
    CONSTRAINT "FK_Notifications_Users_SenderId" FOREIGN KEY ("SenderId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.884 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.884 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "NotificationRecipients" (
    "NotificationRecipientId" INTEGER NOT NULL CONSTRAINT "PK_NotificationRecipients" PRIMARY KEY AUTOINCREMENT,
    "NotificationId" INTEGER NOT NULL,
    "ReceiverId" INTEGER NOT NULL,
    "DeliveryStatus" INTEGER NOT NULL,
    "ReadAt" TEXT NULL,
    "CreatedAt" TEXT NOT NULL,
    CONSTRAINT "FK_NotificationRecipients_Notifications_NotificationId" FOREIGN KEY ("NotificationId") REFERENCES "Notifications" ("NotificationId") ON DELETE CASCADE,
    CONSTRAINT "FK_NotificationRecipients_Users_ReceiverId" FOREIGN KEY ("ReceiverId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "NotificationRecipients" (
    "NotificationRecipientId" INTEGER NOT NULL CONSTRAINT "PK_NotificationRecipients" PRIMARY KEY AUTOINCREMENT,
    "NotificationId" INTEGER NOT NULL,
    "ReceiverId" INTEGER NOT NULL,
    "DeliveryStatus" INTEGER NOT NULL,
    "ReadAt" TEXT NULL,
    "CreatedAt" TEXT NOT NULL,
    CONSTRAINT "FK_NotificationRecipients_Notifications_NotificationId" FOREIGN KEY ("NotificationId") REFERENCES "Notifications" ("NotificationId") ON DELETE CASCADE,
    CONSTRAINT "FK_NotificationRecipients_Users_ReceiverId" FOREIGN KEY ("ReceiverId") REFERENCES "Users" ("UserId") ON DELETE RESTRICT
);
2025-10-26 23:01:27.884 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.884 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "QuestionBanks" SET "CreatedAt" = '2025-10-20 01:17:10.7265189', "UpdatedAt" = '2025-10-20 01:17:10.7265259'
WHERE "BankId" = 1;
SELECT changes();
2025-10-26 23:01:27.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "QuestionBanks" SET "CreatedAt" = '2025-10-20 01:17:10.7265189', "UpdatedAt" = '2025-10-20 01:17:10.7265259'
WHERE "BankId" = 1;
SELECT changes();
2025-10-26 23:01:27.884 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.884 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "CreatedAt" = '2025-10-20 01:17:10.7259707'
WHERE "UserId" = 1;
SELECT changes();
2025-10-26 23:01:27.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "CreatedAt" = '2025-10-20 01:17:10.7259707'
WHERE "UserId" = 1;
SELECT changes();
2025-10-26 23:01:27.884 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.884 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_NotificationRecipients_NotificationId_ReceiverId" ON "NotificationRecipients" ("NotificationId", "ReceiverId");
2025-10-26 23:01:27.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_NotificationRecipients_NotificationId_ReceiverId" ON "NotificationRecipients" ("NotificationId", "ReceiverId");
2025-10-26 23:01:27.884 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.884 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_NotificationRecipients_ReceiverId" ON "NotificationRecipients" ("ReceiverId");
2025-10-26 23:01:27.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_NotificationRecipients_ReceiverId" ON "NotificationRecipients" ("ReceiverId");
2025-10-26 23:01:27.884 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.884 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Notifications_SenderId" ON "Notifications" ("SenderId");
2025-10-26 23:01:27.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Notifications_SenderId" ON "Notifications" ("SenderId");
2025-10-26 23:01:27.884 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.884 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.884 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251019171711_AddNotifications', '8.0.8');
2025-10-26 23:01:27.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251019171711_AddNotifications', '8.0.8');
2025-10-26 23:01:27.884 +08:00 [DBG] Committing transaction.
2025-10-26 23:01:27.886 +08:00 [DBG] Committed transaction.
2025-10-26 23:01:27.886 +08:00 [DBG] Disposing transaction.
2025-10-26 23:01:27.886 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.886 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.886 +08:00 [INF] Applying migration '20251021025830_AddIsPublishedToExamPapers'.
2025-10-26 23:01:27.901 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.901 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.901 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-26 23:01:27.902 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-26 23:01:27.902 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.902 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "ExamPapers" ADD "IsPublished" INTEGER NOT NULL DEFAULT 0;
2025-10-26 23:01:27.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "ExamPapers" ADD "IsPublished" INTEGER NOT NULL DEFAULT 0;
2025-10-26 23:01:27.902 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.902 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "QuestionBanks" SET "CreatedAt" = '2025-10-21 10:58:29.8853725', "UpdatedAt" = '2025-10-21 10:58:29.8853797'
WHERE "BankId" = 1;
SELECT changes();
2025-10-26 23:01:27.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "QuestionBanks" SET "CreatedAt" = '2025-10-21 10:58:29.8853725', "UpdatedAt" = '2025-10-21 10:58:29.8853797'
WHERE "BankId" = 1;
SELECT changes();
2025-10-26 23:01:27.902 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.902 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "CreatedAt" = '2025-10-21 10:58:29.884769'
WHERE "UserId" = 1;
SELECT changes();
2025-10-26 23:01:27.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "CreatedAt" = '2025-10-21 10:58:29.884769'
WHERE "UserId" = 1;
SELECT changes();
2025-10-26 23:01:27.902 +08:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-10-26 23:01:27.902 +08:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-10-26 23:01:27.902 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251021025830_AddIsPublishedToExamPapers', '8.0.8');
2025-10-26 23:01:27.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251021025830_AddIsPublishedToExamPapers', '8.0.8');
2025-10-26 23:01:27.902 +08:00 [DBG] Committing transaction.
2025-10-26 23:01:27.905 +08:00 [DBG] Committed transaction.
2025-10-26 23:01:27.905 +08:00 [DBG] Disposing transaction.
2025-10-26 23:01:27.905 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.905 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.906 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:01:27.907 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:01:27.907 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:01:27.907 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:01:27.907 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:01:27.907 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:01:27.907 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:01:27.907 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.907 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.908 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:01:27.908 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:01:27.908 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.908 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.908 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.908 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.908 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:01:27.908 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.908 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.908 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:01:27.908 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:01:27.908 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.908 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:01:27.908 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.908 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.909 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 23:01:27.925 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-26 23:01:27.979 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:01:27.986 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.986 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.986 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:01:27.986 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.986 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.986 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:01:27.987 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:01:27.987 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.987 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:01:27.987 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.987 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.987 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-26 23:01:27.988 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:01:27.989 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.989 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.989 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:01:27.989 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.989 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:27.989 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:01:27.989 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:01:27.989 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.989 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:01:27.989 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:27.989 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:27.989 +08:00 [INF] 创建测试学生用户
2025-10-26 23:01:28.226 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'User.UserId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:01:28.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:01:28.253 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:01:28.254 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:01:28.260 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:01:28.279 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.279 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.280 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:01:28.280 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:28.280 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:28.281 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 16), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (Size = 60), @p7='?', @p8='?' (Size = 4), @p9='?' (DbType = Int32), @p10='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("CreatedAt", "Email", "IsActive", "LastLoginAt", "LockoutEnd", "LoginFailCount", "PasswordHash", "Phone", "RealName", "Role", "Username")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "UserId";
2025-10-26 23:01:28.283 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 16), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (Size = 60), @p7='?', @p8='?' (Size = 4), @p9='?' (DbType = Int32), @p10='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("CreatedAt", "Email", "IsActive", "LastLoginAt", "LockoutEnd", "LoginFailCount", "PasswordHash", "Phone", "RealName", "Role", "Username")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "UserId";
2025-10-26 23:01:28.287 +08:00 [DBG] The foreign key property 'User.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:01:28.291 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.291 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 7ms reading results.
2025-10-26 23:01:28.291 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.291 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:28.294 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:01:28.295 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:01:28.295 +08:00 [INF] 测试学生用户创建成功 - 用户名: student, 密码: student123
2025-10-26 23:01:28.295 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-26 23:01:28.296 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:01:28.296 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.296 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.296 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:01:28.297 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:28.297 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:28.297 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:01:28.297 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:01:28.297 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.297 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:01:28.297 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.297 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:28.297 +08:00 [INF] 创建测试教师用户
2025-10-26 23:01:28.513 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'User.UserId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:01:28.513 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:01:28.514 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:01:28.514 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:01:28.514 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:01:28.515 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.515 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.515 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:01:28.515 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:28.515 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:01:28.515 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 16), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (Size = 60), @p7='?', @p8='?' (Size = 4), @p9='?' (DbType = Int32), @p10='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("CreatedAt", "Email", "IsActive", "LastLoginAt", "LockoutEnd", "LoginFailCount", "PasswordHash", "Phone", "RealName", "Role", "Username")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "UserId";
2025-10-26 23:01:28.515 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 16), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Int32), @p6='?' (Size = 60), @p7='?', @p8='?' (Size = 4), @p9='?' (DbType = Int32), @p10='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("CreatedAt", "Email", "IsActive", "LastLoginAt", "LockoutEnd", "LoginFailCount", "PasswordHash", "Phone", "RealName", "Role", "Username")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "UserId";
2025-10-26 23:01:28.515 +08:00 [DBG] The foreign key property 'User.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:01:28.517 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.517 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:01:28.517 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.517 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:28.517 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:01:28.517 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:01:28.517 +08:00 [INF] 测试教师用户创建成功 - 用户名: teacher, 密码: teacher123
2025-10-26 23:01:28.518 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 23:01:28.518 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:01:28.518 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:01:28.523 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:02:01.021 +08:00 [INF] === 开始登录流程 ===
2025-10-26 23:02:01.021 +08:00 [INF] 用户名: admin
2025-10-26 23:02:01.021 +08:00 [INF] 密码长度: 8
2025-10-26 23:02:01.021 +08:00 [INF] AuthService是否为null: False
2025-10-26 23:02:01.021 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 23:02:01.023 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 23:02:01.023 +08:00 [INF] 接收到的用户名: admin
2025-10-26 23:02:01.023 +08:00 [INF] 接收到的密码长度: 8
2025-10-26 23:02:01.023 +08:00 [INF] 开始查询用户
2025-10-26 23:02:01.023 +08:00 [INF] UserRepository是否为null: False
2025-10-26 23:02:01.023 +08:00 [INF] Context是否为null: False
2025-10-26 23:02:01.023 +08:00 [INF] 测试数据库连接...
2025-10-26 23:02:01.024 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:02:01.024 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:02:01.025 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.025 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.025 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.025 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:02:01.025 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 23:02:01.026 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-26 23:02:01.034 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:02:01.037 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:02:01.037 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:02:01.037 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.037 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.037 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:02:01.037 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.037 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.037 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:02:01.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:02:01.037 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.037 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:02:01.037 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.037 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:02:01.037 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 23:02:01.038 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-26 23:02:01.050 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:02:01.052 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.052 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.052 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:02:01.052 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.052 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.052 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:02:01.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:02:01.053 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:02:01.053 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.053 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:02:01.053 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.053 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:02:01.053 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 23:02:01.054 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-26 23:02:01.054 +08:00 [INF] 用户是否激活: True
2025-10-26 23:02:01.054 +08:00 [INF] 登录失败次数: 0
2025-10-26 23:02:01.054 +08:00 [INF] 检查账户锁定状态
2025-10-26 23:02:01.056 +08:00 [INF] 开始验证密码
2025-10-26 23:02:01.056 +08:00 [INF] 存储的密码哈希长度: 8
2025-10-26 23:02:01.056 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 23:02:01.056 +08:00 [INF] 密码哈希前20字符: admin123...
2025-10-26 23:02:01.056 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-26 23:02:01.056 +08:00 [INF] 密码哈希长度: 8
2025-10-26 23:02:01.056 +08:00 [INF] 密码哈希前缀: admin123
2025-10-26 23:02:01.057 +08:00 [ERR] 密码验证过程中发生异常
BCrypt.Net.SaltParseException: Invalid salt version
   at BCrypt.Net.BCrypt.HashPassword(String inputKey, String salt, Boolean enhancedEntropy, HashType hashType)
   at BCrypt.Net.BCrypt.Verify(String text, String hash, Boolean enhancedEntropy, HashType hashType)
   at ExamSystem.Services.Services.AuthService.LoginAsync(String username, String password) in E:\Project\exam_trae\ExamSystem.Services\Services\AuthService.cs:line 140
2025-10-26 23:02:01.064 +08:00 [ERR] 异常类型: SaltParseException
2025-10-26 23:02:01.064 +08:00 [ERR] 异常消息: Invalid salt version
2025-10-26 23:02:01.064 +08:00 [ERR] 用户名: admin
2025-10-26 23:02:01.064 +08:00 [ERR] 密码哈希: admin123
2025-10-26 23:02:01.064 +08:00 [WRN] 检测到密码哈希格式问题，尝试重新生成密码哈希
2025-10-26 23:02:01.299 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:02:01.299 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:02:01.300 +08:00 [DBG] The unchanged property 'User.PasswordHash' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:02:01.300 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:02:01.300 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:02:01.301 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.301 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.301 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:02:01.301 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.301 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.301 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 60)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "PasswordHash" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:02:01.301 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 60)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "PasswordHash" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:02:01.304 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.304 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 2ms reading results.
2025-10-26 23:02:01.304 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.304 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:02:01.304 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:02:01.304 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:02:01.304 +08:00 [INF] 已为用户 admin 重新生成密码哈希
2025-10-26 23:02:01.515 +08:00 [INF] 使用新哈希验证结果: True
2025-10-26 23:02:01.515 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 23:02:01.515 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:02:01.515 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:02:01.515 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:02:01.515 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:02:01.515 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:02:01.515 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.515 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.515 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:02:01.516 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.516 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:02:01.516 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:02:01.516 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:02:01.517 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.517 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:02:01.517 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:01.517 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:02:01.518 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:02:01.518 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:02:01.518 +08:00 [INF] 用户信息更新完成
2025-10-26 23:02:01.518 +08:00 [INF] 用户登录成功 - admin
2025-10-26 23:02:01.518 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 23:02:01.518 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 23:02:01.518 +08:00 [INF] 成功: True
2025-10-26 23:02:01.518 +08:00 [INF] 消息: 登录成功
2025-10-26 23:02:01.518 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:02:01.518 +08:00 [INF] 用户 admin 登录成功
2025-10-26 23:02:01.518 +08:00 [INF] 上次登录时间: 无记录
2025-10-26 23:02:01.518 +08:00 [INF] 触发登录成功事件
2025-10-26 23:02:01.519 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 23:02:01.519 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-26 23:02:01.519 +08:00 [INF] 用户ID: 1
2025-10-26 23:02:01.519 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:02:01.534 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 23:02:01.534 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 23:02:01.537 +08:00 [ERR] 加载页面时发生错误
System.Windows.Markup.XamlParseException: “在“System.Windows.Markup.StaticResourceHolder”上提供值时引发了异常。”，行号为“63”，行位置为“28”。
 ---> System.Exception: 无法找到名为“Card”的资源。资源名称区分大小写。
   at System.Windows.StaticResourceExtension.ProvideValueInternal(IServiceProvider serviceProvider, Boolean allowDeferredReference)
   at MS.Internal.Xaml.Runtime.ClrObjectRuntime.CallProvideValue(MarkupExtension me, IServiceProvider serviceProvider)
   --- End of inner exception stack trace ---
   at System.Windows.Markup.XamlReader.RewrapException(Exception e, IXamlLineInfo lineInfo, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri)
   at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)
   at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)
   at ExamSystem.WPF.Views.DashboardView.InitializeComponent() in E:\Project\exam_trae\ExamSystem.WPF\Views\DashboardView.xaml:line 1
   at ExamSystem.WPF.Views.DashboardView..ctor(DashboardViewModel viewModel) in E:\Project\exam_trae\ExamSystem.WPF\Views\DashboardView.xaml.cs:line 15
   at ExamSystem.WPF.App.<>c.<CreateHostBuilder>b__8_2(IServiceProvider provider) in E:\Project\exam_trae\ExamSystem.WPF\App.xaml.cs:line 143
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at ExamSystem.WPF.Views.MainWindow.LoadPages() in E:\Project\exam_trae\ExamSystem.WPF\Views\MainWindow.xaml.cs:line 145
2025-10-26 23:02:03.677 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 23:02:03.677 +08:00 [INF] 当前用户: admin (Admin)
2025-10-26 23:02:03.677 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 23:02:03.677 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 23:02:03.677 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 23:02:03.677 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 23:02:03.677 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 23:02:03.677 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 23:02:03.677 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 23:02:03.677 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 23:02:03.677 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 23:02:03.677 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 23:02:03.677 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 23:02:03.677 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 23:02:03.677 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 23:02:03.677 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 23:02:03.677 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 23:02:03.695 +08:00 [INF] 关闭登录窗口
2025-10-26 23:02:03.698 +08:00 [INF] === 登录流程结束 ===
2025-10-26 23:02:04.918 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 23:02:05.968 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 23:02:05.969 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:02:05.969 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.537 +08:00 [DBG] Hosting starting
2025-10-26 23:09:15.557 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-26 23:09:15.558 +08:00 [INF] Hosting environment: Production
2025-10-26 23:09:15.559 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-26 23:09:15.559 +08:00 [DBG] Hosting started
2025-10-26 23:09:15.591 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-26 23:09:15.603 +08:00 [INF] SQLite 数据库路径: E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db
2025-10-26 23:09:15.727 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:09:15.744 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:09:15.793 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:09:15.793 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:09:15.806 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-26 23:09:15.925 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:09:15.928 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:15.932 +08:00 [DBG] Created DbConnection. (2ms).
2025-10-26 23:09:15.934 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.935 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:15.936 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:15.936 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.940 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.941 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.943 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.947 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:09:15.949 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-10-26 23:09:15.949 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-10-26 23:09:15.950 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.953 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.956 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.964 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.965 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.966 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.967 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:15.967 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:15.967 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.967 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.967 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.967 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.967 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:09:15.967 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:09:15.967 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:09:15.967 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.967 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.967 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.967 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.967 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.967 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.973 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.973 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.973 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:15.973 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:15.973 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:15.973 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:09:15.974 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:09:15.975 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.976 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:09:15.976 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.976 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.981 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 23:09:15.982 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.982 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:15.982 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:15.982 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.983 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:09:15.983 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:09:15.983 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:09:15.983 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.983 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.983 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.983 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:15.983 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:15.983 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.983 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.983 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:09:15.983 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:09:15.984 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:09:15.984 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.984 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.984 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.984 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:09:15.984 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.984 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.984 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.984 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.984 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:15.984 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:15.984 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:15.984 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:09:15.984 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:09:15.984 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.984 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:15.984 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:15.984 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:15.984 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 23:09:15.999 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-26 23:09:16.051 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:09:16.059 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.059 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.059 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:16.059 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:16.059 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:16.059 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:09:16.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:09:16.060 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.060 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:16.060 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.060 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:16.060 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-26 23:09:16.061 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:09:16.061 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.061 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.062 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:16.062 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:16.062 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:16.062 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:09:16.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:09:16.062 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.062 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:16.062 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.062 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:16.062 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-26 23:09:16.063 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:09:16.063 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.063 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.063 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:16.063 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:16.063 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:16.063 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:09:16.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:09:16.063 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.063 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:16.063 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.063 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:16.064 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 23:09:16.064 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:16.064 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:16.068 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:09:31.822 +08:00 [INF] === 开始登录流程 ===
2025-10-26 23:09:31.822 +08:00 [INF] 用户名: admin
2025-10-26 23:09:31.822 +08:00 [INF] 密码长度: 8
2025-10-26 23:09:31.822 +08:00 [INF] AuthService是否为null: False
2025-10-26 23:09:31.822 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 23:09:31.824 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 23:09:31.824 +08:00 [INF] 接收到的用户名: admin
2025-10-26 23:09:31.824 +08:00 [INF] 接收到的密码长度: 8
2025-10-26 23:09:31.824 +08:00 [INF] 开始查询用户
2025-10-26 23:09:31.824 +08:00 [INF] UserRepository是否为null: False
2025-10-26 23:09:31.824 +08:00 [INF] Context是否为null: False
2025-10-26 23:09:31.824 +08:00 [INF] 测试数据库连接...
2025-10-26 23:09:31.826 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:31.826 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:31.826 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.826 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.826 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.826 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:31.826 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 23:09:31.827 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-26 23:09:31.835 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:09:31.837 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:31.837 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:31.837 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.837 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.837 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:31.838 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:31.838 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:31.838 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:09:31.838 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:09:31.838 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.838 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:31.838 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.838 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:31.838 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 23:09:31.839 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-26 23:09:31.852 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:09:31.855 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.855 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.855 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:31.855 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:31.855 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:31.856 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:09:31.857 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:09:31.867 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:31.880 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.881 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 23ms reading results.
2025-10-26 23:09:31.881 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:31.881 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:31.881 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 23:09:31.882 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-26 23:09:31.882 +08:00 [INF] 用户是否激活: True
2025-10-26 23:09:31.882 +08:00 [INF] 登录失败次数: 0
2025-10-26 23:09:31.882 +08:00 [INF] 检查账户锁定状态
2025-10-26 23:09:31.883 +08:00 [INF] 开始验证密码
2025-10-26 23:09:31.883 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 23:09:31.883 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 23:09:31.883 +08:00 [INF] 密码哈希前20字符: $2a$12$CksfgNpdNp2FY...
2025-10-26 23:09:31.883 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-26 23:09:31.883 +08:00 [INF] 密码哈希长度: 60
2025-10-26 23:09:31.883 +08:00 [INF] 密码哈希前缀: $2a$12$Cks
2025-10-26 23:09:32.101 +08:00 [INF] 密码验证结果: True
2025-10-26 23:09:32.101 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 23:09:32.103 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:09:32.103 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:09:32.112 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:09:32.114 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:32.117 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:09:32.134 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.134 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.135 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.135 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.135 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.135 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:09:32.136 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:09:32.140 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.140 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 4ms reading results.
2025-10-26 23:09:32.140 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.140 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.142 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:32.142 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:09:32.142 +08:00 [INF] 用户信息更新完成
2025-10-26 23:09:32.142 +08:00 [INF] 用户登录成功 - admin
2025-10-26 23:09:32.143 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 23:09:32.143 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 23:09:32.143 +08:00 [INF] 成功: True
2025-10-26 23:09:32.143 +08:00 [INF] 消息: 登录成功
2025-10-26 23:09:32.143 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:32.143 +08:00 [INF] 用户 admin 登录成功
2025-10-26 23:09:32.145 +08:00 [INF] 上次登录时间: 2025-10-26 23:07:42
2025-10-26 23:09:32.145 +08:00 [INF] 触发登录成功事件
2025-10-26 23:09:32.145 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 23:09:32.145 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-26 23:09:32.146 +08:00 [INF] 用户ID: 1
2025-10-26 23:09:32.146 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:32.160 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 23:09:32.160 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 23:09:32.167 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 23:09:32.172 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-26 23:09:32.174 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6] }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:32.174 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.174 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.174 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.174 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.174 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.175 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:32.175 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:32.181 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:32.183 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.183 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 8ms reading results.
2025-10-26 23:09:32.183 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.184 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.184 +08:00 [DBG] Compiling query expression: 
'DbSet<Question>()'
2025-10-26 23:09:32.185 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Question>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Question.QuestionId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Question.Analysis (string), 1], [Property: Question.Answer (string) Required, 2], [Property: Question.BankId (int) Required FK Index, 3], [Property: Question.Content (string) Required, 4], [Property: Question.CreatedAt (DateTime) Required, 5], [Property: Question.Difficulty (Difficulty) Required, 6], [Property: Question.IsActive (bool) Required, 7], [Property: Question.QuestionType (QuestionType) Required, 8], [Property: Question.Score (decimal) Required, 9], [Property: Question.Tags (string) MaxLength(200), 10], [Property: Question.Title (string) Required MaxLength(200), 11], [Property: Question.UpdatedAt (DateTime) Required, 12] }
        SELECT q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt
        FROM Questions AS q), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Question>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:32.186 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.186 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.186 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.186 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.186 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.186 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:32.186 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:32.186 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.186 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.186 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.186 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.186 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-26 23:09:32.188 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (DateTime?), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (DateTime?), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16] }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:32.188 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.188 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.188 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.188 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.188 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.188 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.188 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.188 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.188 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.188 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.188 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.189 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()'
2025-10-26 23:09:32.190 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (DateTime?), 3], [Property: ExamRecord.GradedAt (DateTime?), 4], [Property: ExamRecord.GraderId (int?) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (DateTime?), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (DateTime?), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16] }
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
        FROM ExamRecords AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:32.190 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.190 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.190 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.190 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.191 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.191 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:32.191 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:32.191 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.191 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.191 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.191 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.191 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-10-26 23:09:32.192 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
        SELECT u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Users AS u), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:32.193 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.193 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.193 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.193 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.193 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.193 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:09:32.193 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:09:32.194 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:32.194 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:32.194 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.194 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:09:32.194 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.194 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.194 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.194 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.194 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.194 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.194 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.194 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.194 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.194 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.194 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.194 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.194 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.195 +08:00 [DBG] Compiling query expression: 
'DbSet<Notification>()'
2025-10-26 23:09:32.196 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Notification>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Notification.NotificationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Notification.Content (string) Required, 1], [Property: Notification.CreatedAt (DateTime) Required, 2], [Property: Notification.Priority (NotificationPriority) Required, 3], [Property: Notification.Scope (NotificationScope) Required, 4], [Property: Notification.SenderId (int) Required FK Index, 5], [Property: Notification.Status (NotificationStatus) Required, 6], [Property: Notification.Title (string) Required MaxLength(200), 7] }
        SELECT n.NotificationId, n.Content, n.CreatedAt, n.Priority, n.Scope, n.SenderId, n.Status, n.Title
        FROM Notifications AS n), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Notification>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:32.196 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.196 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.196 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.196 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.196 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.196 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:09:32.196 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:09:32.196 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.196 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.196 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.196 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.201 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.201 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.201 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.201 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.201 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.201 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:32.202 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:32.202 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.202 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.202 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.202 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.211 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 23:09:32.212 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 23:09:32.212 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-26 23:09:32.212 +08:00 [INF] 用户ID: 1
2025-10-26 23:09:32.212 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:32.212 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-26 23:09:32.212 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 23:09:32.212 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 23:09:32.213 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.213 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.213 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.213 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.213 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.213 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.214 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.214 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.214 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.214 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.214 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.215 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 23:09:32.250 +08:00 [INF] 所有页面加载完成
2025-10-26 23:09:32.251 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 23:09:32.251 +08:00 [INF] 当前用户: admin (Admin)
2025-10-26 23:09:32.251 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 23:09:32.251 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 23:09:32.251 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 23:09:32.251 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 23:09:32.251 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 23:09:32.251 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 23:09:32.251 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 23:09:32.251 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 23:09:32.251 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 23:09:32.251 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 23:09:32.251 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 23:09:32.251 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 23:09:32.251 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 23:09:32.251 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 23:09:32.251 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 23:09:32.264 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:32.288 +08:00 [INF] 关闭登录窗口
2025-10-26 23:09:32.292 +08:00 [INF] === 登录流程结束 ===
2025-10-26 23:09:32.299 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.299 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.299 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.299 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.299 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.299 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:32.299 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:32.300 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.300 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.300 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:32.300 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:32.300 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.300 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.300 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.300 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.300 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.300 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.300 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:32.300 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:32.300 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.300 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.300 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.300 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.300 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:09:32.300 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:09:32.301 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.301 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.301 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.301 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.301 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.301 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.301 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:32.301 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.301 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.301 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:32.301 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.301 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:32.301 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:09:32.301 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:09:32.301 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:32.301 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:32.301 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:32.346 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:38.651 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:41.044 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:41.098 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 23:09:41.189 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:42.141 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:42.346 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:42.454 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:42.561 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:42.624 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.308 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.431 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.478 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.542 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.669 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.715 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.770 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.807 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.885 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:43.961 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.084 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.218 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.363 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.506 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.617 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.716 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.770 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:44.902 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:45.696 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:45.868 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:45.959 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:46.131 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:46.287 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:46.348 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:46.380 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:46.457 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:46.487 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:46.508 +08:00 [INF] === 开始登录流程 ===
2025-10-26 23:09:46.508 +08:00 [INF] 用户名: student
2025-10-26 23:09:46.508 +08:00 [INF] 密码长度: 10
2025-10-26 23:09:46.508 +08:00 [INF] AuthService是否为null: False
2025-10-26 23:09:46.508 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 23:09:46.508 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 23:09:46.508 +08:00 [INF] 接收到的用户名: student
2025-10-26 23:09:46.508 +08:00 [INF] 接收到的密码长度: 10
2025-10-26 23:09:46.508 +08:00 [INF] 开始查询用户
2025-10-26 23:09:46.508 +08:00 [INF] UserRepository是否为null: False
2025-10-26 23:09:46.508 +08:00 [INF] Context是否为null: False
2025-10-26 23:09:46.508 +08:00 [INF] 测试数据库连接...
2025-10-26 23:09:46.508 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:46.509 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:46.509 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.509 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.509 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.509 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.509 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 23:09:46.510 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.510 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.510 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.510 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.510 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.510 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:09:46.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:09:46.510 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.510 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.510 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.510 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.510 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 23:09:46.511 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.512 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.512 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.512 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.512 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.512 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:09:46.512 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:09:46.512 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.512 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.512 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.512 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.512 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 23:09:46.512 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-26 23:09:46.512 +08:00 [INF] 用户是否激活: True
2025-10-26 23:09:46.512 +08:00 [INF] 登录失败次数: 0
2025-10-26 23:09:46.512 +08:00 [INF] 检查账户锁定状态
2025-10-26 23:09:46.512 +08:00 [INF] 开始验证密码
2025-10-26 23:09:46.512 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 23:09:46.512 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 23:09:46.512 +08:00 [INF] 密码哈希前20字符: $2a$12$jO8/Xj/3Z0w8r...
2025-10-26 23:09:46.512 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-26 23:09:46.512 +08:00 [INF] 密码哈希长度: 60
2025-10-26 23:09:46.512 +08:00 [INF] 密码哈希前缀: $2a$12$jO8
2025-10-26 23:09:46.726 +08:00 [INF] 密码验证结果: True
2025-10-26 23:09:46.726 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 23:09:46.727 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:09:46.727 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:09:46.729 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:09:46.729 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:46.729 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:09:46.730 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.730 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.730 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.730 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.730 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.730 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:09:46.730 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:09:46.733 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.733 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 2ms reading results.
2025-10-26 23:09:46.733 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.733 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.733 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:46.733 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:09:46.733 +08:00 [INF] 用户信息更新完成
2025-10-26 23:09:46.733 +08:00 [INF] 用户登录成功 - student
2025-10-26 23:09:46.733 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 23:09:46.733 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 23:09:46.733 +08:00 [INF] 成功: True
2025-10-26 23:09:46.733 +08:00 [INF] 消息: 登录成功
2025-10-26 23:09:46.733 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:46.733 +08:00 [INF] 用户 student 登录成功
2025-10-26 23:09:46.733 +08:00 [INF] 上次登录时间: 无记录
2025-10-26 23:09:46.733 +08:00 [INF] 触发登录成功事件
2025-10-26 23:09:46.733 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 23:09:46.733 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-26 23:09:46.733 +08:00 [INF] 用户ID: 2
2025-10-26 23:09:46.733 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:46.735 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 23:09:46.735 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 23:09:46.735 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-26 23:09:46.737 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 23:09:46.740 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.UserId == __id_0)'
2025-10-26 23:09:46.743 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.UserId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:09:46.743 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.743 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.743 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.743 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.743 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.743 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:09:46.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:09:46.744 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.744 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.744 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.744 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.746 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Where(ep => ep.IsPublished || ep.Status == "已发布" && ep.StartTime <= __currentTime_0 && ep.EndTime >= __currentTime_0)
    .Select(ep => new StudentExamInfo{ 
        PaperId = ep.PaperId, 
        Title = ep.Name, 
        Subject = "通用", 
        Duration = ep.Duration, 
        TotalQuestions = ep.PaperQuestions != null ? ep.PaperQuestions.Count : 0, 
        StartTime = ep.StartTime ?? DateTime.Now, 
        EndTime = ep.EndTime ?? DateTime.Now.AddDays(30), 
        Description = ep.Description ?? "", 
        HasTaken = DbSet<ExamRecord>()
            .Any(er => er.UserId == __userId_1 && er.PaperId == ep.PaperId) 
    }
    )
    .OrderBy(e => e.StartTime)'
2025-10-26 23:09:46.773 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<StudentExamInfo>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 3], [Property: PaperQuestion.OrderIndex (int) Required, 4], [Property: PaperQuestion.PaperId (int) Required FK Index, 5], [Property: PaperQuestion.QuestionId (int) Required FK Index, 6], [Property: PaperQuestion.Score (decimal) Required, 7] }
            4 -> 3
            5 -> 8
            6 -> 9
            7 -> 10
            8 -> 11
            9 -> 12
        SELECT e.PaperId, e.Name, e.Duration, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, (
            SELECT COUNT(*)
            FROM PaperQuestions AS p0
            WHERE (e.PaperId != NULL) && (e.PaperId == p0.PaperId)), COALESCE(e.StartTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE(e.EndTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) + ' days'), '0'), '.')), COALESCE(e.Description, ''), EXISTS (
            SELECT 1
            FROM ExamRecords AS e0
            WHERE (e0.UserId == @__userId_1) && (e0.PaperId == e.PaperId))
        FROM ExamPapers AS e
        LEFT JOIN PaperQuestions AS p ON e.PaperId == p.PaperId
        WHERE ((e.IsPublished || (e.Status == '已发布')) && (e.StartTime <= @__currentTime_0)) && (e.EndTime >= @__currentTime_0)
        ORDER BY COALESCE(e.StartTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')) ASC, e.PaperId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, StudentExamInfo>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:46.776 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.776 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.776 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.776 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.776 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.776 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:09:46.776 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:09:46.777 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.777 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.777 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.777 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.780 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .AsNoTracking()
    .Include(er => er.ExamPaper)
    .ThenInclude(ep => ep.PaperQuestions)
    .Where(er => er.UserId == __userId_0 && (int)er.Status == 4 || (int)er.Status == 3 || (int)er.Status == 5)
    .OrderByDescending(er => er.StartTime)'
2025-10-26 23:09:46.783 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-26 23:09:46.783 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-26 23:09:46.792 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (DateTime?), 3], [Property: ExamRecord.GradedAt (DateTime?), 4], [Property: ExamRecord.GraderId (int?) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (DateTime?), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (DateTime?), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16] }
            1 -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: ExamPaper.AllowRetake (bool) Required, 18], [Property: ExamPaper.AllowViewAnswer (bool) Required, 19], [Property: ExamPaper.CreatedAt (DateTime) Required, 20], [Property: ExamPaper.CreatorId (int) Required FK Index, 21], [Property: ExamPaper.Description (string) MaxLength(500), 22], [Property: ExamPaper.Duration (int) Required, 23], [Property: ExamPaper.EndTime (DateTime?), 24], [Property: ExamPaper.IsActive (bool) Required, 25], [Property: ExamPaper.IsPublished (bool) Required, 26], [Property: ExamPaper.IsRandomOrder (bool) Required, 27], [Property: ExamPaper.Name (string) Required MaxLength(100), 28], [Property: ExamPaper.PassScore (decimal) Required, 29], [Property: ExamPaper.StartTime (DateTime?), 30], [Property: ExamPaper.Status (string) Required MaxLength(20), 31], [Property: ExamPaper.TotalScore (decimal) Required, 32], [Property: ExamPaper.UpdatedAt (DateTime) Required, 33] }
            2 -> 0
            3 -> 17
            4 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 34], [Property: PaperQuestion.OrderIndex (int) Required, 35], [Property: PaperQuestion.PaperId (int) Required FK Index, 36], [Property: PaperQuestion.QuestionId (int) Required FK Index, 37], [Property: PaperQuestion.Score (decimal) Required, 38] }
            5 -> 34
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score
        FROM ExamRecords AS e
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        LEFT JOIN PaperQuestions AS p ON e0.PaperId == p.PaperId
        WHERE (e.UserId == @__userId_0) && e.Status IN (4, 3, 5)
        ORDER BY e.StartTime DESC, e.RecordId ASC, e0.PaperId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:46.794 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.794 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.794 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.794 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.794 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.794 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:09:46.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:09:46.794 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.794 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.794 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.794 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.795 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.795 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.795 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.795 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.795 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.795 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:46.795 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:46.795 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.795 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.795 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.795 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.796 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.796 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.796 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.796 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.796 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.796 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:46.796 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:46.796 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:46.796 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.796 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.796 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.796 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.799 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 23:09:46.799 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 23:09:46.799 +08:00 [INF] 接收到的用户: student (Student)
2025-10-26 23:09:46.799 +08:00 [INF] 用户ID: 2
2025-10-26 23:09:46.799 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:46.799 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-26 23:09:46.799 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 23:09:46.799 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 23:09:46.799 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.799 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.799 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.799 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.799 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.799 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:46.800 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:46.800 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.800 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.800 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.800 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.800 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 23:09:46.802 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-26 23:09:46.803 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-26 23:09:46.804 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-26 23:09:46.804 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.Creator)
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .Where(p => p.IsPublished)
    .OrderByDescending(p => p.CreatedAt)'
2025-10-26 23:09:46.805 +08:00 [DBG] Including navigation: 'ExamPaper.Creator'.
2025-10-26 23:09:46.805 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-26 23:09:46.805 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-26 23:09:46.814 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (DateTime?), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (DateTime?), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16] }
            1 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: User.CreatedAt (DateTime) Required, 18], [Property: User.Email (string) Index MaxLength(200), 19], [Property: User.IsActive (bool) Required, 20], [Property: User.LastLoginAt (DateTime?), 21], [Property: User.LockoutEnd (DateTime?), 22], [Property: User.LoginFailCount (int) Required, 23], [Property: User.PasswordHash (string) Required MaxLength(255), 24], [Property: User.Phone (string) MaxLength(20), 25], [Property: User.RealName (string) MaxLength(100), 26], [Property: User.Role (UserRole) Required, 27], [Property: User.Username (string) Required Index MaxLength(50), 28] }
            2 -> 0
            3 -> 17
            4 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 29], [Property: PaperQuestion.OrderIndex (int) Required, 30], [Property: PaperQuestion.PaperId (int) Required FK Index, 31], [Property: PaperQuestion.QuestionId (int) Required FK Index, 32], [Property: PaperQuestion.Score (decimal) Required, 33] }
            5 -> Dictionary<IProperty, int> { [Property: Question.QuestionId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 34], [Property: Question.Analysis (string), 35], [Property: Question.Answer (string) Required, 36], [Property: Question.BankId (int) Required FK Index, 37], [Property: Question.Content (string) Required, 38], [Property: Question.CreatedAt (DateTime) Required, 39], [Property: Question.Difficulty (Difficulty) Required, 40], [Property: Question.IsActive (bool) Required, 41], [Property: Question.QuestionType (QuestionType) Required, 42], [Property: Question.Score (decimal) Required, 43], [Property: Question.Tags (string) MaxLength(200), 44], [Property: Question.Title (string) Required MaxLength(200), 45], [Property: Question.UpdatedAt (DateTime) Required, 46] }
            6 -> 29
            7 -> 34
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, t.Id, t.OrderIndex, t.PaperId, t.QuestionId, t.Score, t.QuestionId0, t.Analysis, t.Answer, t.BankId, t.Content, t.CreatedAt, t.Difficulty, t.IsActive, t.QuestionType, t.Score0, t.Tags, t.Title, t.UpdatedAt
        FROM ExamPapers AS e
        INNER JOIN Users AS u ON e.CreatorId == u.UserId
        LEFT JOIN 
        (
            SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
            FROM PaperQuestions AS p
            INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
        ) AS t ON e.PaperId == t.PaperId
        WHERE e.IsPublished
        ORDER BY e.CreatedAt DESC, e.PaperId ASC, u.UserId ASC, t.Id ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:46.814 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.814 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.814 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.814 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.814 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.814 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 23:09:46.815 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 23:09:46.815 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.815 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.815 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.815 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.815 +08:00 [INF] 成功获取 0 个已发布的试卷
2025-10-26 23:09:46.815 +08:00 [INF] 成功加载 0 个可参加的考试
2025-10-26 23:09:46.819 +08:00 [INF] 开始加载学生考试结果
2025-10-26 23:09:46.820 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.820 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.820 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.820 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.820 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.820 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:09:46.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:09:46.820 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.820 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.820 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.820 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.821 +08:00 [INF] 成功加载 0 条考试结果
2025-10-26 23:09:46.826 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .Count()'
2025-10-26 23:09:46.828 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM NotificationRecipients AS n
            WHERE n.ReceiverId == @__receiverId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:09:46.828 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.828 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.828 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.828 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.828 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.828 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 23:09:46.828 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 23:09:46.828 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.828 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.828 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.828 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.829 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .OrderByDescending(r => r.Notification.CreatedAt)
    .Skip(__p_1)
    .Take(__p_2)'
2025-10-26 23:09:46.830 +08:00 [DBG] Including navigation: 'NotificationRecipient.Notification'.
2025-10-26 23:09:46.830 +08:00 [DBG] Including navigation: 'Notification.Sender'.
2025-10-26 23:09:46.836 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<NotificationRecipient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: NotificationRecipient.NotificationRecipientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: NotificationRecipient.CreatedAt (DateTime) Required, 1], [Property: NotificationRecipient.DeliveryStatus (DeliveryStatus) Required, 2], [Property: NotificationRecipient.NotificationId (int) Required FK Index, 3], [Property: NotificationRecipient.ReadAt (DateTime?), 4], [Property: NotificationRecipient.ReceiverId (int) Required FK Index, 5] }
            1 -> Dictionary<IProperty, int> { [Property: Notification.NotificationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Notification.Content (string) Required, 7], [Property: Notification.CreatedAt (DateTime) Required, 8], [Property: Notification.Priority (NotificationPriority) Required, 9], [Property: Notification.Scope (NotificationScope) Required, 10], [Property: Notification.SenderId (int) Required FK Index, 11], [Property: Notification.Status (NotificationStatus) Required, 12], [Property: Notification.Title (string) Required MaxLength(200), 13] }
            2 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: User.CreatedAt (DateTime) Required, 15], [Property: User.Email (string) Index MaxLength(200), 16], [Property: User.IsActive (bool) Required, 17], [Property: User.LastLoginAt (DateTime?), 18], [Property: User.LockoutEnd (DateTime?), 19], [Property: User.LoginFailCount (int) Required, 20], [Property: User.PasswordHash (string) Required MaxLength(255), 21], [Property: User.Phone (string) MaxLength(20), 22], [Property: User.RealName (string) MaxLength(100), 23], [Property: User.Role (UserRole) Required, 24], [Property: User.Username (string) Required Index MaxLength(50), 25] }
        SELECT t.NotificationRecipientId, t.CreatedAt, t.DeliveryStatus, t.NotificationId, t.ReadAt, t.ReceiverId, t.NotificationId0, t.Content, t.CreatedAt0, t.Priority, t.Scope, t.SenderId, t.Status, t.Title, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM 
        (
            SELECT n.NotificationRecipientId, n.CreatedAt, n.DeliveryStatus, n.NotificationId, n.ReadAt, n.ReceiverId, n0.NotificationId AS NotificationId0, n0.Content, n0.CreatedAt AS CreatedAt0, n0.Priority, n0.Scope, n0.SenderId, n0.Status, n0.Title
            FROM NotificationRecipients AS n
            INNER JOIN Notifications AS n0 ON n.NotificationId == n0.NotificationId
            WHERE n.ReceiverId == @__receiverId_0
            ORDER BY n0.CreatedAt DESC
            OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
        ) AS t
        INNER JOIN Users AS u ON t.SenderId == u.UserId
        ORDER BY t.CreatedAt0 DESC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, NotificationRecipient>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:09:46.837 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.837 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.837 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.837 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.837 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.837 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 23:09:46.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 23:09:46.837 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.837 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.837 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.837 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.846 +08:00 [INF] 所有页面加载完成
2025-10-26 23:09:46.846 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 23:09:46.846 +08:00 [INF] 当前用户: student (Student)
2025-10-26 23:09:46.846 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 23:09:46.846 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 23:09:46.846 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 23:09:46.846 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 23:09:46.846 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 23:09:46.846 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 23:09:46.846 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 23:09:46.846 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 23:09:46.846 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 23:09:46.846 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 23:09:46.846 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 23:09:46.846 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 23:09:46.846 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 23:09:46.846 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 23:09:46.847 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 23:09:46.873 +08:00 [INF] 关闭登录窗口
2025-10-26 23:09:46.876 +08:00 [INF] === 登录流程结束 ===
2025-10-26 23:09:46.893 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.893 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.893 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.893 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.893 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.893 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:09:46.894 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:09:46.894 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:46.894 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.894 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.894 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.894 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.895 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.895 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.895 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.895 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.895 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.895 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:09:46.895 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:09:46.895 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.895 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.895 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.895 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.896 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.896 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.896 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.896 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:09:46.896 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:09:46.896 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.896 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.896 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:46.896 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.896 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:46.896 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:46.896 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:46.896 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:46.896 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:46.896 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:46.913 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:50.860 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:50.923 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 23:09:51.004 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:51.982 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.044 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.127 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.268 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.293 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.340 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.461 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.788 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.914 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:52.976 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.069 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.143 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.219 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.280 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.389 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.514 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.653 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.808 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.855 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.900 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:53.932 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.074 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.182 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.339 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.462 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.539 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.612 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.644 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.755 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.877 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.955 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:54.987 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:55.077 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:55.109 +08:00 [INF] === 开始登录流程 ===
2025-10-26 23:09:55.109 +08:00 [INF] 用户名: teacher
2025-10-26 23:09:55.109 +08:00 [INF] 密码长度: 10
2025-10-26 23:09:55.109 +08:00 [INF] AuthService是否为null: False
2025-10-26 23:09:55.109 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 23:09:55.109 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 23:09:55.109 +08:00 [INF] 接收到的用户名: teacher
2025-10-26 23:09:55.109 +08:00 [INF] 接收到的密码长度: 10
2025-10-26 23:09:55.109 +08:00 [INF] 开始查询用户
2025-10-26 23:09:55.109 +08:00 [INF] UserRepository是否为null: False
2025-10-26 23:09:55.109 +08:00 [INF] Context是否为null: False
2025-10-26 23:09:55.109 +08:00 [INF] 测试数据库连接...
2025-10-26 23:09:55.109 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:09:55.109 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:09:55.110 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.110 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.110 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.110 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.110 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 23:09:55.110 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.110 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.110 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.110 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.110 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.110 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:09:55.110 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:09:55.111 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.111 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.111 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.111 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.111 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 23:09:55.111 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.111 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.111 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.111 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.111 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.111 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:09:55.111 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:09:55.111 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:55.111 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.111 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.111 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.111 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.111 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 23:09:55.111 +08:00 [INF] 用户ID: 3, 用户名: teacher, 角色: Teacher
2025-10-26 23:09:55.111 +08:00 [INF] 用户是否激活: True
2025-10-26 23:09:55.111 +08:00 [INF] 登录失败次数: 0
2025-10-26 23:09:55.111 +08:00 [INF] 检查账户锁定状态
2025-10-26 23:09:55.111 +08:00 [INF] 开始验证密码
2025-10-26 23:09:55.111 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 23:09:55.111 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 23:09:55.111 +08:00 [INF] 密码哈希前20字符: $2a$12$TV26S1Af2e9Sw...
2025-10-26 23:09:55.111 +08:00 [INF] 开始验证密码 - 用户: teacher
2025-10-26 23:09:55.111 +08:00 [INF] 密码哈希长度: 60
2025-10-26 23:09:55.111 +08:00 [INF] 密码哈希前缀: $2a$12$TV2
2025-10-26 23:09:55.273 +08:00 [INF] 密码验证结果: True
2025-10-26 23:09:55.273 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 23:09:55.273 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:09:55.273 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:09:55.273 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:09:55.273 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:55.273 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:09:55.274 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.274 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.274 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.274 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.274 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.274 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:09:55.274 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:09:55.276 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.276 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:09:55.276 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.276 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.276 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:55.276 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:09:55.276 +08:00 [INF] 用户信息更新完成
2025-10-26 23:09:55.276 +08:00 [INF] 用户登录成功 - teacher
2025-10-26 23:09:55.276 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 23:09:55.276 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 23:09:55.276 +08:00 [INF] 成功: True
2025-10-26 23:09:55.276 +08:00 [INF] 消息: 登录成功
2025-10-26 23:09:55.276 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:55.276 +08:00 [INF] 用户 teacher 登录成功
2025-10-26 23:09:55.276 +08:00 [INF] 上次登录时间: 无记录
2025-10-26 23:09:55.276 +08:00 [INF] 触发登录成功事件
2025-10-26 23:09:55.276 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 23:09:55.276 +08:00 [INF] 登录成功的用户: teacher (Teacher)
2025-10-26 23:09:55.276 +08:00 [INF] 用户ID: 3
2025-10-26 23:09:55.276 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:55.278 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 23:09:55.278 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 23:09:55.280 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 23:09:55.282 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.282 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.282 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.282 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:55.282 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:55.282 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:55.282 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.282 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.282 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.282 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.282 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.282 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:55.282 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:55.282 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.282 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.282 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.283 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.283 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.283 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.283 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:55.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:55.283 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.283 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.283 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.283 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.283 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.283 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:55.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:55.283 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.283 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.283 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.285 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.285 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.285 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.285 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.285 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.286 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:55.286 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:55.286 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.286 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.286 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.286 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.287 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 23:09:55.287 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 23:09:55.287 +08:00 [INF] 接收到的用户: teacher (Teacher)
2025-10-26 23:09:55.287 +08:00 [INF] 用户ID: 3
2025-10-26 23:09:55.287 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:09:55.287 +08:00 [INF] 设置后的CurrentUser: teacher (Teacher)
2025-10-26 23:09:55.287 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 23:09:55.287 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 23:09:55.288 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.288 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.288 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.288 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.288 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.288 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:55.288 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:55.288 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.288 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.288 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.288 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.288 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 23:09:55.298 +08:00 [INF] 所有页面加载完成
2025-10-26 23:09:55.298 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 23:09:55.298 +08:00 [INF] 当前用户: teacher (Teacher)
2025-10-26 23:09:55.298 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 23:09:55.298 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 23:09:55.298 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 23:09:55.298 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 23:09:55.298 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 23:09:55.298 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 23:09:55.298 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 23:09:55.298 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 23:09:55.298 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 23:09:55.298 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 23:09:55.298 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 23:09:55.298 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 23:09:55.298 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 23:09:55.298 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 23:09:55.298 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 23:09:55.304 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:09:55.335 +08:00 [INF] 关闭登录窗口
2025-10-26 23:09:55.337 +08:00 [INF] === 登录流程结束 ===
2025-10-26 23:09:55.344 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.344 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:55.344 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:09:55.344 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.344 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.344 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:55.344 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:09:55.344 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.344 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.344 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.344 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.344 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:55.345 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:09:55.345 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.345 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.345 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.345 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.345 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.345 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.345 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:55.345 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.345 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:55.345 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:55.345 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:09:55.345 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.345 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:09:55.345 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:55.345 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:55.364 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:55.364 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:09:57.253 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:57.253 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:09:57.356 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:57.356 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:09:58.643 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:58.643 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:09:59.275 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:59.275 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:09:59.353 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:59.354 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:59.354 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:09:59.354 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:59.354 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:09:59.354 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:09:59.354 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:09:59.354 +08:00 [DBG] The navigation 'QuestionBank.Creator' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:59.355 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:59.355 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:09:59.355 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:59.355 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:09:59.355 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:09:59.355 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:09:59.425 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:09:59.425 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:03.234 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:10:03.234 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:10:03.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:10:03.234 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:10:03.234 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:10:03.234 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:10:03.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:10:03.234 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:10:03.234 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:10:03.234 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:10:03.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:10:03.234 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:10:03.234 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:10:03.234 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:10:03.234 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:10:03.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:10:03.234 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:10:03.234 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:03.234 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:10:03.239 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:10:03.239 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:03.302 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:10:03.303 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:09.082 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:10:09.082 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:11.165 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:10:11.165 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:11.968 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:10:11.968 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:12.002 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 23:10:12.066 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:10:12.066 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:13.256 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:10:13.256 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:10:13.337 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 23:10:13.338 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:10:13.339 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:04.875 +08:00 [DBG] Hosting starting
2025-10-26 23:17:04.894 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-26 23:17:04.896 +08:00 [INF] Hosting environment: Production
2025-10-26 23:17:04.896 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-26 23:17:04.896 +08:00 [DBG] Hosting started
2025-10-26 23:17:04.930 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-26 23:17:04.942 +08:00 [INF] SQLite 数据库路径: E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db
2025-10-26 23:17:05.077 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:17:05.095 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:17:05.147 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:17:05.147 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:17:05.162 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-26 23:17:05.278 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:17:05.281 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:17:05.285 +08:00 [DBG] Created DbConnection. (2ms).
2025-10-26 23:17:05.287 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.288 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:17:05.289 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:17:05.289 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.293 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.295 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.296 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.301 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:17:05.303 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-10-26 23:17:05.304 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (4ms).
2025-10-26 23:17:05.305 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.308 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.311 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.321 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.322 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.323 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.324 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:17:05.324 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:17:05.324 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.324 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.324 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.324 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.325 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:17:05.325 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:17:05.325 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:17:05.325 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.325 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.325 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.325 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.325 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.325 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.330 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.330 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.330 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:17:05.330 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.330 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.330 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:17:05.331 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:17:05.333 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.333 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:17:05.333 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.333 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.339 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 23:17:05.340 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:17:05.341 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:17:05.341 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.341 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:17:05.341 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:17:05.341 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:17:05.341 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.341 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.341 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.341 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:17:05.341 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:17:05.341 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.341 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.342 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:17:05.342 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:17:05.342 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:17:05.342 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.342 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.342 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:17:05.342 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.342 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.342 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.342 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.342 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:17:05.342 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.342 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.342 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:17:05.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:17:05.342 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.342 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:17:05.342 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.342 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.342 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 23:17:05.358 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-26 23:17:05.410 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:17:05.418 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.418 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.418 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:17:05.418 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.418 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.418 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:17:05.419 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:17:05.419 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.419 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:17:05.419 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.419 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.419 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-26 23:17:05.421 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:17:05.421 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.421 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.421 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:17:05.421 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.421 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.421 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:17:05.421 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:17:05.421 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.421 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:17:05.421 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.421 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.422 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-26 23:17:05.422 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:17:05.423 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.423 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.423 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:17:05.423 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.423 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:17:05.423 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:17:05.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:17:05.423 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.423 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:17:05.423 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.423 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.424 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 23:17:05.424 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:17:05.424 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:17:05.429 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:18:17.897 +08:00 [INF] === 开始登录流程 ===
2025-10-26 23:18:17.897 +08:00 [INF] 用户名: student
2025-10-26 23:18:17.897 +08:00 [INF] 密码长度: 10
2025-10-26 23:18:17.897 +08:00 [INF] AuthService是否为null: False
2025-10-26 23:18:17.897 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 23:18:17.899 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 23:18:17.899 +08:00 [INF] 接收到的用户名: student
2025-10-26 23:18:17.899 +08:00 [INF] 接收到的密码长度: 10
2025-10-26 23:18:17.899 +08:00 [INF] 开始查询用户
2025-10-26 23:18:17.899 +08:00 [INF] UserRepository是否为null: False
2025-10-26 23:18:17.899 +08:00 [INF] Context是否为null: False
2025-10-26 23:18:17.899 +08:00 [INF] 测试数据库连接...
2025-10-26 23:18:17.900 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:18:17.901 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:18:17.901 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.901 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.901 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.901 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:17.901 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 23:18:17.902 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-26 23:18:17.910 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:18:17.912 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:18:17.912 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:18:17.912 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.912 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.912 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:17.913 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:17.913 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:17.913 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:18:17.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:18:17.913 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.913 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:17.913 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.913 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:17.913 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 23:18:17.914 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-26 23:18:17.927 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:18:17.929 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.929 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.929 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:17.929 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:17.930 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:17.930 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:18:17.932 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:18:17.941 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:17.954 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.954 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 22ms reading results.
2025-10-26 23:18:17.954 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:17.954 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:17.954 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 23:18:17.955 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-26 23:18:17.955 +08:00 [INF] 用户是否激活: True
2025-10-26 23:18:17.955 +08:00 [INF] 登录失败次数: 0
2025-10-26 23:18:17.955 +08:00 [INF] 检查账户锁定状态
2025-10-26 23:18:17.959 +08:00 [INF] 开始验证密码
2025-10-26 23:18:17.959 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 23:18:17.959 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 23:18:17.959 +08:00 [INF] 密码哈希前20字符: $2a$12$jO8/Xj/3Z0w8r...
2025-10-26 23:18:17.959 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-26 23:18:17.959 +08:00 [INF] 密码哈希长度: 60
2025-10-26 23:18:17.959 +08:00 [INF] 密码哈希前缀: $2a$12$jO8
2025-10-26 23:18:18.182 +08:00 [INF] 密码验证结果: True
2025-10-26 23:18:18.182 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 23:18:18.183 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:18:18.184 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:18:18.190 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:18:18.193 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:18.196 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:18:18.213 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.213 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.213 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.213 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.214 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.214 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:18:18.214 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:18:18.220 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.221 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 6ms reading results.
2025-10-26 23:18:18.221 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.221 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.223 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:18.223 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:18:18.223 +08:00 [INF] 用户信息更新完成
2025-10-26 23:18:18.223 +08:00 [INF] 用户登录成功 - student
2025-10-26 23:18:18.223 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 23:18:18.224 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 23:18:18.224 +08:00 [INF] 成功: True
2025-10-26 23:18:18.224 +08:00 [INF] 消息: 登录成功
2025-10-26 23:18:18.224 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:18:18.224 +08:00 [INF] 用户 student 登录成功
2025-10-26 23:18:18.225 +08:00 [INF] 上次登录时间: 2025-10-26 23:09:46
2025-10-26 23:18:18.225 +08:00 [INF] 触发登录成功事件
2025-10-26 23:18:18.226 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 23:18:18.226 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-26 23:18:18.226 +08:00 [INF] 用户ID: 2
2025-10-26 23:18:18.226 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:18:18.239 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 23:18:18.239 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 23:18:18.240 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-26 23:18:18.247 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 23:18:18.251 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.UserId == __id_0)'
2025-10-26 23:18:18.253 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.UserId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:18:18.254 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.254 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.254 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.254 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.254 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.254 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:18.254 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:18.254 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.254 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.254 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.254 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.258 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Where(ep => ep.IsPublished || ep.Status == "已发布" && ep.StartTime <= __currentTime_0 && ep.EndTime >= __currentTime_0)
    .Select(ep => new StudentExamInfo{ 
        PaperId = ep.PaperId, 
        Title = ep.Name, 
        Subject = "通用", 
        Duration = ep.Duration, 
        TotalQuestions = ep.PaperQuestions != null ? ep.PaperQuestions.Count : 0, 
        StartTime = ep.StartTime ?? DateTime.Now, 
        EndTime = ep.EndTime ?? DateTime.Now.AddDays(30), 
        Description = ep.Description ?? "", 
        HasTaken = DbSet<ExamRecord>()
            .Any(er => er.UserId == __userId_1 && er.PaperId == ep.PaperId) 
    }
    )
    .OrderBy(e => e.StartTime)'
2025-10-26 23:18:18.283 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<StudentExamInfo>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 3], [Property: PaperQuestion.OrderIndex (int) Required, 4], [Property: PaperQuestion.PaperId (int) Required FK Index, 5], [Property: PaperQuestion.QuestionId (int) Required FK Index, 6], [Property: PaperQuestion.Score (decimal) Required, 7] }
            4 -> 3
            5 -> 8
            6 -> 9
            7 -> 10
            8 -> 11
            9 -> 12
        SELECT e.PaperId, e.Name, e.Duration, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, (
            SELECT COUNT(*)
            FROM PaperQuestions AS p0
            WHERE (e.PaperId != NULL) && (e.PaperId == p0.PaperId)), COALESCE(e.StartTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE(e.EndTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) + ' days'), '0'), '.')), COALESCE(e.Description, ''), EXISTS (
            SELECT 1
            FROM ExamRecords AS e0
            WHERE (e0.UserId == @__userId_1) && (e0.PaperId == e.PaperId))
        FROM ExamPapers AS e
        LEFT JOIN PaperQuestions AS p ON e.PaperId == p.PaperId
        WHERE ((e.IsPublished || (e.Status == '已发布')) && (e.StartTime <= @__currentTime_0)) && (e.EndTime >= @__currentTime_0)
        ORDER BY COALESCE(e.StartTime, rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')) ASC, e.PaperId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, StudentExamInfo>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:18.285 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.285 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.285 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.285 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.285 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.285 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:18.285 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:18.285 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.285 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.285 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.285 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.289 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .AsNoTracking()
    .Include(er => er.ExamPaper)
    .ThenInclude(ep => ep.PaperQuestions)
    .Where(er => er.UserId == __userId_0 && (int)er.Status == 4 || (int)er.Status == 3 || (int)er.Status == 5)
    .OrderByDescending(er => er.StartTime)'
2025-10-26 23:18:18.291 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-26 23:18:18.291 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-26 23:18:18.300 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (DateTime?), 3], [Property: ExamRecord.GradedAt (DateTime?), 4], [Property: ExamRecord.GraderId (int?) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (DateTime?), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (DateTime?), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16] }
            1 -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: ExamPaper.AllowRetake (bool) Required, 18], [Property: ExamPaper.AllowViewAnswer (bool) Required, 19], [Property: ExamPaper.CreatedAt (DateTime) Required, 20], [Property: ExamPaper.CreatorId (int) Required FK Index, 21], [Property: ExamPaper.Description (string) MaxLength(500), 22], [Property: ExamPaper.Duration (int) Required, 23], [Property: ExamPaper.EndTime (DateTime?), 24], [Property: ExamPaper.IsActive (bool) Required, 25], [Property: ExamPaper.IsPublished (bool) Required, 26], [Property: ExamPaper.IsRandomOrder (bool) Required, 27], [Property: ExamPaper.Name (string) Required MaxLength(100), 28], [Property: ExamPaper.PassScore (decimal) Required, 29], [Property: ExamPaper.StartTime (DateTime?), 30], [Property: ExamPaper.Status (string) Required MaxLength(20), 31], [Property: ExamPaper.TotalScore (decimal) Required, 32], [Property: ExamPaper.UpdatedAt (DateTime) Required, 33] }
            2 -> 0
            3 -> 17
            4 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 34], [Property: PaperQuestion.OrderIndex (int) Required, 35], [Property: PaperQuestion.PaperId (int) Required FK Index, 36], [Property: PaperQuestion.QuestionId (int) Required FK Index, 37], [Property: PaperQuestion.Score (decimal) Required, 38] }
            5 -> 34
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score
        FROM ExamRecords AS e
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        LEFT JOIN PaperQuestions AS p ON e0.PaperId == p.PaperId
        WHERE (e.UserId == @__userId_0) && e.Status IN (4, 3, 5)
        ORDER BY e.StartTime DESC, e.RecordId ASC, e0.PaperId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:18.302 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.302 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.302 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.302 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.302 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.302 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:18.302 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:18.302 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.302 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.302 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.302 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.303 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()'
2025-10-26 23:18:18.305 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (DateTime?), 3], [Property: ExamRecord.GradedAt (DateTime?), 4], [Property: ExamRecord.GraderId (int?) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (DateTime?), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (DateTime?), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16] }
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
        FROM ExamRecords AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:18.305 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.305 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.305 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.305 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.305 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.305 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:18.305 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:18.305 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.305 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.305 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.305 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.310 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-26 23:18:18.311 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6] }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:18.311 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.311 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.311 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.311 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.311 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.311 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:18.311 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:18.313 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:18.317 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.317 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 5ms reading results.
2025-10-26 23:18:18.317 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.317 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.324 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 23:18:18.325 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 23:18:18.325 +08:00 [INF] 接收到的用户: student (Student)
2025-10-26 23:18:18.325 +08:00 [INF] 用户ID: 2
2025-10-26 23:18:18.325 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:18:18.325 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-26 23:18:18.325 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 23:18:18.325 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 23:18:18.326 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-26 23:18:18.328 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (DateTime?), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (DateTime?), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16] }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:18.328 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.328 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.328 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.328 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.328 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.328 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:18.328 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:18.328 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.328 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.328 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.328 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.329 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 23:18:18.346 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-26 23:18:18.347 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-26 23:18:18.347 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-26 23:18:18.348 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.Creator)
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .Where(p => p.IsPublished)
    .OrderByDescending(p => p.CreatedAt)'
2025-10-26 23:18:18.348 +08:00 [DBG] Including navigation: 'ExamPaper.Creator'.
2025-10-26 23:18:18.348 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-26 23:18:18.349 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-26 23:18:18.357 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (DateTime?), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (DateTime?), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16] }
            1 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: User.CreatedAt (DateTime) Required, 18], [Property: User.Email (string) Index MaxLength(200), 19], [Property: User.IsActive (bool) Required, 20], [Property: User.LastLoginAt (DateTime?), 21], [Property: User.LockoutEnd (DateTime?), 22], [Property: User.LoginFailCount (int) Required, 23], [Property: User.PasswordHash (string) Required MaxLength(255), 24], [Property: User.Phone (string) MaxLength(20), 25], [Property: User.RealName (string) MaxLength(100), 26], [Property: User.Role (UserRole) Required, 27], [Property: User.Username (string) Required Index MaxLength(50), 28] }
            2 -> 0
            3 -> 17
            4 -> Dictionary<IProperty, int> { [Property: PaperQuestion.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 29], [Property: PaperQuestion.OrderIndex (int) Required, 30], [Property: PaperQuestion.PaperId (int) Required FK Index, 31], [Property: PaperQuestion.QuestionId (int) Required FK Index, 32], [Property: PaperQuestion.Score (decimal) Required, 33] }
            5 -> Dictionary<IProperty, int> { [Property: Question.QuestionId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 34], [Property: Question.Analysis (string), 35], [Property: Question.Answer (string) Required, 36], [Property: Question.BankId (int) Required FK Index, 37], [Property: Question.Content (string) Required, 38], [Property: Question.CreatedAt (DateTime) Required, 39], [Property: Question.Difficulty (Difficulty) Required, 40], [Property: Question.IsActive (bool) Required, 41], [Property: Question.QuestionType (QuestionType) Required, 42], [Property: Question.Score (decimal) Required, 43], [Property: Question.Tags (string) MaxLength(200), 44], [Property: Question.Title (string) Required MaxLength(200), 45], [Property: Question.UpdatedAt (DateTime) Required, 46] }
            6 -> 29
            7 -> 34
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, t.Id, t.OrderIndex, t.PaperId, t.QuestionId, t.Score, t.QuestionId0, t.Analysis, t.Answer, t.BankId, t.Content, t.CreatedAt, t.Difficulty, t.IsActive, t.QuestionType, t.Score0, t.Tags, t.Title, t.UpdatedAt
        FROM ExamPapers AS e
        INNER JOIN Users AS u ON e.CreatorId == u.UserId
        LEFT JOIN 
        (
            SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
            FROM PaperQuestions AS p
            INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
        ) AS t ON e.PaperId == t.PaperId
        WHERE e.IsPublished
        ORDER BY e.CreatedAt DESC, e.PaperId ASC, u.UserId ASC, t.Id ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:18.357 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.357 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.357 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.357 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.357 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.357 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 23:18:18.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id"
2025-10-26 23:18:18.357 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.357 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.357 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.358 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.358 +08:00 [INF] 成功获取 0 个已发布的试卷
2025-10-26 23:18:18.358 +08:00 [INF] 成功加载 0 个可参加的考试
2025-10-26 23:18:18.362 +08:00 [INF] 开始加载学生考试结果
2025-10-26 23:18:18.363 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.363 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.363 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.363 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.363 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.363 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:18.363 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:18.363 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.364 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.364 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.364 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.364 +08:00 [INF] 成功加载 0 条考试结果
2025-10-26 23:18:18.371 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .Count()'
2025-10-26 23:18:18.372 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM NotificationRecipients AS n
            WHERE n.ReceiverId == @__receiverId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:18:18.372 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.372 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.372 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.372 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.372 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.372 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 23:18:18.372 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-26 23:18:18.372 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.372 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.372 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.372 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.373 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .OrderByDescending(r => r.Notification.CreatedAt)
    .Skip(__p_1)
    .Take(__p_2)'
2025-10-26 23:18:18.373 +08:00 [DBG] Including navigation: 'NotificationRecipient.Notification'.
2025-10-26 23:18:18.374 +08:00 [DBG] Including navigation: 'Notification.Sender'.
2025-10-26 23:18:18.379 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<NotificationRecipient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: NotificationRecipient.NotificationRecipientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: NotificationRecipient.CreatedAt (DateTime) Required, 1], [Property: NotificationRecipient.DeliveryStatus (DeliveryStatus) Required, 2], [Property: NotificationRecipient.NotificationId (int) Required FK Index, 3], [Property: NotificationRecipient.ReadAt (DateTime?), 4], [Property: NotificationRecipient.ReceiverId (int) Required FK Index, 5] }
            1 -> Dictionary<IProperty, int> { [Property: Notification.NotificationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Notification.Content (string) Required, 7], [Property: Notification.CreatedAt (DateTime) Required, 8], [Property: Notification.Priority (NotificationPriority) Required, 9], [Property: Notification.Scope (NotificationScope) Required, 10], [Property: Notification.SenderId (int) Required FK Index, 11], [Property: Notification.Status (NotificationStatus) Required, 12], [Property: Notification.Title (string) Required MaxLength(200), 13] }
            2 -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: User.CreatedAt (DateTime) Required, 15], [Property: User.Email (string) Index MaxLength(200), 16], [Property: User.IsActive (bool) Required, 17], [Property: User.LastLoginAt (DateTime?), 18], [Property: User.LockoutEnd (DateTime?), 19], [Property: User.LoginFailCount (int) Required, 20], [Property: User.PasswordHash (string) Required MaxLength(255), 21], [Property: User.Phone (string) MaxLength(20), 22], [Property: User.RealName (string) MaxLength(100), 23], [Property: User.Role (UserRole) Required, 24], [Property: User.Username (string) Required Index MaxLength(50), 25] }
        SELECT t.NotificationRecipientId, t.CreatedAt, t.DeliveryStatus, t.NotificationId, t.ReadAt, t.ReceiverId, t.NotificationId0, t.Content, t.CreatedAt0, t.Priority, t.Scope, t.SenderId, t.Status, t.Title, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM 
        (
            SELECT n.NotificationRecipientId, n.CreatedAt, n.DeliveryStatus, n.NotificationId, n.ReadAt, n.ReceiverId, n0.NotificationId AS NotificationId0, n0.Content, n0.CreatedAt AS CreatedAt0, n0.Priority, n0.Scope, n0.SenderId, n0.Status, n0.Title
            FROM NotificationRecipients AS n
            INNER JOIN Notifications AS n0 ON n.NotificationId == n0.NotificationId
            WHERE n.ReceiverId == @__receiverId_0
            ORDER BY n0.CreatedAt DESC
            OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
        ) AS t
        INNER JOIN Users AS u ON t.SenderId == u.UserId
        ORDER BY t.CreatedAt0 DESC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, NotificationRecipient>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:18.379 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.379 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.379 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.379 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.379 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.379 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 23:18:18.380 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__receiverId_0='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-26 23:18:18.380 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.380 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.380 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.380 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.393 +08:00 [INF] 所有页面加载完成
2025-10-26 23:18:18.393 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 23:18:18.393 +08:00 [INF] 当前用户: student (Student)
2025-10-26 23:18:18.394 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 23:18:18.394 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 23:18:18.394 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 23:18:18.394 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 23:18:18.394 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 23:18:18.394 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 23:18:18.394 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 23:18:18.394 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 23:18:18.394 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 23:18:18.394 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 23:18:18.394 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 23:18:18.394 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 23:18:18.394 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 23:18:18.394 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 23:18:18.394 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 23:18:18.421 +08:00 [INF] 关闭登录窗口
2025-10-26 23:18:18.424 +08:00 [INF] === 登录流程结束 ===
2025-10-26 23:18:18.441 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.441 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.441 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.441 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.441 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.441 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:18.441 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:18.442 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:18.442 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.442 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.442 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.442 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.443 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.443 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.443 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.443 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.443 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.443 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:18.443 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:18.444 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.444 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.444 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.444 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.444 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.444 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:18.444 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:18.444 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.444 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:18.444 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:18.444 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.444 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:18.444 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:18.444 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:18.444 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:18.444 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:18.444 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:23.173 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.173 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.173 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:23.173 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.173 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.173 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:23.173 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:23.173 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:23.174 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.174 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:23.174 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.174 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:23.175 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.175 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.175 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:23.175 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.175 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.175 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:23.175 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:23.175 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.175 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:23.175 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.175 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:23.176 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.176 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.176 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:23.176 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.176 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.176 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:23.176 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:23.176 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.176 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:23.176 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.176 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:23.176 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.176 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.176 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:23.176 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.177 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:23.177 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:23.177 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:23.177 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.177 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:23.177 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:23.177 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:35.827 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.827 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.827 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:35.827 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.827 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.827 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:35.827 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:35.827 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:35.827 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.828 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:35.828 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.828 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:35.828 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.828 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.828 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:35.828 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.828 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.828 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:35.828 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:35.828 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.828 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:35.828 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.828 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:35.829 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:35.829 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.829 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.829 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:35.829 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:35.829 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:35.829 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:35.829 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:35.829 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.829 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:35.829 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:35.829 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:35.829 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:35.829 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:35.829 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:37.558 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.558 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.558 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:37.558 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.558 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.558 +08:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:37.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__id_0
LIMIT 1
2025-10-26 23:18:37.559 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:37.559 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.559 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:37.559 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.559 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:37.559 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.559 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.559 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:37.559 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.559 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.559 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:37.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_1='?' (DbType = Int32), @__currentTime_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."Name", "e"."Duration", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", (
    SELECT COUNT(*)
    FROM "PaperQuestions" AS "p0"
    WHERE "e"."PaperId" = "p0"."PaperId"), COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), COALESCE("e"."EndTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime', CAST(30.0 AS TEXT) || ' days'), '0'), '.')), COALESCE("e"."Description", ''), EXISTS (
    SELECT 1
    FROM "ExamRecords" AS "e0"
    WHERE "e0"."UserId" = @__userId_1 AND "e0"."PaperId" = "e"."PaperId")
FROM "ExamPapers" AS "e"
LEFT JOIN "PaperQuestions" AS "p" ON "e"."PaperId" = "p"."PaperId"
WHERE ("e"."IsPublished" OR "e"."Status" = '已发布') AND "e"."StartTime" <= @__currentTime_0 AND "e"."EndTime" >= @__currentTime_0
ORDER BY COALESCE("e"."StartTime", rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now', 'localtime'), '0'), '.')), "e"."PaperId"
2025-10-26 23:18:37.559 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.559 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:37.560 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:37.560 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:37.560 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.560 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.560 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:37.560 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM "ExamRecords" AS "e"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "PaperQuestions" AS "p" ON "e0"."PaperId" = "p"."PaperId"
WHERE "e"."UserId" = @__userId_0 AND "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "e0"."PaperId"
2025-10-26 23:18:37.560 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:37.560 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:37.560 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:37.560 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.560 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:37.560 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:37.560 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:37.560 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:37.560 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:37.560 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:38.438 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 23:18:42.447 +08:00 [INF] === 开始登录流程 ===
2025-10-26 23:18:42.447 +08:00 [INF] 用户名: teacher
2025-10-26 23:18:42.447 +08:00 [INF] 密码长度: 10
2025-10-26 23:18:42.447 +08:00 [INF] AuthService是否为null: False
2025-10-26 23:18:42.447 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 23:18:42.447 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 23:18:42.447 +08:00 [INF] 接收到的用户名: teacher
2025-10-26 23:18:42.447 +08:00 [INF] 接收到的密码长度: 10
2025-10-26 23:18:42.447 +08:00 [INF] 开始查询用户
2025-10-26 23:18:42.447 +08:00 [INF] UserRepository是否为null: False
2025-10-26 23:18:42.447 +08:00 [INF] Context是否为null: False
2025-10-26 23:18:42.447 +08:00 [INF] 测试数据库连接...
2025-10-26 23:18:42.448 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:18:42.448 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:18:42.448 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.448 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.448 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.448 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.448 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 23:18:42.448 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.448 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.448 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.448 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.448 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.448 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:18:42.448 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:18:42.449 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.449 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.449 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.449 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.449 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 23:18:42.449 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.449 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.449 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.449 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.449 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.449 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:18:42.449 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:18:42.449 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:42.449 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.449 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.449 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.449 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.449 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 23:18:42.449 +08:00 [INF] 用户ID: 3, 用户名: teacher, 角色: Teacher
2025-10-26 23:18:42.449 +08:00 [INF] 用户是否激活: True
2025-10-26 23:18:42.449 +08:00 [INF] 登录失败次数: 0
2025-10-26 23:18:42.449 +08:00 [INF] 检查账户锁定状态
2025-10-26 23:18:42.450 +08:00 [INF] 开始验证密码
2025-10-26 23:18:42.450 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 23:18:42.450 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 23:18:42.450 +08:00 [INF] 密码哈希前20字符: $2a$12$TV26S1Af2e9Sw...
2025-10-26 23:18:42.450 +08:00 [INF] 开始验证密码 - 用户: teacher
2025-10-26 23:18:42.450 +08:00 [INF] 密码哈希长度: 60
2025-10-26 23:18:42.450 +08:00 [INF] 密码哈希前缀: $2a$12$TV2
2025-10-26 23:18:42.617 +08:00 [INF] 密码验证结果: True
2025-10-26 23:18:42.617 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 23:18:42.617 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:18:42.617 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:18:42.617 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:18:42.617 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:42.617 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:18:42.618 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.618 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.618 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.618 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.618 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.618 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:18:42.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:18:42.620 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.620 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:18:42.620 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.620 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.620 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:42.620 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:18:42.620 +08:00 [INF] 用户信息更新完成
2025-10-26 23:18:42.620 +08:00 [INF] 用户登录成功 - teacher
2025-10-26 23:18:42.620 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 23:18:42.620 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 23:18:42.620 +08:00 [INF] 成功: True
2025-10-26 23:18:42.620 +08:00 [INF] 消息: 登录成功
2025-10-26 23:18:42.620 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:18:42.620 +08:00 [INF] 用户 teacher 登录成功
2025-10-26 23:18:42.620 +08:00 [INF] 上次登录时间: 2025-10-26 23:09:55
2025-10-26 23:18:42.620 +08:00 [INF] 触发登录成功事件
2025-10-26 23:18:42.620 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 23:18:42.620 +08:00 [INF] 登录成功的用户: teacher (Teacher)
2025-10-26 23:18:42.620 +08:00 [INF] 用户ID: 3
2025-10-26 23:18:42.620 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:18:42.622 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 23:18:42.622 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 23:18:42.624 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 23:18:42.626 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.626 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.626 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.626 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.626 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.626 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:42.626 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:42.626 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:18:42.626 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.626 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.626 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.626 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.627 +08:00 [DBG] Compiling query expression: 
'DbSet<Question>()'
2025-10-26 23:18:42.629 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Question>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Question.QuestionId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Question.Analysis (string), 1], [Property: Question.Answer (string) Required, 2], [Property: Question.BankId (int) Required FK Index, 3], [Property: Question.Content (string) Required, 4], [Property: Question.CreatedAt (DateTime) Required, 5], [Property: Question.Difficulty (Difficulty) Required, 6], [Property: Question.IsActive (bool) Required, 7], [Property: Question.QuestionType (QuestionType) Required, 8], [Property: Question.Score (decimal) Required, 9], [Property: Question.Tags (string) MaxLength(200), 10], [Property: Question.Title (string) Required MaxLength(200), 11], [Property: Question.UpdatedAt (DateTime) Required, 12] }
        SELECT q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt
        FROM Questions AS q), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Question>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:18:42.630 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.630 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.630 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.630 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:18:42.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:18:42.630 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.630 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.630 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.630 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.630 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.630 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.630 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.630 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:42.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:42.631 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.631 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.631 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.631 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.631 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.631 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.631 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.631 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.631 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.631 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:42.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:42.631 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.631 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.631 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.631 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.632 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.632 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.632 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.632 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.632 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.632 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:42.632 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:42.632 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.632 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.632 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.632 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.634 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 23:18:42.634 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 23:18:42.634 +08:00 [INF] 接收到的用户: teacher (Teacher)
2025-10-26 23:18:42.634 +08:00 [INF] 用户ID: 3
2025-10-26 23:18:42.634 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:18:42.634 +08:00 [INF] 设置后的CurrentUser: teacher (Teacher)
2025-10-26 23:18:42.634 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 23:18:42.634 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 23:18:42.634 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.634 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.634 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.634 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.634 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.634 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:42.634 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:42.634 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.634 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.634 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.634 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.634 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 23:18:42.646 +08:00 [INF] 所有页面加载完成
2025-10-26 23:18:42.646 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 23:18:42.646 +08:00 [INF] 当前用户: teacher (Teacher)
2025-10-26 23:18:42.646 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 23:18:42.646 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 23:18:42.646 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 23:18:42.646 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 23:18:42.646 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 23:18:42.646 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 23:18:42.646 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 23:18:42.646 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 23:18:42.646 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 23:18:42.646 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 23:18:42.646 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 23:18:42.646 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 23:18:42.646 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 23:18:42.646 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 23:18:42.646 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 23:18:42.655 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:18:42.684 +08:00 [INF] 关闭登录窗口
2025-10-26 23:18:42.687 +08:00 [INF] === 登录流程结束 ===
2025-10-26 23:18:42.694 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.694 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.694 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.694 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.694 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.694 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:42.694 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:18:42.694 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.695 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.695 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:18:42.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:18:42.695 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.695 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.695 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:42.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:18:42.695 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.695 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:18:42.695 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:18:42.695 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:42.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:18:42.695 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:18:42.695 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:18:42.695 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:18:42.707 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:18:42.725 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:18:58.563 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:03.203 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:03.409 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:04.188 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:14.821 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:14.850 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-26 23:19:14.908 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:15.955 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:16.360 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:16.963 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:17.622 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:17.746 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:17.808 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:17.917 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:18.521 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:18.614 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:18.661 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:18.769 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:18.941 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.004 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.442 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.520 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.537 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.646 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.724 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.800 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.847 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.909 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:19.939 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.002 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.034 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.135 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.249 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.348 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.514 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.560 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.637 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.668 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.699 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.747 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.809 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.887 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:20.959 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:21.010 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:21.151 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:21.198 +08:00 [INF] === 开始登录流程 ===
2025-10-26 23:19:21.198 +08:00 [INF] 用户名: admin
2025-10-26 23:19:21.198 +08:00 [INF] 密码长度: 8
2025-10-26 23:19:21.198 +08:00 [INF] AuthService是否为null: False
2025-10-26 23:19:21.198 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-26 23:19:21.198 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-26 23:19:21.198 +08:00 [INF] 接收到的用户名: admin
2025-10-26 23:19:21.198 +08:00 [INF] 接收到的密码长度: 8
2025-10-26 23:19:21.198 +08:00 [INF] 开始查询用户
2025-10-26 23:19:21.198 +08:00 [INF] UserRepository是否为null: False
2025-10-26 23:19:21.198 +08:00 [INF] Context是否为null: False
2025-10-26 23:19:21.198 +08:00 [INF] 测试数据库连接...
2025-10-26 23:19:21.198 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:19:21.199 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:19:21.199 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.199 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.199 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.199 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.199 +08:00 [INF] 数据库连接测试结果: True
2025-10-26 23:19:21.199 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.199 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.199 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.199 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.199 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.199 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:19:21.199 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-26 23:19:21.199 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.200 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.200 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.200 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.200 +08:00 [INF] 数据库中用户总数: 3
2025-10-26 23:19:21.200 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.200 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.200 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.200 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.200 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.200 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:19:21.200 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-26 23:19:21.202 +08:00 [DBG] The navigation 'QuestionBank.Creator' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:19:21.203 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:19:21.204 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.204 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 3ms reading results.
2025-10-26 23:19:21.204 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.204 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.204 +08:00 [INF] 用户查询结果: 找到用户
2025-10-26 23:19:21.204 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-26 23:19:21.204 +08:00 [INF] 用户是否激活: True
2025-10-26 23:19:21.204 +08:00 [INF] 登录失败次数: 0
2025-10-26 23:19:21.204 +08:00 [INF] 检查账户锁定状态
2025-10-26 23:19:21.204 +08:00 [INF] 开始验证密码
2025-10-26 23:19:21.204 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-26 23:19:21.204 +08:00 [INF] 密码哈希是否为空: False
2025-10-26 23:19:21.204 +08:00 [INF] 密码哈希前20字符: $2a$12$CksfgNpdNp2FY...
2025-10-26 23:19:21.204 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-26 23:19:21.204 +08:00 [INF] 密码哈希长度: 60
2025-10-26 23:19:21.204 +08:00 [INF] 密码哈希前缀: $2a$12$Cks
2025-10-26 23:19:21.364 +08:00 [INF] 密码验证结果: True
2025-10-26 23:19:21.364 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-26 23:19:21.364 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-26 23:19:21.364 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-26 23:19:21.367 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-26 23:19:21.367 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:19:21.367 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-26 23:19:21.367 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.367 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.367 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.367 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.367 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.367 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:19:21.367 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1
RETURNING 1;
2025-10-26 23:19:21.370 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.370 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 2ms reading results.
2025-10-26 23:19:21.370 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.370 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.370 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:19:21.370 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-26 23:19:21.370 +08:00 [INF] 用户信息更新完成
2025-10-26 23:19:21.370 +08:00 [INF] 用户登录成功 - admin
2025-10-26 23:19:21.370 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-26 23:19:21.370 +08:00 [INF] === 登录服务返回结果 ===
2025-10-26 23:19:21.370 +08:00 [INF] 成功: True
2025-10-26 23:19:21.370 +08:00 [INF] 消息: 登录成功
2025-10-26 23:19:21.370 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:19:21.370 +08:00 [INF] 用户 admin 登录成功
2025-10-26 23:19:21.370 +08:00 [INF] 上次登录时间: 2025-10-26 23:09:32
2025-10-26 23:19:21.370 +08:00 [INF] 触发登录成功事件
2025-10-26 23:19:21.370 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-26 23:19:21.370 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-26 23:19:21.370 +08:00 [INF] 用户ID: 1
2025-10-26 23:19:21.370 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:19:21.372 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-26 23:19:21.372 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-26 23:19:21.374 +08:00 [INF] 在LoadPages中为DashboardViewModel设置用户信息并加载数据
2025-10-26 23:19:21.376 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.376 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:19:21.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:19:21.376 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.376 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.376 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:19:21.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:19:21.376 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.376 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.376 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.376 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.376 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.376 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.376 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:19:21.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:19:21.376 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.376 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.376 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.383 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-10-26 23:19:21.385 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (DateTime?), 4], [Property: User.LockoutEnd (DateTime?), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11] }
        SELECT u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Users AS u), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:19:21.385 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.385 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.385 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.385 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.385 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.385 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:19:21.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:19:21.386 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-26 23:19:21.386 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.386 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.386 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.386 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.386 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.386 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.386 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.386 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.386 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.386 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.386 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.386 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.386 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.386 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.386 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.386 +08:00 [DBG] Compiling query expression: 
'DbSet<Notification>()'
2025-10-26 23:19:21.388 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Notification>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Notification.NotificationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Notification.Content (string) Required, 1], [Property: Notification.CreatedAt (DateTime) Required, 2], [Property: Notification.Priority (NotificationPriority) Required, 3], [Property: Notification.Scope (NotificationScope) Required, 4], [Property: Notification.SenderId (int) Required FK Index, 5], [Property: Notification.Status (NotificationStatus) Required, 6], [Property: Notification.Title (string) Required MaxLength(200), 7] }
        SELECT n.NotificationId, n.Content, n.CreatedAt, n.Priority, n.Scope, n.SenderId, n.Status, n.Title
        FROM Notifications AS n), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Notification>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False, 
    True
)'
2025-10-26 23:19:21.388 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.388 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.388 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.388 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.388 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.388 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:19:21.388 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:19:21.388 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.388 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.388 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.388 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.390 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.390 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.390 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.390 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.390 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.390 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:19:21.390 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:19:21.390 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.390 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.390 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.390 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.392 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-26 23:19:21.392 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-26 23:19:21.392 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-26 23:19:21.392 +08:00 [INF] 用户ID: 1
2025-10-26 23:19:21.392 +08:00 [INF] 用户对象是否为null: False
2025-10-26 23:19:21.392 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-26 23:19:21.392 +08:00 [INF] CurrentUser是否为null: False
2025-10-26 23:19:21.392 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-26 23:19:21.393 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.393 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.393 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.393 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.393 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.393 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.393 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.393 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.393 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.393 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.393 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.393 +08:00 [INF] 加载试卷列表成功，共 0 个试卷
2025-10-26 23:19:21.402 +08:00 [INF] 所有页面加载完成
2025-10-26 23:19:21.402 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-26 23:19:21.402 +08:00 [INF] 当前用户: admin (Admin)
2025-10-26 23:19:21.402 +08:00 [INF] DashboardFrame是否为null: False
2025-10-26 23:19:21.402 +08:00 [INF] DashboardFrame.Content是否为null: True
2025-10-26 23:19:21.402 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-26 23:19:21.402 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-26 23:19:21.402 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-26 23:19:21.402 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-26 23:19:21.402 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-26 23:19:21.402 +08:00 [INF] ExamFrame是否为null: False
2025-10-26 23:19:21.402 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-26 23:19:21.402 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-26 23:19:21.402 +08:00 [INF] ExamResultFrame是否为null: False
2025-10-26 23:19:21.402 +08:00 [INF] ExamResultFrame.Content是否为null: True
2025-10-26 23:19:21.402 +08:00 [INF] ExamResultFrame.Content不是StudentExamResultView类型（可能为教师/管理员视图）
2025-10-26 23:19:21.402 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-26 23:19:21.402 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-26 23:19:21.407 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:19:21.418 +08:00 [INF] 关闭登录窗口
2025-10-26 23:19:21.420 +08:00 [INF] === 登录流程结束 ===
2025-10-26 23:19:21.422 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.422 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.423 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:19:21.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-26 23:19:21.423 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.423 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.423 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:19:21.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "Questions" AS "q"
2025-10-26 23:19:21.423 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.423 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.423 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.423 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.423 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.423 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:19:21.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
2025-10-26 23:19:21.423 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.423 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.423 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:19:21.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-26 23:19:21.423 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.423 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.423 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.423 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.423 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-26 23:19:21.424 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.424 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.424 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.424 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.424 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.424 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.424 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:19:21.424 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.424 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:19:21.424 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:19:21.424 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "n"."NotificationId", "n"."Content", "n"."CreatedAt", "n"."Priority", "n"."Scope", "n"."SenderId", "n"."Status", "n"."Title"
FROM "Notifications" AS "n"
2025-10-26 23:19:21.424 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.424 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:19:21.424 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:19:21.424 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:19:21.448 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:21.448 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:19:25.261 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:25.261 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:19:27.806 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:27.806 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:19:30.039 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-26 23:19:30.039 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-26 23:24:24.250 +08:00 [DBG] Hosting starting
2025-10-26 23:24:24.277 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-26 23:24:24.279 +08:00 [INF] Hosting environment: Production
2025-10-26 23:24:24.280 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-26 23:24:24.280 +08:00 [DBG] Hosting started
2025-10-26 23:24:24.320 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-26 23:24:24.335 +08:00 [INF] SQLite 数据库路径: E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db
2025-10-26 23:24:24.499 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:24:24.521 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:24:24.589 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type - {'Grader', 'User'} that could be matched with the properties on the other entity type - {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:24:24.589 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type - {'ExamRecords'} that could be matched with the properties on the other entity type - {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-26 23:24:24.609 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-26 23:24:24.760 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:24:24.765 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:24:24.769 +08:00 [DBG] Created DbConnection. (3ms).
2025-10-26 23:24:24.771 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.772 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:24:24.773 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:24:24.773 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.777 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.779 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.780 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.784 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:24:24.786 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (2ms).
2025-10-26 23:24:24.786 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-10-26 23:24:24.787 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.790 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.792 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.801 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.802 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.803 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.804 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:24:24.804 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:24:24.804 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.804 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.804 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.804 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.804 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:24:24.804 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:24:24.804 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:24:24.804 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.804 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.804 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.804 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.804 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.810 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.810 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.810 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:24:24.810 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.810 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.810 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:24:24.810 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:24:24.812 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.813 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 1ms reading results.
2025-10-26 23:24:24.813 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.813 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.818 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 23:24:24.819 +08:00 [DBG] Migrating using database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.819 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:24:24.819 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:24:24.819 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.819 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:24:24.820 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.820 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Creating DbConnection.
2025-10-26 23:24:24.820 +08:00 [DBG] Created DbConnection. (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-26 23:24:24.820 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-26 23:24:24.820 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.820 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:24:24.820 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.820 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:24:24.821 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-26 23:24:24.821 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.821 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:24:24.821 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.821 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.821 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-26 23:24:24.836 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-26 23:24:24.894 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:24:24.902 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.902 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.902 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:24:24.902 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.902 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.902 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:24:24.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-26 23:24:24.903 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.903 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:24:24.903 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.903 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.903 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-26 23:24:24.904 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:24:24.905 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.905 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.905 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:24:24.905 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.905 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.905 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:24:24.905 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-26 23:24:24.905 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.905 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:24:24.905 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.905 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.905 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-26 23:24:24.906 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-26 23:24:24.906 +08:00 [DBG] Opening connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.906 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.906 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-26 23:24:24.906 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.906 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-26 23:24:24.906 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:24:24.906 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-26 23:24:24.906 +08:00 [DBG] Closing data reader to 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.906 +08:00 [DBG] A data reader for 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' is being disposed after spending 0ms reading results.
2025-10-26 23:24:24.906 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.906 +08:00 [DBG] Closed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.907 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-26 23:24:24.907 +08:00 [DBG] Disposing connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db'.
2025-10-26 23:24:24.907 +08:00 [DBG] Disposed connection to database 'main' on server 'E:\Project\exam_trae\ExamSystem.WPF\bin\Debug\net8.0-windows10.0.19041\exam_system.db' (0ms).
2025-10-26 23:24:24.911 +08:00 [DBG] Entity Framework Core 8.0.8 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite:8.0.8' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-26 23:25:28.229 +08:00 [DBG] 'ExamDbContext' disposed.
