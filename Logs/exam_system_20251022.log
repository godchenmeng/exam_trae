2025-10-22 00:00:22.148 +08:00 [DBG] Hosting starting
2025-10-22 00:00:22.167 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:00:22.167 +08:00 [INF] Hosting environment: Production
2025-10-22 00:00:22.168 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:00:22.168 +08:00 [DBG] Hosting started
2025-10-22 00:00:22.202 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:00:22.336 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:00:22.349 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:00:22.407 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:00:22.407 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:00:22.430 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:00:22.543 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:00:22.571 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.575 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.579 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.589 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:00:22.594 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (4ms).
2025-10-22 00:00:22.595 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.598 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.602 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.612 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.614 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.615 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.617 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.618 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.618 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:00:22.618 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:00:22.618 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.618 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.618 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.619 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.619 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.620 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.624 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:22.624 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:22.624 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.624 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.625 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:00:22.626 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:00:22.627 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:22.627 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.628 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.635 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:00:22.636 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.636 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.636 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.636 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:00:22.636 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:00:22.636 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.637 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.637 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.638 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.638 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.638 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.639 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.639 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.639 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:00:22.639 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:00:22.639 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.639 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.639 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:00:22.640 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.641 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.641 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:22.641 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:22.641 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.641 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.641 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:00:22.642 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:00:22.642 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:22.642 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.643 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.643 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:00:22.664 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:00:22.759 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:22.770 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:22.770 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:22.770 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.770 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.770 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:00:22.772 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:00:22.772 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:22.772 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.773 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.774 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:00:22.774 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:22.775 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:22.775 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:22.775 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.775 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.775 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:00:22.776 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:00:22.776 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:22.776 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.777 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.777 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:00:22.777 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:22.778 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:22.778 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:22.778 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.778 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.778 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:00:22.779 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:00:22.779 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:22.779 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:22.780 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:22.780 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:00:22.782 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:00:30.688 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:00:30.688 +08:00 [INF] 用户名: student
2025-10-22 00:00:30.688 +08:00 [INF] 密码长度: 10
2025-10-22 00:00:30.688 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:00:30.688 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:00:30.690 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:00:30.690 +08:00 [INF] 接收到的用户名: student
2025-10-22 00:00:30.690 +08:00 [INF] 接收到的密码长度: 10
2025-10-22 00:00:30.690 +08:00 [INF] 开始查询用户
2025-10-22 00:00:30.690 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:00:30.690 +08:00 [INF] Context是否为null: False
2025-10-22 00:00:30.690 +08:00 [INF] 测试数据库连接...
2025-10-22 00:00:30.691 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:30.691 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:30.691 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:00:30.692 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:00:30.695 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:30.698 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:30.698 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:30.698 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:30.698 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:30.699 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:00:30.700 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:00:30.700 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:30.700 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:30.701 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:30.701 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:00:30.702 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:00:30.714 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:30.717 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:30.717 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:30.717 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:30.718 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:30.718 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:00:30.720 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:00:30.724 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:30.744 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:30.744 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:30.745 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:30.745 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:00:30.745 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-22 00:00:30.746 +08:00 [INF] 用户是否激活: True
2025-10-22 00:00:30.746 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:00:30.746 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:00:30.747 +08:00 [INF] 开始验证密码
2025-10-22 00:00:30.747 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:00:30.747 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:00:30.747 +08:00 [INF] 密码哈希前20字符: $2a$12$iXseHsdkCBsHc...
2025-10-22 00:00:30.747 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-22 00:00:30.747 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:00:30.747 +08:00 [INF] 密码哈希前缀: $2a$12$iXs
2025-10-22 00:00:30.920 +08:00 [INF] 密码验证结果: True
2025-10-22 00:00:30.920 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:00:30.922 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:30.922 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:30.928 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:30.932 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:30.934 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:30.941 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:30.941 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:30.942 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:30.944 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:30.959 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:30.959 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:30.960 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:00:30.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:00:30.962 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:30.963 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:30.967 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:30.968 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:30.970 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:30.971 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:30.974 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:30.974 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:30.974 +08:00 [INF] 用户信息更新完成
2025-10-22 00:00:30.975 +08:00 [INF] 用户登录成功 - student
2025-10-22 00:00:30.975 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:00:30.975 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:00:30.975 +08:00 [INF] 成功: True
2025-10-22 00:00:30.975 +08:00 [INF] 消息: 登录成功
2025-10-22 00:00:30.975 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:00:30.975 +08:00 [INF] 用户 student 登录成功
2025-10-22 00:00:30.977 +08:00 [INF] 上次登录时间: 2025-10-21 23:50:40
2025-10-22 00:00:30.977 +08:00 [INF] 触发登录成功事件
2025-10-22 00:00:30.977 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:00:30.978 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-22 00:00:30.978 +08:00 [INF] 用户ID: 2
2025-10-22 00:00:30.978 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:00:30.989 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:00:30.989 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:00:30.990 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-22 00:00:30.999 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:00:31.001 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:00:31.001 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:31.002 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:31.002 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.002 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.002 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:00:31.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:00:31.004 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.007 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:31.007 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.008 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.014 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:00:31.015 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:00:31.015 +08:00 [INF] 接收到的用户: student (Student)
2025-10-22 00:00:31.015 +08:00 [INF] 用户ID: 2
2025-10-22 00:00:31.015 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:00:31.015 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-22 00:00:31.015 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:00:31.015 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:00:31.016 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:00:31.018 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:00:31.018 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:31.018 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:31.018 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.018 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.018 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:00:31.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:00:31.022 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.032 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:31.032 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.032 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.033 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:00:31.039 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-22 00:00:31.040 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-22 00:00:31.041 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-22 00:00:31.042 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.Creator)
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .Where(p => p.IsPublished)
    .OrderByDescending(p => p.CreatedAt)'
2025-10-22 00:00:31.048 +08:00 [DBG] Including navigation: 'ExamPaper.Creator'.
2025-10-22 00:00:31.049 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:00:31.049 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 00:00:31.084 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, t.Id, t.OrderIndex, t.PaperId, t.QuestionId, t.Score, t.QuestionId0, t.Analysis, t.Answer, t.BankId, t.Content, t.CreatedAt, t.Difficulty, t.IsActive, t.QuestionType, t.Score0, t.Tags, t.Title, t.UpdatedAt
        FROM ExamPapers AS e
        INNER JOIN Users AS u ON e.CreatorId == u.UserId
        LEFT JOIN Projection Mapping:
        (
            SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
            FROM PaperQuestions AS p
            INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
        ) AS t ON e.PaperId == t.PaperId
        WHERE e.IsPublished
        ORDER BY e.CreatedAt DESC, e.PaperId ASC, u.UserId ASC, t.Id ASC, t.QuestionId0 ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:00:31.084 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:31.084 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:31.084 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.085 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.085 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 00:00:31.086 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 00:00:31.086 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.092 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.097 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:31.107 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:31.107 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.108 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.108 +08:00 [INF] 成功获取 1 个已发布的试卷
2025-10-22 00:00:31.109 +08:00 [INF] 成功加载 1 个可参加的考试
2025-10-22 00:00:31.119 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .Count()'
2025-10-22 00:00:31.120 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM NotificationRecipients AS n
            WHERE n.ReceiverId == @__receiverId_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:31.120 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:31.120 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:31.120 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.120 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.120 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 00:00:31.122 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 00:00:31.122 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:31.122 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.122 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.123 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .OrderByDescending(r => r.Notification.CreatedAt)
    .Skip(__p_1)
    .Take(__p_2)'
2025-10-22 00:00:31.123 +08:00 [DBG] Including navigation: 'NotificationRecipient.Notification'.
2025-10-22 00:00:31.124 +08:00 [DBG] Including navigation: 'Notification.Sender'.
2025-10-22 00:00:31.129 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<NotificationRecipient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT t.NotificationRecipientId, t.CreatedAt, t.DeliveryStatus, t.NotificationId, t.ReadAt, t.ReceiverId, t.NotificationId0, t.Content, t.CreatedAt0, t.Priority, t.Scope, t.SenderId, t.Status, t.Title, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Projection Mapping:
        (
            SELECT n.NotificationRecipientId, n.CreatedAt, n.DeliveryStatus, n.NotificationId, n.ReadAt, n.ReceiverId, n0.NotificationId AS NotificationId0, n0.Content, n0.CreatedAt AS CreatedAt0, n0.Priority, n0.Scope, n0.SenderId, n0.Status, n0.Title
            FROM NotificationRecipients AS n
            INNER JOIN Notifications AS n0 ON n.NotificationId == n0.NotificationId
            WHERE n.ReceiverId == @__receiverId_0
            ORDER BY n0.CreatedAt DESC
            OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
        ) AS t
        INNER JOIN Users AS u ON t.SenderId == u.UserId
        ORDER BY t.CreatedAt0 DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, NotificationRecipient>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:00:31.129 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:31.129 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:31.129 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.130 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.130 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 00:00:31.131 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 00:00:31.131 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:31.131 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:31.131 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:31.144 +08:00 [INF] 所有页面加载完成
2025-10-22 00:00:31.145 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:00:31.145 +08:00 [INF] 当前用户: student (Student)
2025-10-22 00:00:31.145 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:00:31.145 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:00:31.145 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:00:31.145 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:00:31.145 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:00:31.145 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:00:31.145 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:00:31.145 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:00:31.145 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:00:31.145 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:00:31.145 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:00:31.165 +08:00 [INF] 关闭登录窗口
2025-10-22 00:00:31.169 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:00:33.335 +08:00 [INF] 学生 2 请求开始考试 1
2025-10-22 00:00:33.335 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=TakeExam, Result=True
2025-10-22 00:00:33.336 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:00:33.337 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .FirstOrDefault(p => p.PaperId == __paperId_0)'
2025-10-22 00:00:33.337 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:00:33.337 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 00:00:33.344 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamPaper>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamPaper>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.PaperId, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt, t.CreatorId, t.Description, t.Duration, t.EndTime, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime, t.Status, t.TotalScore, t.UpdatedAt, t0.Id, t0.OrderIndex, t0.PaperId, t0.QuestionId, t0.Score, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
                FROM ExamPapers AS e
                WHERE e.PaperId == @__paperId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
                FROM PaperQuestions AS p
                INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
            ) AS t0 ON t.PaperId == t0.PaperId
            ORDER BY t.PaperId ASC, t0.Id ASC, t0.QuestionId0 ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:33.344 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:33.344 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:33.344 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:33.345 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:33.345 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:33.347 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:33.347 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:33.347 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:33.347 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:33.348 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:00:33.348 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:00:33.348 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:00:33.348 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .FirstOrDefault(r => r.UserId == __userId_0 && r.PaperId == __paperId_1)'
2025-10-22 00:00:33.350 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (Nullable<DateTime>), 3], [Property: ExamRecord.GradedAt (Nullable<DateTime>), 4], [Property: ExamRecord.GraderId (Nullable<int>) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (Nullable<DateTime>), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (Nullable<DateTime>), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16], }
            SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
            FROM ExamRecords AS e
            WHERE (e.UserId == @__userId_0) && (e.PaperId == @__paperId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:33.350 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:33.350 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:33.350 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:33.351 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:33.351 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:00:33.352 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:00:33.353 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:33.364 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:33.364 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:33.364 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:33.364 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:00:33.364 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:00:34.553 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:00:34.554 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.554 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.554 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.554 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.554 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:34.557 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:34.557 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.557 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.557 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.557 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:00:34.557 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:00:34.557 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:00:34.558 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.558 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.558 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.558 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.558 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:00:34.559 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:00:34.559 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.559 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.560 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.560 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:00:34.560 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:00:34.561 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:00:34.561 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.561 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.561 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.562 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.562 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:34.563 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:34.563 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.563 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.563 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.563 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:00:34.563 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:00:34.563 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:00:34.563 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.563 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.563 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.564 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.564 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:00:34.564 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:00:34.564 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.564 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.565 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.565 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:00:34.565 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:00:34.566 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.566 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.566 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.566 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.566 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:34.567 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:00:34.567 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.567 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.567 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.580 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'RecordId.ExamRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.582 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.582 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:34.582 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:34.591 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:34.591 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.592 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.592 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:34.593 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:34.596 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.596 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.596 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.596 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.602 +08:00 [DBG] The foreign key property 'ExamRecord.RecordId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.604 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.604 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:34.611 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:34.611 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.615 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.616 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:34.616 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.616 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:34.619 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.625 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:34.625 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:34.626 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:34.626 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.627 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.627 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:34.628 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:34.628 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.628 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.628 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.630 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.630 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.630 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.630 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.630 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.630 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.630 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.630 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.630 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.630 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.630 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.631 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.631 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.631 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.631 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.631 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.631 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.631 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.631 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.631 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.631 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.631 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.631 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.631 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.631 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.631 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.631 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:00:34.631 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:34.631 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.631 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:34.635 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:34.635 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.640 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.640 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.640 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 9 entities written to the database.
2025-10-22 00:00:34.641 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .ThenInclude(p => p.PaperQuestions)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __examRecord_RecordId_0)'
2025-10-22 00:00:34.641 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 00:00:34.641 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:00:34.641 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 00:00:34.641 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 00:00:34.642 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 00:00:34.643 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 00:00:34.653 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__examRecord_RecordId_0
            ) AS t
            LEFT JOIN PaperQuestions AS p ON t.PaperId0 == p.PaperId
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, p.Id ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:34.653 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:34.654 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:34.654 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.654 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.654 +08:00 [DBG] Executing DbCommand [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 00:00:34.656 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 00:00:34.657 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.659 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:34.660 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:34.660 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:34.660 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:34.660 +08:00 [INF] 用户 2 开始考试，试卷ID: 1，记录ID: 4
2025-10-22 00:00:35.914 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=1, Option=B, beforeSelected=1
2025-10-22 00:00:35.915 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=1, Option=B
2025-10-22 00:00:35.915 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=1, Option=B, afterSelected=1
2025-10-22 00:00:36.783 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .FirstOrDefault(ar => ar.RecordId == __recordId_0 && ar.QuestionId == __questionId_1)'
2025-10-22 00:00:36.785 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AnswerRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<AnswerRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
            SELECT TOP(1) a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
            FROM AnswerRecords AS a
            WHERE (a.RecordId == @__recordId_0) && (a.QuestionId == @__questionId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:00:36.785 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:36.785 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:36.785 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:36.786 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:36.786 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:36.787 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:36.787 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:36.787 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:36.788 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:36.788 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:36.788 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:36.788 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:36.788 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:36.788 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:36.789 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:36.789 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:36.790 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:36.790 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:36.791 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:36.791 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:36.791 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:36.791 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:36.791 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:36.791 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:36.791 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:36.795 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:36.795 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:36.797 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:36.797 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:36.797 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:36.797 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:36.797 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 1
2025-10-22 00:00:43.503 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:43.503 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:43.503 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:43.503 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:43.503 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:43.505 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:43.505 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:43.505 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:43.506 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:43.506 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:43.506 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:43.506 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:43.506 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:43.506 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:43.506 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:43.506 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:43.507 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:43.507 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:43.507 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:43.508 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:43.508 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:43.508 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:43.508 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:43.508 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:43.508 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:43.511 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:43.511 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:43.514 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:43.514 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:43.514 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:43.514 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:43.514 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 6
2025-10-22 00:00:44.162 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=3, Option=B, beforeSelected=1
2025-10-22 00:00:44.162 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=3, Option=B
2025-10-22 00:00:44.162 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=3, Option=B, afterSelected=1
2025-10-22 00:00:44.984 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:44.984 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:44.984 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:44.984 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:44.984 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:44.986 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:44.986 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:44.986 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:44.987 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:44.987 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:44.987 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:44.987 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:44.987 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:44.987 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:44.987 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:44.987 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:44.987 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:44.987 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:44.988 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:44.988 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:44.988 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:44.988 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:44.988 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:44.988 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:44.988 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:44.992 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:44.993 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:44.995 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:44.995 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:44.995 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:44.995 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:44.995 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 4
2025-10-22 00:00:46.651 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:46.651 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:46.652 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:46.652 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:46.652 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:46.654 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:46.654 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:46.654 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:46.654 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:46.654 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:46.654 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:46.655 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:46.655 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:46.655 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:46.655 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:46.655 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:46.655 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:46.655 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:46.656 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:46.656 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:46.656 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:46.656 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:46.656 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:46.656 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:46.656 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:46.660 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:46.660 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:46.662 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:46.662 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:46.662 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:46.662 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:46.662 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 8
2025-10-22 00:00:48.319 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:48.319 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:48.319 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:48.319 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:48.319 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:48.321 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:48.321 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:48.321 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:48.321 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:48.321 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:48.321 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:48.322 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:48.322 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:48.322 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:48.322 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:48.322 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:48.322 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:48.322 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:48.323 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:48.323 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:48.323 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:48.323 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:48.323 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:48.323 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:48.323 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:48.327 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:48.327 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:48.329 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:48.329 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:48.329 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:48.329 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:48.329 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 10
2025-10-22 00:00:52.114 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:52.114 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:52.114 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:52.115 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:52.115 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:52.116 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:52.116 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:52.116 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:52.117 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:52.117 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:52.117 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:52.117 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:52.117 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:52.117 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:52.117 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:52.117 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:52.118 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:52.118 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:52.118 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:52.119 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:52.119 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:52.119 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:52.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:52.119 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:52.119 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:52.123 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:52.123 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:52.125 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:52.125 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:52.125 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:52.125 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:52.125 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 12
2025-10-22 00:00:56.158 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:56.158 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:56.158 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:56.158 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:56.158 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:56.160 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:56.160 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:56.160 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:56.160 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:56.160 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:56.160 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:56.161 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:56.161 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:56.161 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:56.161 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:56.161 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:56.161 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:56.161 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:56.162 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:56.162 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:56.162 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:56.162 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 27)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:56.162 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 27)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:56.162 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:56.162 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:56.166 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:56.166 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:56.168 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:56.168 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:56.168 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:56.168 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:56.168 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 14
2025-10-22 00:00:59.800 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:59.800 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:59.800 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:59.800 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:59.800 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:59.802 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:00:59.802 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:59.802 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:59.802 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:59.803 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:00:59.803 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:00:59.803 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:59.803 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:59.803 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:00:59.803 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:00:59.803 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:59.803 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:59.803 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:00:59.804 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:00:59.804 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:00:59.804 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:00:59.804 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:59.805 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:00:59.805 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:00:59.805 +08:00 [DBG] Committing transaction.
2025-10-22 00:00:59.809 +08:00 [DBG] Committed transaction.
2025-10-22 00:00:59.809 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:00:59.812 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:00:59.812 +08:00 [DBG] Disposing transaction.
2025-10-22 00:00:59.812 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:00:59.812 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:00:59.812 +08:00 [DBG] 保存答案成功，记录ID: 4，题目ID: 49
2025-10-22 00:01:04.894 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 00:01:04.896 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (Nullable<DateTime>), 3], [Property: ExamRecord.GradedAt (Nullable<DateTime>), 4], [Property: ExamRecord.GraderId (Nullable<int>) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (Nullable<DateTime>), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (Nullable<DateTime>), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16], }
            SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
            FROM ExamRecords AS e
            WHERE e.RecordId == @__recordId_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:01:04.896 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:01:04.896 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:01:04.896 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:01:04.896 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:01:04.897 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE "e"."RecordId" = @__recordId_0
LIMIT 1
2025-10-22 00:01:04.898 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE "e"."RecordId" = @__recordId_0
LIMIT 1
2025-10-22 00:01:04.899 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:01:04.899 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:01:04.900 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:01:04.900 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:01:04.900 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:01:04.900 +08:00 [DBG] The unchanged property 'ExamRecord.RemainingTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:01:04.900 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:01:04.900 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:01:04.900 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:01:04.900 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:01:04.900 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:01:04.900 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:01:04.900 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:01:04.901 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:01:04.902 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:01:04.902 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:01:04.902 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "UserAnswer" = @p0
WHERE "AnswerId" = @p1;
SELECT changes();
2025-10-22 00:01:04.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "UserAnswer" = @p0
WHERE "AnswerId" = @p1;
SELECT changes();
2025-10-22 00:01:04.902 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:01:04.902 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:01:04.902 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:01:04.902 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "RemainingTime" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 00:01:04.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "RemainingTime" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 00:01:04.902 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:01:04.902 +08:00 [DBG] Committing transaction.
2025-10-22 00:01:04.907 +08:00 [DBG] Committed transaction.
2025-10-22 00:01:04.907 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:01:04.910 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:01:04.910 +08:00 [DBG] Disposing transaction.
2025-10-22 00:01:04.911 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:01:04.911 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:01:04.911 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 2 entities written to the database.
2025-10-22 00:01:08.856 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 00:01:10.124 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:02:46.849 +08:00 [DBG] Hosting starting
2025-10-22 00:02:46.868 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:02:46.869 +08:00 [INF] Hosting environment: Production
2025-10-22 00:02:46.870 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:02:46.870 +08:00 [DBG] Hosting started
2025-10-22 00:02:46.903 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:02:47.034 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:02:47.047 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:02:47.106 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:02:47.107 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:02:47.130 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:02:47.241 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:02:47.269 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.272 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.277 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.285 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:02:47.288 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 00:02:47.290 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.293 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.296 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.306 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.308 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.309 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.310 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.311 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.311 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:02:47.311 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:02:47.311 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.311 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.311 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.312 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.313 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.317 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:47.317 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:47.317 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.317 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.317 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:02:47.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:02:47.320 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:47.320 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.320 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.327 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:02:47.328 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.329 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.329 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.329 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:02:47.329 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:02:47.329 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.329 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.329 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.330 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.330 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.331 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.331 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.331 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.331 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:02:47.331 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:02:47.331 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.331 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.331 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:02:47.332 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.332 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.332 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:47.332 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:47.332 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.333 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.333 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:02:47.333 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:02:47.333 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:47.333 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.334 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.334 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:02:47.354 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:02:47.454 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:47.464 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:47.464 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:47.464 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.465 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.465 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:02:47.466 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:02:47.467 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:47.467 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.467 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.467 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:02:47.468 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:47.468 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:47.468 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:47.468 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.469 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.469 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:02:47.470 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:02:47.470 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:47.470 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.470 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.470 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:02:47.471 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:47.471 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:47.471 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:47.471 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.471 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.471 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:02:47.472 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:02:47.472 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:47.472 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:47.473 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:47.473 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:02:47.474 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:02:55.360 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:02:55.360 +08:00 [INF] 用户名: student
2025-10-22 00:02:55.360 +08:00 [INF] 密码长度: 10
2025-10-22 00:02:55.360 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:02:55.360 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:02:55.363 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:02:55.363 +08:00 [INF] 接收到的用户名: student
2025-10-22 00:02:55.363 +08:00 [INF] 接收到的密码长度: 10
2025-10-22 00:02:55.363 +08:00 [INF] 开始查询用户
2025-10-22 00:02:55.363 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:02:55.363 +08:00 [INF] Context是否为null: False
2025-10-22 00:02:55.363 +08:00 [INF] 测试数据库连接...
2025-10-22 00:02:55.364 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.364 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.364 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:02:55.364 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:02:55.368 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:55.371 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.371 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.371 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.371 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.371 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:02:55.373 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:02:55.373 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.373 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.374 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.374 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:02:55.375 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:02:55.387 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:55.389 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.390 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.390 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.390 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.391 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:02:55.393 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:02:55.396 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.416 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.416 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.417 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.417 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:02:55.417 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-22 00:02:55.417 +08:00 [INF] 用户是否激活: True
2025-10-22 00:02:55.417 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:02:55.417 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:02:55.419 +08:00 [INF] 开始验证密码
2025-10-22 00:02:55.419 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:02:55.419 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:02:55.419 +08:00 [INF] 密码哈希前20字符: $2a$12$iXseHsdkCBsHc...
2025-10-22 00:02:55.419 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-22 00:02:55.419 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:02:55.419 +08:00 [INF] 密码哈希前缀: $2a$12$iXs
2025-10-22 00:02:55.592 +08:00 [INF] 密码验证结果: True
2025-10-22 00:02:55.592 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:02:55.593 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:02:55.594 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:02:55.599 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:02:55.603 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.605 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:02:55.612 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.612 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.613 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:02:55.615 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:02:55.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.630 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:02:55.631 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:02:55.633 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.634 +08:00 [DBG] Committing transaction.
2025-10-22 00:02:55.638 +08:00 [DBG] Committed transaction.
2025-10-22 00:02:55.638 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.641 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.642 +08:00 [DBG] Disposing transaction.
2025-10-22 00:02:55.645 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.645 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:02:55.645 +08:00 [INF] 用户信息更新完成
2025-10-22 00:02:55.645 +08:00 [INF] 用户登录成功 - student
2025-10-22 00:02:55.645 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:02:55.646 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:02:55.646 +08:00 [INF] 成功: True
2025-10-22 00:02:55.646 +08:00 [INF] 消息: 登录成功
2025-10-22 00:02:55.646 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:02:55.646 +08:00 [INF] 用户 student 登录成功
2025-10-22 00:02:55.647 +08:00 [INF] 上次登录时间: 2025-10-22 00:00:30
2025-10-22 00:02:55.647 +08:00 [INF] 触发登录成功事件
2025-10-22 00:02:55.648 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:02:55.648 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-22 00:02:55.648 +08:00 [INF] 用户ID: 2
2025-10-22 00:02:55.648 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:02:55.659 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:02:55.659 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:02:55.660 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-22 00:02:55.670 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:02:55.672 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:02:55.672 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.672 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.672 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.672 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.672 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:02:55.674 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:02:55.674 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.678 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.678 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.678 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.685 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:02:55.685 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:02:55.685 +08:00 [INF] 接收到的用户: student (Student)
2025-10-22 00:02:55.685 +08:00 [INF] 用户ID: 2
2025-10-22 00:02:55.685 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:02:55.686 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-22 00:02:55.686 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:02:55.686 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:02:55.687 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:02:55.688 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:02:55.688 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.689 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.689 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.689 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.689 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:02:55.690 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:02:55.693 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.703 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.703 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.703 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.704 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:02:55.711 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-22 00:02:55.711 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-22 00:02:55.712 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-22 00:02:55.713 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.Creator)
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .Where(p => p.IsPublished)
    .OrderByDescending(p => p.CreatedAt)'
2025-10-22 00:02:55.719 +08:00 [DBG] Including navigation: 'ExamPaper.Creator'.
2025-10-22 00:02:55.720 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:02:55.720 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 00:02:55.755 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, t.Id, t.OrderIndex, t.PaperId, t.QuestionId, t.Score, t.QuestionId0, t.Analysis, t.Answer, t.BankId, t.Content, t.CreatedAt, t.Difficulty, t.IsActive, t.QuestionType, t.Score0, t.Tags, t.Title, t.UpdatedAt
        FROM ExamPapers AS e
        INNER JOIN Users AS u ON e.CreatorId == u.UserId
        LEFT JOIN Projection Mapping:
        (
            SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
            FROM PaperQuestions AS p
            INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
        ) AS t ON e.PaperId == t.PaperId
        WHERE e.IsPublished
        ORDER BY e.CreatedAt DESC, e.PaperId ASC, u.UserId ASC, t.Id ASC, t.QuestionId0 ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:02:55.755 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.755 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.755 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.756 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.756 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 00:02:55.758 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 00:02:55.758 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.764 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.769 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.778 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.778 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:55.779 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.779 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.780 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.780 +08:00 [INF] 成功获取 1 个已发布的试卷
2025-10-22 00:02:55.780 +08:00 [INF] 成功加载 1 个可参加的考试
2025-10-22 00:02:55.790 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .Count()'
2025-10-22 00:02:55.791 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM NotificationRecipients AS n
            WHERE n.ReceiverId == @__receiverId_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:55.791 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.791 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.791 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.792 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.792 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 00:02:55.793 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 00:02:55.793 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.793 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.794 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.794 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .OrderByDescending(r => r.Notification.CreatedAt)
    .Skip(__p_1)
    .Take(__p_2)'
2025-10-22 00:02:55.795 +08:00 [DBG] Including navigation: 'NotificationRecipient.Notification'.
2025-10-22 00:02:55.795 +08:00 [DBG] Including navigation: 'Notification.Sender'.
2025-10-22 00:02:55.801 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<NotificationRecipient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT t.NotificationRecipientId, t.CreatedAt, t.DeliveryStatus, t.NotificationId, t.ReadAt, t.ReceiverId, t.NotificationId0, t.Content, t.CreatedAt0, t.Priority, t.Scope, t.SenderId, t.Status, t.Title, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Projection Mapping:
        (
            SELECT n.NotificationRecipientId, n.CreatedAt, n.DeliveryStatus, n.NotificationId, n.ReadAt, n.ReceiverId, n0.NotificationId AS NotificationId0, n0.Content, n0.CreatedAt AS CreatedAt0, n0.Priority, n0.Scope, n0.SenderId, n0.Status, n0.Title
            FROM NotificationRecipients AS n
            INNER JOIN Notifications AS n0 ON n.NotificationId == n0.NotificationId
            WHERE n.ReceiverId == @__receiverId_0
            ORDER BY n0.CreatedAt DESC
            OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
        ) AS t
        INNER JOIN Users AS u ON t.SenderId == u.UserId
        ORDER BY t.CreatedAt0 DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, NotificationRecipient>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:02:55.801 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:55.801 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:55.801 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.801 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.801 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 00:02:55.802 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 00:02:55.802 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:55.802 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:55.803 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:55.816 +08:00 [INF] 所有页面加载完成
2025-10-22 00:02:55.816 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:02:55.816 +08:00 [INF] 当前用户: student (Student)
2025-10-22 00:02:55.816 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:02:55.816 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:02:55.816 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:02:55.816 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:02:55.816 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:02:55.816 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:02:55.816 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:02:55.816 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:02:55.816 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:02:55.816 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:02:55.817 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:02:55.839 +08:00 [INF] 关闭登录窗口
2025-10-22 00:02:55.843 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:02:57.864 +08:00 [INF] 学生 2 请求开始考试 1
2025-10-22 00:02:57.864 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=TakeExam, Result=True
2025-10-22 00:02:57.865 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:02:57.866 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .FirstOrDefault(p => p.PaperId == __paperId_0)'
2025-10-22 00:02:57.866 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:02:57.866 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 00:02:57.872 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamPaper>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamPaper>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.PaperId, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt, t.CreatorId, t.Description, t.Duration, t.EndTime, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime, t.Status, t.TotalScore, t.UpdatedAt, t0.Id, t0.OrderIndex, t0.PaperId, t0.QuestionId, t0.Score, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
                FROM ExamPapers AS e
                WHERE e.PaperId == @__paperId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
                FROM PaperQuestions AS p
                INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
            ) AS t0 ON t.PaperId == t0.PaperId
            ORDER BY t.PaperId ASC, t0.Id ASC, t0.QuestionId0 ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:57.873 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:57.873 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:57.873 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:57.873 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:57.873 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:02:57.875 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:02:57.875 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:57.875 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:57.876 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:57.876 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:02:57.876 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:02:57.876 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:02:57.877 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .FirstOrDefault(r => r.UserId == __userId_0 && r.PaperId == __paperId_1)'
2025-10-22 00:02:57.879 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (Nullable<DateTime>), 3], [Property: ExamRecord.GradedAt (Nullable<DateTime>), 4], [Property: ExamRecord.GraderId (Nullable<int>) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (Nullable<DateTime>), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (Nullable<DateTime>), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16], }
            SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
            FROM ExamRecords AS e
            WHERE (e.UserId == @__userId_0) && (e.PaperId == @__paperId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:02:57.879 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:02:57.879 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:02:57.879 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:57.879 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:57.879 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:02:57.880 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:02:57.882 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:02:57.893 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:02:57.893 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:02:57.894 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:02:57.894 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:02:57.894 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:03:00.250 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:03:00.251 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.251 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.251 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.252 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.252 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:03:00.254 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:03:00.254 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.254 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.255 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.255 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:03:00.255 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:03:00.255 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:03:00.255 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.255 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.255 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.255 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.255 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:03:00.257 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:03:00.257 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.257 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.257 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.257 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:03:00.257 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:03:00.259 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:03:00.259 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.259 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.259 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.259 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.259 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:03:00.261 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:03:00.261 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.261 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.261 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.261 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:03:00.261 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:03:00.261 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:03:00.262 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.262 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.262 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.262 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.262 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:03:00.263 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:03:00.263 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.263 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.264 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.264 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:03:00.264 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:03:00.265 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.265 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.265 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.265 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.265 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:03:00.266 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:03:00.267 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.267 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.267 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.280 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'RecordId.ExamRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.283 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.283 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:03:00.283 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:03:00.292 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:03:00.293 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.293 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.293 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:03:00.295 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:03:00.298 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.298 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.298 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.299 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.305 +08:00 [DBG] The foreign key property 'ExamRecord.RecordId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.308 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.308 +08:00 [DBG] Committing transaction.
2025-10-22 00:03:00.315 +08:00 [DBG] Committed transaction.
2025-10-22 00:03:00.315 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.319 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.320 +08:00 [DBG] Disposing transaction.
2025-10-22 00:03:00.321 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.321 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:03:00.324 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.332 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:03:00.332 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:03:00.333 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:03:00.334 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.334 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.334 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:03:00.335 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:03:00.336 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.336 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.336 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.336 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.337 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.337 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.338 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.338 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.338 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.338 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.338 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.338 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.338 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.338 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.338 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.338 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.338 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.338 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.338 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.338 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.338 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.338 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.338 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.338 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.338 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.339 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.339 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.339 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.339 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.339 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.339 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.339 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.339 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.339 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.339 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.339 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.339 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.339 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.339 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.339 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:03:00.339 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:00.339 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.339 +08:00 [DBG] Committing transaction.
2025-10-22 00:03:00.343 +08:00 [DBG] Committed transaction.
2025-10-22 00:03:00.344 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.347 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.347 +08:00 [DBG] Disposing transaction.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.348 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 9 entities written to the database.
2025-10-22 00:03:00.348 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .ThenInclude(p => p.PaperQuestions)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __examRecord_RecordId_0)'
2025-10-22 00:03:00.349 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 00:03:00.349 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:03:00.349 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 00:03:00.349 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 00:03:00.349 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 00:03:00.351 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 00:03:00.362 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__examRecord_RecordId_0
            ) AS t
            LEFT JOIN PaperQuestions AS p ON t.PaperId0 == p.PaperId
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, p.Id ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:03:00.362 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:00.362 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:00.362 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.362 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.362 +08:00 [DBG] Executing DbCommand [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 00:03:00.364 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 00:03:00.366 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:00.368 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:00.369 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:00.369 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:00.369 +08:00 [INF] 用户 2 开始考试，试卷ID: 1，记录ID: 5
2025-10-22 00:03:00.990 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=1, Option=A, beforeSelected=1
2025-10-22 00:03:00.991 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=1, Option=A
2025-10-22 00:03:00.991 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=1, Option=A, afterSelected=1
2025-10-22 00:03:01.325 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=1, Option=B, beforeSelected=1
2025-10-22 00:03:01.325 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=1, Option=B
2025-10-22 00:03:01.326 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=1, Option=B, afterSelected=1
2025-10-22 00:03:02.141 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .FirstOrDefault(ar => ar.RecordId == __recordId_0 && ar.QuestionId == __questionId_1)'
2025-10-22 00:03:02.143 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AnswerRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<AnswerRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
            SELECT TOP(1) a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
            FROM AnswerRecords AS a
            WHERE (a.RecordId == @__recordId_0) && (a.QuestionId == @__questionId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:03:02.143 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:02.143 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:02.143 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:02.144 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:02.144 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:03:02.145 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:03:02.145 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:02.145 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:02.146 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:02.146 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:03:02.146 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:03:02.146 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:02.147 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:02.147 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:02.147 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:03:02.147 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:02.148 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:02.148 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:03:02.148 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:03:02.149 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:02.149 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:02.149 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:03:02.149 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:03:02.149 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:02.149 +08:00 [DBG] Committing transaction.
2025-10-22 00:03:02.153 +08:00 [DBG] Committed transaction.
2025-10-22 00:03:02.153 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:02.155 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:02.155 +08:00 [DBG] Disposing transaction.
2025-10-22 00:03:02.155 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:02.155 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:03:02.155 +08:00 [DBG] 保存答案成功，记录ID: 5，题目ID: 1
2025-10-22 00:03:07.047 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:07.047 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:07.047 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:07.047 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:07.048 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:03:07.049 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:03:07.049 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:07.049 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:07.050 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:07.050 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:03:07.050 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:03:07.050 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:07.050 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:07.050 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:03:07.050 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:03:07.050 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:07.050 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:07.050 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:03:07.051 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:03:07.051 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:03:07.051 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:03:07.051 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:03:07.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:03:07.052 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:03:07.052 +08:00 [DBG] Committing transaction.
2025-10-22 00:03:07.056 +08:00 [DBG] Committed transaction.
2025-10-22 00:03:07.056 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:03:07.058 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:03:07.058 +08:00 [DBG] Disposing transaction.
2025-10-22 00:03:07.058 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:03:07.058 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:03:07.058 +08:00 [DBG] 保存答案成功，记录ID: 5，题目ID: 6
2025-10-22 00:03:08.092 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=3, Option=C, beforeSelected=1
2025-10-22 00:03:08.092 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=3, Option=C
2025-10-22 00:03:08.092 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=3, Option=C, afterSelected=1
2025-10-22 00:03:11.220 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 00:03:12.212 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:17:19.680 +08:00 [DBG] Hosting starting
2025-10-22 00:17:19.699 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:17:19.700 +08:00 [INF] Hosting environment: Production
2025-10-22 00:17:19.700 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:17:19.700 +08:00 [DBG] Hosting started
2025-10-22 00:17:19.733 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:17:19.866 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:17:19.879 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:17:19.937 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:17:19.938 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:17:19.961 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:17:20.076 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:17:20.104 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.107 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.112 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.120 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:17:20.124 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 00:17:20.125 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.127 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.131 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.142 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.143 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.144 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.146 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.146 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.146 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:17:20.146 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:17:20.146 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.146 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.146 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.147 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.147 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.148 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.152 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:20.152 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:20.152 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.153 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.153 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:17:20.154 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:17:20.155 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:20.155 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.156 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.163 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:17:20.164 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.164 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.165 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.165 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:17:20.165 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:17:20.165 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.165 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.165 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.166 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.166 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.167 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.167 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.167 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.167 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:17:20.167 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:17:20.167 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.168 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.168 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:17:20.169 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.169 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.169 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:20.169 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:20.169 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.170 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.170 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:17:20.171 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:17:20.171 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:20.171 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.171 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.171 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:17:20.193 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:17:20.293 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:20.303 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:20.303 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:20.303 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.303 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.304 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:17:20.305 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:17:20.305 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:20.305 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.306 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.306 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:17:20.307 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:20.307 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:20.307 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:20.307 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.308 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.308 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:17:20.309 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:17:20.309 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:20.309 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.309 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.309 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:17:20.310 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:20.310 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:20.310 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:20.310 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.310 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.310 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:17:20.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:17:20.311 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:20.311 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:20.312 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:20.313 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:17:20.314 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:17:29.178 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:17:29.179 +08:00 [INF] 用户名: student
2025-10-22 00:17:29.179 +08:00 [INF] 密码长度: 10
2025-10-22 00:17:29.179 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:17:29.179 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:17:29.181 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:17:29.181 +08:00 [INF] 接收到的用户名: student
2025-10-22 00:17:29.181 +08:00 [INF] 接收到的密码长度: 10
2025-10-22 00:17:29.181 +08:00 [INF] 开始查询用户
2025-10-22 00:17:29.181 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:17:29.181 +08:00 [INF] Context是否为null: False
2025-10-22 00:17:29.181 +08:00 [INF] 测试数据库连接...
2025-10-22 00:17:29.182 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.182 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.182 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:17:29.182 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:17:29.186 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:29.189 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.189 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.189 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.189 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.189 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:17:29.191 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:17:29.191 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.191 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.192 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.192 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:17:29.193 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:17:29.205 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:29.208 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.208 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.209 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.209 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.209 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:17:29.212 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:17:29.215 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.235 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.236 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.236 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.236 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:17:29.237 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-22 00:17:29.237 +08:00 [INF] 用户是否激活: True
2025-10-22 00:17:29.237 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:17:29.237 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:17:29.239 +08:00 [INF] 开始验证密码
2025-10-22 00:17:29.239 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:17:29.239 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:17:29.239 +08:00 [INF] 密码哈希前20字符: $2a$12$iXseHsdkCBsHc...
2025-10-22 00:17:29.239 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-22 00:17:29.239 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:17:29.239 +08:00 [INF] 密码哈希前缀: $2a$12$iXs
2025-10-22 00:17:29.413 +08:00 [INF] 密码验证结果: True
2025-10-22 00:17:29.413 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:17:29.414 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:17:29.415 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:17:29.420 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:29.423 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.426 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:17:29.432 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.433 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.433 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:17:29.435 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:17:29.451 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.451 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.451 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:17:29.452 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:17:29.454 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.454 +08:00 [DBG] Committing transaction.
2025-10-22 00:17:29.459 +08:00 [DBG] Committed transaction.
2025-10-22 00:17:29.459 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.462 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.463 +08:00 [DBG] Disposing transaction.
2025-10-22 00:17:29.466 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.466 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:17:29.466 +08:00 [INF] 用户信息更新完成
2025-10-22 00:17:29.466 +08:00 [INF] 用户登录成功 - student
2025-10-22 00:17:29.466 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:17:29.466 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:17:29.466 +08:00 [INF] 成功: True
2025-10-22 00:17:29.466 +08:00 [INF] 消息: 登录成功
2025-10-22 00:17:29.466 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:17:29.466 +08:00 [INF] 用户 student 登录成功
2025-10-22 00:17:29.468 +08:00 [INF] 上次登录时间: 2025-10-22 00:02:55
2025-10-22 00:17:29.468 +08:00 [INF] 触发登录成功事件
2025-10-22 00:17:29.468 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:17:29.469 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-22 00:17:29.469 +08:00 [INF] 用户ID: 2
2025-10-22 00:17:29.469 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:17:29.480 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:17:29.480 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:17:29.481 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-22 00:17:29.490 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:17:29.492 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:17:29.492 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.492 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.492 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.492 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.492 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:17:29.493 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:17:29.494 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.497 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.497 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.498 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.505 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:17:29.505 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:17:29.505 +08:00 [INF] 接收到的用户: student (Student)
2025-10-22 00:17:29.505 +08:00 [INF] 用户ID: 2
2025-10-22 00:17:29.505 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:17:29.505 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-22 00:17:29.505 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:17:29.505 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:17:29.506 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:17:29.508 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:17:29.508 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.508 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.508 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.508 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.508 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:17:29.510 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:17:29.512 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.522 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.522 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.522 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.523 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:17:29.529 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-22 00:17:29.530 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-22 00:17:29.530 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-22 00:17:29.532 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.Creator)
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .Where(p => p.IsPublished)
    .OrderByDescending(p => p.CreatedAt)'
2025-10-22 00:17:29.538 +08:00 [DBG] Including navigation: 'ExamPaper.Creator'.
2025-10-22 00:17:29.538 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:17:29.539 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 00:17:29.574 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, t.Id, t.OrderIndex, t.PaperId, t.QuestionId, t.Score, t.QuestionId0, t.Analysis, t.Answer, t.BankId, t.Content, t.CreatedAt, t.Difficulty, t.IsActive, t.QuestionType, t.Score0, t.Tags, t.Title, t.UpdatedAt
        FROM ExamPapers AS e
        INNER JOIN Users AS u ON e.CreatorId == u.UserId
        LEFT JOIN Projection Mapping:
        (
            SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
            FROM PaperQuestions AS p
            INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
        ) AS t ON e.PaperId == t.PaperId
        WHERE e.IsPublished
        ORDER BY e.CreatedAt DESC, e.PaperId ASC, u.UserId ASC, t.Id ASC, t.QuestionId0 ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:17:29.575 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.575 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.575 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.575 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.575 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 00:17:29.577 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 00:17:29.577 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.583 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.588 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.597 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.597 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:29.598 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.598 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.599 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.599 +08:00 [INF] 成功获取 1 个已发布的试卷
2025-10-22 00:17:29.599 +08:00 [INF] 成功加载 1 个可参加的考试
2025-10-22 00:17:29.609 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .Count()'
2025-10-22 00:17:29.610 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM NotificationRecipients AS n
            WHERE n.ReceiverId == @__receiverId_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:29.610 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.610 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.610 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.610 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.610 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 00:17:29.611 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 00:17:29.611 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.611 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.612 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.613 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .OrderByDescending(r => r.Notification.CreatedAt)
    .Skip(__p_1)
    .Take(__p_2)'
2025-10-22 00:17:29.613 +08:00 [DBG] Including navigation: 'NotificationRecipient.Notification'.
2025-10-22 00:17:29.614 +08:00 [DBG] Including navigation: 'Notification.Sender'.
2025-10-22 00:17:29.619 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<NotificationRecipient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT t.NotificationRecipientId, t.CreatedAt, t.DeliveryStatus, t.NotificationId, t.ReadAt, t.ReceiverId, t.NotificationId0, t.Content, t.CreatedAt0, t.Priority, t.Scope, t.SenderId, t.Status, t.Title, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Projection Mapping:
        (
            SELECT n.NotificationRecipientId, n.CreatedAt, n.DeliveryStatus, n.NotificationId, n.ReadAt, n.ReceiverId, n0.NotificationId AS NotificationId0, n0.Content, n0.CreatedAt AS CreatedAt0, n0.Priority, n0.Scope, n0.SenderId, n0.Status, n0.Title
            FROM NotificationRecipients AS n
            INNER JOIN Notifications AS n0 ON n.NotificationId == n0.NotificationId
            WHERE n.ReceiverId == @__receiverId_0
            ORDER BY n0.CreatedAt DESC
            OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
        ) AS t
        INNER JOIN Users AS u ON t.SenderId == u.UserId
        ORDER BY t.CreatedAt0 DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, NotificationRecipient>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:17:29.620 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:29.620 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:29.620 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.620 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.620 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 00:17:29.621 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 00:17:29.621 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:29.621 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:29.622 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:29.634 +08:00 [INF] 所有页面加载完成
2025-10-22 00:17:29.635 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:17:29.635 +08:00 [INF] 当前用户: student (Student)
2025-10-22 00:17:29.635 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:17:29.635 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:17:29.635 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:17:29.635 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:17:29.635 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:17:29.635 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:17:29.635 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:17:29.635 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:17:29.635 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:17:29.635 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:17:29.635 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:17:29.655 +08:00 [INF] 关闭登录窗口
2025-10-22 00:17:29.658 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:17:31.968 +08:00 [INF] 学生 2 请求开始考试 1
2025-10-22 00:17:31.968 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=TakeExam, Result=True
2025-10-22 00:17:31.969 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:17:31.970 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .FirstOrDefault(p => p.PaperId == __paperId_0)'
2025-10-22 00:17:31.970 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:17:31.970 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 00:17:31.977 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamPaper>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamPaper>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.PaperId, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt, t.CreatorId, t.Description, t.Duration, t.EndTime, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime, t.Status, t.TotalScore, t.UpdatedAt, t0.Id, t0.OrderIndex, t0.PaperId, t0.QuestionId, t0.Score, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
                FROM ExamPapers AS e
                WHERE e.PaperId == @__paperId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
                FROM PaperQuestions AS p
                INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
            ) AS t0 ON t.PaperId == t0.PaperId
            ORDER BY t.PaperId ASC, t0.Id ASC, t0.QuestionId0 ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:31.977 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:31.977 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:31.977 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:31.978 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:31.978 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:31.980 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:31.980 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:31.980 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:31.980 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:31.981 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:17:31.981 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:17:31.981 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:17:31.981 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .FirstOrDefault(r => r.UserId == __userId_0 && r.PaperId == __paperId_1)'
2025-10-22 00:17:31.983 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (Nullable<DateTime>), 3], [Property: ExamRecord.GradedAt (Nullable<DateTime>), 4], [Property: ExamRecord.GraderId (Nullable<int>) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (Nullable<DateTime>), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (Nullable<DateTime>), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16], }
            SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
            FROM ExamRecords AS e
            WHERE (e.UserId == @__userId_0) && (e.PaperId == @__paperId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:31.983 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:31.983 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:31.983 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:31.984 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:31.984 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:17:31.985 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:17:31.987 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:31.997 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:31.997 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:31.998 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:31.998 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:17:31.998 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:17:32.873 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:17:32.874 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.874 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.875 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.875 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.875 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:32.877 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:32.877 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.877 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.878 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.878 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:17:32.878 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:17:32.878 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:17:32.878 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.878 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.878 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.878 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.878 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:17:32.879 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:17:32.880 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.880 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.880 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.880 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:17:32.880 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:17:32.882 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 00:17:32.882 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.882 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.882 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.882 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.882 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:32.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:32.883 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.883 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.884 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.884 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 00:17:32.884 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 00:17:32.884 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 00:17:32.884 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.884 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.884 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.884 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.885 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:17:32.885 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 00:17:32.885 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.885 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.886 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.886 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Submitted", AllowRetake: true
2025-10-22 00:17:32.886 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 00:17:32.887 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.887 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.887 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.887 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.887 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:32.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 00:17:32.888 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.888 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.889 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.903 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'RecordId.ExamRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.906 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.906 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:17:32.906 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:17:32.915 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:17:32.916 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.916 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.916 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:17:32.917 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:17:32.920 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.920 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.921 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.921 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.927 +08:00 [DBG] The foreign key property 'ExamRecord.RecordId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.929 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.929 +08:00 [DBG] Committing transaction.
2025-10-22 00:17:32.935 +08:00 [DBG] Committed transaction.
2025-10-22 00:17:32.935 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.939 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.939 +08:00 [DBG] Disposing transaction.
2025-10-22 00:17:32.940 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.941 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:17:32.943 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.949 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.950 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.950 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.950 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.950 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:17:32.950 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:17:32.951 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:17:32.951 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.951 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.951 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:17:32.952 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:17:32.953 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.953 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.953 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.953 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.954 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.955 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.955 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.955 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.955 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.955 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.955 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.955 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.955 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.955 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.955 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.955 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.955 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.955 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.955 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.955 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.955 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.955 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.956 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.956 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.956 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.956 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.956 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.956 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.956 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.956 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.956 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.956 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.956 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.956 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.956 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.956 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.956 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.956 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.956 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.956 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 00:17:32.956 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:32.956 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.956 +08:00 [DBG] Committing transaction.
2025-10-22 00:17:32.961 +08:00 [DBG] Committed transaction.
2025-10-22 00:17:32.961 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.965 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.965 +08:00 [DBG] Disposing transaction.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.966 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 9 entities written to the database.
2025-10-22 00:17:32.967 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .ThenInclude(p => p.PaperQuestions)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __examRecord_RecordId_0)'
2025-10-22 00:17:32.967 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 00:17:32.967 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 00:17:32.967 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 00:17:32.968 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 00:17:32.968 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 00:17:32.969 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 00:17:32.982 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__examRecord_RecordId_0
            ) AS t
            LEFT JOIN PaperQuestions AS p ON t.PaperId0 == p.PaperId
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, p.Id ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:32.982 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:32.982 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:32.982 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.982 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.982 +08:00 [DBG] Executing DbCommand [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 00:17:32.984 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 00:17:32.985 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:32.989 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:32.989 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:32.989 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:32.989 +08:00 [INF] 用户 2 开始考试，试卷ID: 1，记录ID: 6
2025-10-22 00:17:34.150 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .FirstOrDefault(ar => ar.RecordId == __recordId_0 && ar.QuestionId == __questionId_1)'
2025-10-22 00:17:34.152 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AnswerRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<AnswerRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
            SELECT TOP(1) a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
            FROM AnswerRecords AS a
            WHERE (a.RecordId == @__recordId_0) && (a.QuestionId == @__questionId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:17:34.152 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:34.152 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:34.152 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:34.153 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:34.153 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:17:34.154 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:17:34.155 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:34.155 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:34.155 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:34.155 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:17:34.155 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:17:34.156 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:34.156 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:34.156 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:34.157 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:17:34.157 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:34.157 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:34.157 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:17:34.158 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:17:34.158 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:34.158 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:34.158 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:17:34.158 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:17:34.158 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:34.158 +08:00 [DBG] Committing transaction.
2025-10-22 00:17:34.163 +08:00 [DBG] Committed transaction.
2025-10-22 00:17:34.163 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:34.165 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:34.165 +08:00 [DBG] Disposing transaction.
2025-10-22 00:17:34.166 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:34.166 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:17:34.166 +08:00 [DBG] 保存答案成功，记录ID: 6，题目ID: 1
2025-10-22 00:17:36.870 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:36.870 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:36.870 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:36.870 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:36.870 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:17:36.872 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:17:36.872 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:36.872 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:36.872 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:36.872 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:17:36.872 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:17:36.873 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:36.873 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:36.873 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:36.873 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:17:36.873 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:36.873 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:36.873 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:17:36.874 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:17:36.874 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:36.874 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:36.874 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:17:36.874 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:17:36.874 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:36.874 +08:00 [DBG] Committing transaction.
2025-10-22 00:17:36.878 +08:00 [DBG] Committed transaction.
2025-10-22 00:17:36.878 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:36.881 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:36.881 +08:00 [DBG] Disposing transaction.
2025-10-22 00:17:36.881 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:36.881 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:17:36.881 +08:00 [DBG] 保存答案成功，记录ID: 6，题目ID: 6
2025-10-22 00:17:37.267 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=1, Option=B, beforeSelected=1
2025-10-22 00:17:37.268 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=1, Option=B
2025-10-22 00:17:37.268 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=1, Option=B, afterSelected=1
2025-10-22 00:17:37.724 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=1, Option=D, beforeSelected=1
2025-10-22 00:17:37.724 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=1, Option=D
2025-10-22 00:17:37.724 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=1, Option=D, afterSelected=1
2025-10-22 00:17:39.062 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:39.062 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:39.062 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:39.062 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:39.062 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:17:39.064 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 00:17:39.064 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:39.064 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:39.064 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:39.064 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:17:39.064 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:17:39.065 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:39.065 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:39.065 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:17:39.065 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:17:39.065 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:39.065 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:39.065 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:17:39.066 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:17:39.066 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:17:39.066 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:17:39.066 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:17:39.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 00:17:39.066 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:17:39.066 +08:00 [DBG] Committing transaction.
2025-10-22 00:17:39.072 +08:00 [DBG] Committed transaction.
2025-10-22 00:17:39.072 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:17:39.075 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:17:39.075 +08:00 [DBG] Disposing transaction.
2025-10-22 00:17:39.075 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:17:39.075 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:17:39.075 +08:00 [DBG] 保存答案成功，记录ID: 6，题目ID: 1
2025-10-22 00:17:40.325 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=3, Option=B, beforeSelected=1
2025-10-22 00:17:40.325 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=3, Option=B
2025-10-22 00:17:40.325 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=3, Option=B, afterSelected=1
2025-10-22 00:17:43.645 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 00:17:45.067 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:29:40.792 +08:00 [DBG] Hosting starting
2025-10-22 00:29:40.812 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:29:40.813 +08:00 [INF] Hosting environment: Production
2025-10-22 00:29:40.813 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:29:40.813 +08:00 [DBG] Hosting started
2025-10-22 00:29:40.849 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:29:40.985 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:29:40.997 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:29:41.067 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:29:41.068 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:29:41.094 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:29:41.214 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:29:41.243 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.246 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.251 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.259 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:29:41.262 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 00:29:41.264 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.266 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.270 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.281 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.283 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.284 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.286 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.286 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.286 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:29:41.286 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:29:41.286 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.287 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.287 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.288 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.288 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.289 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.293 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:41.293 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:41.293 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.293 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.294 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:29:41.295 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:29:41.296 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:41.296 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.297 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.304 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:29:41.306 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.306 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.306 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.306 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:29:41.306 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:29:41.306 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.306 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.306 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.308 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.308 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.308 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.309 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.309 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.309 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:29:41.309 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:29:41.309 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.309 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.309 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.310 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:29:41.310 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.311 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.311 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:41.311 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:41.311 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.311 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.311 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:29:41.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:29:41.312 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:41.312 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.312 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.312 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:29:41.333 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:29:41.435 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:29:41.445 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:41.445 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:41.445 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.446 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.446 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:29:41.447 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:29:41.448 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:41.448 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.448 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.448 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:29:41.449 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:29:41.450 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:41.450 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:41.450 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.450 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.450 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:29:41.451 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:29:41.451 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:41.451 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.452 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.452 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:29:41.452 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:29:41.452 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:41.452 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:41.453 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.453 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.453 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:29:41.454 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:29:41.454 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:41.454 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:41.454 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:41.455 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:29:41.456 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:29:51.195 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:29:51.195 +08:00 [INF] 用户名: admin
2025-10-22 00:29:51.195 +08:00 [INF] 密码长度: 8
2025-10-22 00:29:51.195 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:29:51.195 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:29:51.197 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:29:51.198 +08:00 [INF] 接收到的用户名: admin
2025-10-22 00:29:51.198 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 00:29:51.198 +08:00 [INF] 开始查询用户
2025-10-22 00:29:51.198 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:29:51.198 +08:00 [INF] Context是否为null: False
2025-10-22 00:29:51.198 +08:00 [INF] 测试数据库连接...
2025-10-22 00:29:51.198 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.199 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.199 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:29:51.199 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:29:51.203 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:29:51.205 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:51.205 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:51.206 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.206 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.206 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:29:51.207 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:29:51.207 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:51.208 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.208 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.208 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:29:51.209 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:29:51.222 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:29:51.225 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:51.226 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-10-22 00:29:51.227 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.227 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.228 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:29:51.230 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:29:51.233 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:29:51.254 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:51.254 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.254 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.254 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:29:51.255 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 00:29:51.255 +08:00 [INF] 用户是否激活: True
2025-10-22 00:29:51.255 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:29:51.255 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:29:51.257 +08:00 [INF] 开始验证密码
2025-10-22 00:29:51.257 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:29:51.257 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:29:51.257 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 00:29:51.257 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 00:29:51.257 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:29:51.257 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 00:29:51.430 +08:00 [INF] 密码验证结果: True
2025-10-22 00:29:51.430 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:29:51.431 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:29:51.432 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:29:51.437 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:29:51.441 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:29:51.443 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:29:51.450 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.450 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.451 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:29:51.453 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:29:51.469 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:51.469 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:51.469 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:29:51.470 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:29:51.472 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:51.473 +08:00 [DBG] Committing transaction.
2025-10-22 00:29:51.478 +08:00 [DBG] Committed transaction.
2025-10-22 00:29:51.479 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.482 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.482 +08:00 [DBG] Disposing transaction.
2025-10-22 00:29:51.485 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:29:51.486 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:29:51.486 +08:00 [INF] 用户信息更新完成
2025-10-22 00:29:51.486 +08:00 [INF] 用户登录成功 - admin
2025-10-22 00:29:51.486 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:29:51.486 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:29:51.486 +08:00 [INF] 成功: True
2025-10-22 00:29:51.486 +08:00 [INF] 消息: 登录成功
2025-10-22 00:29:51.486 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:29:51.486 +08:00 [INF] 用户 admin 登录成功
2025-10-22 00:29:51.488 +08:00 [INF] 上次登录时间: 2025-10-21 23:40:06
2025-10-22 00:29:51.488 +08:00 [INF] 触发登录成功事件
2025-10-22 00:29:51.488 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:29:51.489 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 00:29:51.489 +08:00 [INF] 用户ID: 1
2025-10-22 00:29:51.489 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:29:51.500 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:29:51.500 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:29:51.510 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:29:51.512 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:29:51.512 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:51.512 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:51.512 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.512 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.512 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:29:51.514 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:29:51.514 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:29:51.521 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:51.521 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.522 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.529 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:29:51.530 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:29:51.530 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 00:29:51.530 +08:00 [INF] 用户ID: 1
2025-10-22 00:29:51.530 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:29:51.530 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 00:29:51.530 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:29:51.530 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:29:51.531 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:29:51.533 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:29:51.533 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:29:51.533 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:29:51.533 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.533 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.533 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:29:51.535 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:29:51.537 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:29:51.547 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:29:51.548 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:29:51.548 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:29:51.549 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:29:51.576 +08:00 [INF] 所有页面加载完成
2025-10-22 00:29:51.577 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:29:51.577 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 00:29:51.577 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:29:51.577 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:29:51.577 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:29:51.577 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:29:51.577 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:29:51.577 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:29:51.577 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:29:51.577 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:29:51.577 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:29:51.577 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:29:51.577 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:29:51.587 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:51.600 +08:00 [INF] 关闭登录窗口
2025-10-22 00:29:51.603 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:29:51.634 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:53.043 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:53.281 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:54.013 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:54.247 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:54.492 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:54.581 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:55.403 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:55.664 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:55.845 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:55.908 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:58.013 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:58.238 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:58.605 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:58.926 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:59.413 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:59.623 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:59.816 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:29:59.948 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:00.874 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:00.957 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:01.669 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:01.884 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:02.341 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:02.589 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:03.667 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-10-22 00:30:03.669 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
        SELECT u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Users AS u), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:30:03.670 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:30:03.670 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:30:03.670 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:30:03.670 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:30:03.671 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-22 00:30:03.672 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-22 00:30:03.672 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:30:03.674 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:30:03.674 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:30:03.674 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:30:03.675 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:30:03.697 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:03.882 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:07.869 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:08.473 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:10.204 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:10.535 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:10.780 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:10.876 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:11.154 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:11.325 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:11.684 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:11.866 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:12.844 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:12.945 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:13.149 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:13.283 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:13.690 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:13.815 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:14.012 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:14.145 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:14.358 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:14.523 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:14.749 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:14.893 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:15.292 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:15.465 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:15.753 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:15.861 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:16.118 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:16.267 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:30:18.627 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:31:57.953 +08:00 [DBG] Hosting starting
2025-10-22 00:31:57.974 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:31:57.975 +08:00 [INF] Hosting environment: Production
2025-10-22 00:31:57.975 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:31:57.975 +08:00 [DBG] Hosting started
2025-10-22 00:31:58.014 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:31:58.154 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:31:58.167 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:31:58.231 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:31:58.232 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:31:58.259 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:31:58.378 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:31:58.406 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.410 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.415 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.423 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:31:58.426 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 00:31:58.428 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.430 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.433 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.443 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.444 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.445 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.447 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.447 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.447 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:31:58.447 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:31:58.447 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.447 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.447 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.448 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.448 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.449 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.453 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:31:58.453 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:31:58.453 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.453 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.453 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:31:58.455 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:31:58.456 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:31:58.456 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.456 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.463 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:31:58.464 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.464 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.465 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.465 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:31:58.465 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:31:58.465 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.465 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.465 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.466 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.466 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.466 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.466 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.467 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.467 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:31:58.467 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:31:58.467 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.467 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.467 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.468 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:31:58.468 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.468 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.468 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:31:58.468 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:31:58.468 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.468 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.469 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:31:58.469 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:31:58.469 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:31:58.469 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.470 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.470 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:31:58.490 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:31:58.592 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:31:58.603 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:31:58.603 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:31:58.603 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.603 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.603 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:31:58.605 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:31:58.605 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:31:58.605 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.606 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.606 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:31:58.607 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:31:58.607 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:31:58.607 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:31:58.607 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.608 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.608 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:31:58.609 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:31:58.609 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:31:58.609 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.609 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.609 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:31:58.610 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:31:58.610 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:31:58.610 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:31:58.610 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.611 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.611 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:31:58.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:31:58.612 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:31:58.612 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:31:58.612 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:31:58.613 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:31:58.614 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:32:13.600 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:32:13.600 +08:00 [INF] 用户名: admin
2025-10-22 00:32:13.600 +08:00 [INF] 密码长度: 8
2025-10-22 00:32:13.600 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:32:13.600 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:32:13.602 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:32:13.602 +08:00 [INF] 接收到的用户名: admin
2025-10-22 00:32:13.602 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 00:32:13.602 +08:00 [INF] 开始查询用户
2025-10-22 00:32:13.602 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:32:13.602 +08:00 [INF] Context是否为null: False
2025-10-22 00:32:13.602 +08:00 [INF] 测试数据库连接...
2025-10-22 00:32:13.603 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.603 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.603 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:32:13.604 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:32:13.607 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:32:13.610 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:32:13.610 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:32:13.610 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.611 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.611 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:32:13.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:32:13.612 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:32:13.612 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.613 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.613 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:32:13.614 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:32:13.627 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:32:13.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:32:13.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:32:13.631 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.631 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.632 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:32:13.634 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:32:13.637 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:32:13.658 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:32:13.659 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.660 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.660 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:32:13.660 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 00:32:13.660 +08:00 [INF] 用户是否激活: True
2025-10-22 00:32:13.660 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:32:13.660 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:32:13.662 +08:00 [INF] 开始验证密码
2025-10-22 00:32:13.662 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:32:13.662 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:32:13.662 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 00:32:13.662 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 00:32:13.662 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:32:13.662 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 00:32:13.836 +08:00 [INF] 密码验证结果: True
2025-10-22 00:32:13.836 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:32:13.837 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:32:13.838 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:32:13.844 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:32:13.847 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:32:13.851 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:32:13.857 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.857 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.858 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:32:13.860 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:32:13.875 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:32:13.876 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:32:13.876 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:32:13.876 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:32:13.879 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:32:13.880 +08:00 [DBG] Committing transaction.
2025-10-22 00:32:13.885 +08:00 [DBG] Committed transaction.
2025-10-22 00:32:13.885 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.888 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.889 +08:00 [DBG] Disposing transaction.
2025-10-22 00:32:13.892 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:32:13.892 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:32:13.892 +08:00 [INF] 用户信息更新完成
2025-10-22 00:32:13.892 +08:00 [INF] 用户登录成功 - admin
2025-10-22 00:32:13.892 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:32:13.893 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:32:13.893 +08:00 [INF] 成功: True
2025-10-22 00:32:13.893 +08:00 [INF] 消息: 登录成功
2025-10-22 00:32:13.893 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:32:13.893 +08:00 [INF] 用户 admin 登录成功
2025-10-22 00:32:13.894 +08:00 [INF] 上次登录时间: 2025-10-22 00:29:51
2025-10-22 00:32:13.894 +08:00 [INF] 触发登录成功事件
2025-10-22 00:32:13.895 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:32:13.895 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 00:32:13.896 +08:00 [INF] 用户ID: 1
2025-10-22 00:32:13.896 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:32:13.907 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:32:13.907 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:32:13.917 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:32:13.919 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:32:13.920 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:32:13.920 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:32:13.920 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.920 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.920 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:32:13.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:32:13.922 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:32:13.929 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:32:13.929 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.930 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.937 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:32:13.938 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:32:13.938 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 00:32:13.938 +08:00 [INF] 用户ID: 1
2025-10-22 00:32:13.938 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:32:13.938 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 00:32:13.938 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:32:13.938 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:32:13.939 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:32:13.941 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:32:13.941 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:32:13.941 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:32:13.942 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.942 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.942 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:32:13.943 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:32:13.946 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:32:13.957 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:32:13.957 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:32:13.957 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:32:13.958 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:32:13.998 +08:00 [INF] 所有页面加载完成
2025-10-22 00:32:13.999 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:32:13.999 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 00:32:13.999 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:32:13.999 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:32:13.999 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:32:13.999 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:32:13.999 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:32:13.999 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:32:13.999 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:32:13.999 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:32:13.999 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:32:13.999 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:32:13.999 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:32:14.010 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:32:14.023 +08:00 [INF] 关闭登录窗口
2025-10-22 00:32:14.026 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:32:14.065 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:32:20.069 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:34:25.120 +08:00 [DBG] Hosting starting
2025-10-22 00:34:25.147 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:34:25.148 +08:00 [INF] Hosting environment: Production
2025-10-22 00:34:25.149 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:34:25.149 +08:00 [DBG] Hosting started
2025-10-22 00:34:25.185 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:34:25.318 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:34:25.332 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:34:25.392 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:34:25.392 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:34:25.415 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:34:25.529 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:34:25.558 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.561 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.567 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.576 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:34:25.579 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 00:34:25.581 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.584 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.588 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.598 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.599 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.600 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.602 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.602 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.602 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:34:25.602 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:34:25.602 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.603 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.603 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.604 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.604 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.604 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.609 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:25.609 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:25.609 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.609 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.609 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:34:25.611 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:34:25.612 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:25.612 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.613 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.620 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:34:25.622 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.622 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.622 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.622 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:34:25.622 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:34:25.622 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.623 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.623 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.624 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.624 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.625 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.625 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.625 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.625 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:34:25.625 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:34:25.625 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.625 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.625 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:34:25.626 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.626 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.626 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:25.626 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:25.626 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.627 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.627 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:34:25.627 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:34:25.628 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:25.628 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.628 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.628 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:34:25.649 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:34:25.750 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:34:25.760 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:25.760 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:25.760 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.760 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.760 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:34:25.762 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:34:25.762 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:25.762 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.763 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.763 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:34:25.764 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:34:25.764 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:25.764 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:25.764 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.765 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.765 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:34:25.766 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:34:25.766 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:25.766 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.766 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.766 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:34:25.767 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:34:25.767 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:25.767 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:25.767 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.768 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.768 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:34:25.769 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:34:25.769 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:25.769 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:25.769 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:25.770 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:34:25.771 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:34:33.461 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:34:33.461 +08:00 [INF] 用户名: admin
2025-10-22 00:34:33.461 +08:00 [INF] 密码长度: 8
2025-10-22 00:34:33.462 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:34:33.462 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:34:33.464 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:34:33.464 +08:00 [INF] 接收到的用户名: admin
2025-10-22 00:34:33.464 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 00:34:33.464 +08:00 [INF] 开始查询用户
2025-10-22 00:34:33.464 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:34:33.464 +08:00 [INF] Context是否为null: False
2025-10-22 00:34:33.464 +08:00 [INF] 测试数据库连接...
2025-10-22 00:34:33.465 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.465 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.465 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:34:33.466 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:34:33.469 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:34:33.472 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:33.472 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:33.472 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.473 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.473 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:34:33.474 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:34:33.475 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:33.475 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.475 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.475 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:34:33.477 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:34:33.491 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:34:33.494 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:33.494 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:33.494 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.495 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.496 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:34:33.498 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:34:33.502 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:34:33.525 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:33.526 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.527 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.527 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:34:33.527 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 00:34:33.527 +08:00 [INF] 用户是否激活: True
2025-10-22 00:34:33.527 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:34:33.527 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:34:33.529 +08:00 [INF] 开始验证密码
2025-10-22 00:34:33.529 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:34:33.529 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:34:33.529 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 00:34:33.529 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 00:34:33.529 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:34:33.529 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 00:34:33.709 +08:00 [INF] 密码验证结果: True
2025-10-22 00:34:33.709 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:34:33.710 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:34:33.711 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:34:33.716 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:34:33.720 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:34:33.723 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:34:33.730 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.730 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.731 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:34:33.733 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:34:33.751 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:33.751 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:33.751 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:34:33.752 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:34:33.754 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:33.755 +08:00 [DBG] Committing transaction.
2025-10-22 00:34:33.760 +08:00 [DBG] Committed transaction.
2025-10-22 00:34:33.760 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.763 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.764 +08:00 [DBG] Disposing transaction.
2025-10-22 00:34:33.767 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:34:33.768 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:34:33.768 +08:00 [INF] 用户信息更新完成
2025-10-22 00:34:33.768 +08:00 [INF] 用户登录成功 - admin
2025-10-22 00:34:33.768 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:34:33.768 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:34:33.768 +08:00 [INF] 成功: True
2025-10-22 00:34:33.768 +08:00 [INF] 消息: 登录成功
2025-10-22 00:34:33.768 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:34:33.768 +08:00 [INF] 用户 admin 登录成功
2025-10-22 00:34:33.770 +08:00 [INF] 上次登录时间: 2025-10-22 00:32:13
2025-10-22 00:34:33.770 +08:00 [INF] 触发登录成功事件
2025-10-22 00:34:33.770 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:34:33.771 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 00:34:33.771 +08:00 [INF] 用户ID: 1
2025-10-22 00:34:33.771 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:34:33.783 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:34:33.783 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:34:33.793 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:34:33.795 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:34:33.796 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:33.796 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:33.796 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.796 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.796 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:34:33.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:34:33.798 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:34:33.805 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:33.805 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.806 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.813 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:34:33.813 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:34:33.813 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 00:34:33.813 +08:00 [INF] 用户ID: 1
2025-10-22 00:34:33.813 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:34:33.813 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 00:34:33.813 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:34:33.813 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:34:33.814 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:34:33.816 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:34:33.817 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:34:33.817 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:34:33.817 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.817 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.817 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:34:33.818 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:34:33.821 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:34:33.831 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:34:33.831 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:34:33.832 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:34:33.833 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:34:33.860 +08:00 [INF] 所有页面加载完成
2025-10-22 00:34:33.861 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:34:33.861 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 00:34:33.861 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:34:33.861 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:34:33.861 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:34:33.861 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:34:33.861 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:34:33.861 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:34:33.861 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:34:33.861 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:34:33.861 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:34:33.861 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:34:33.861 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:34:33.871 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:34:33.886 +08:00 [INF] 关闭登录窗口
2025-10-22 00:34:33.890 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:34:33.936 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:34:48.386 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:34:48.439 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 00:34:48.509 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:34:49.524 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:34:49.610 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:38:38.107 +08:00 [DBG] Hosting starting
2025-10-22 00:38:38.126 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:38:38.127 +08:00 [INF] Hosting environment: Production
2025-10-22 00:38:38.128 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:38:38.128 +08:00 [DBG] Hosting started
2025-10-22 00:38:38.160 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:38:38.288 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:38:38.301 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:38:38.361 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:38:38.361 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:38:38.383 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:38:38.494 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:38:38.523 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.527 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.532 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.541 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:38:38.546 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (4ms).
2025-10-22 00:38:38.548 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.551 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.555 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.566 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.568 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.569 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.571 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.572 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.572 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:38:38.572 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:38:38.572 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.572 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.572 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.574 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.574 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.579 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:38.579 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:38.579 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.579 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.579 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:38:38.581 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:38:38.582 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:38.582 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.583 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.590 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:38:38.592 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.592 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.592 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.592 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:38:38.592 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:38:38.592 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.593 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.593 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.594 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.594 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.595 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.595 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.595 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.595 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:38:38.595 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:38:38.595 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.595 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.596 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.597 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:38:38.597 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.597 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.597 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:38.597 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:38.597 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.598 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.598 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:38:38.599 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:38:38.599 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:38.599 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.599 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.599 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:38:38.620 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:38:38.722 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:38:38.733 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:38.733 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:38.733 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.733 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.733 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:38:38.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:38:38.735 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:38.735 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.736 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.736 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:38:38.737 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:38:38.737 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:38.737 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:38.737 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.737 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.738 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:38:38.738 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:38:38.738 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:38.738 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.739 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.739 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:38:38.740 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:38:38.740 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:38.740 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:38.740 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.740 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.740 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:38:38.741 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:38:38.741 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:38.741 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:38.742 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:38.742 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:38:38.744 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:38:44.825 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:38:44.825 +08:00 [INF] 用户名: admin
2025-10-22 00:38:44.825 +08:00 [INF] 密码长度: 8
2025-10-22 00:38:44.825 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:38:44.825 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:38:44.827 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:38:44.827 +08:00 [INF] 接收到的用户名: admin
2025-10-22 00:38:44.827 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 00:38:44.827 +08:00 [INF] 开始查询用户
2025-10-22 00:38:44.827 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:38:44.827 +08:00 [INF] Context是否为null: False
2025-10-22 00:38:44.827 +08:00 [INF] 测试数据库连接...
2025-10-22 00:38:44.828 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:44.828 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:44.828 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:38:44.829 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:38:44.832 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:38:44.835 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:44.835 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:44.835 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:44.836 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:44.836 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:38:44.837 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:38:44.837 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:44.837 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:44.838 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:44.838 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:38:44.839 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:38:44.852 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:38:44.855 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:44.855 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:44.855 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:44.856 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:44.856 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:38:44.858 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:38:44.862 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:38:44.882 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:44.882 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:44.883 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:44.883 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:38:44.883 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 00:38:44.883 +08:00 [INF] 用户是否激活: True
2025-10-22 00:38:44.883 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:38:44.883 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:38:44.885 +08:00 [INF] 开始验证密码
2025-10-22 00:38:44.885 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:38:44.885 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:38:44.885 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 00:38:44.885 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 00:38:44.885 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:38:44.885 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 00:38:45.061 +08:00 [INF] 密码验证结果: True
2025-10-22 00:38:45.061 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:38:45.062 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:38:45.063 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:38:45.069 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:38:45.072 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:38:45.075 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:38:45.082 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:45.082 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:45.083 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:38:45.085 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:38:45.101 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:45.101 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:45.102 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:38:45.103 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:38:45.105 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:45.106 +08:00 [DBG] Committing transaction.
2025-10-22 00:38:45.112 +08:00 [DBG] Committed transaction.
2025-10-22 00:38:45.113 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:45.116 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:45.117 +08:00 [DBG] Disposing transaction.
2025-10-22 00:38:45.120 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:38:45.120 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:38:45.120 +08:00 [INF] 用户信息更新完成
2025-10-22 00:38:45.120 +08:00 [INF] 用户登录成功 - admin
2025-10-22 00:38:45.120 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:38:45.121 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:38:45.121 +08:00 [INF] 成功: True
2025-10-22 00:38:45.121 +08:00 [INF] 消息: 登录成功
2025-10-22 00:38:45.121 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:38:45.121 +08:00 [INF] 用户 admin 登录成功
2025-10-22 00:38:45.122 +08:00 [INF] 上次登录时间: 2025-10-22 00:34:33
2025-10-22 00:38:45.122 +08:00 [INF] 触发登录成功事件
2025-10-22 00:38:45.123 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:38:45.123 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 00:38:45.124 +08:00 [INF] 用户ID: 1
2025-10-22 00:38:45.124 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:38:45.135 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:38:45.135 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:38:45.145 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:38:45.147 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:38:45.147 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:45.147 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:45.147 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:45.147 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:45.147 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:38:45.149 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:38:45.149 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:38:45.156 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:45.156 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:45.157 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:45.164 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:38:45.164 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:38:45.164 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 00:38:45.164 +08:00 [INF] 用户ID: 1
2025-10-22 00:38:45.164 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:38:45.164 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 00:38:45.164 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:38:45.164 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:38:45.166 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:38:45.167 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:38:45.168 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:38:45.168 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:38:45.168 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:45.168 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:45.168 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:38:45.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:38:45.172 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:38:45.182 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:38:45.182 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:38:45.183 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:38:45.184 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:38:45.212 +08:00 [INF] 所有页面加载完成
2025-10-22 00:38:45.212 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:38:45.212 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 00:38:45.212 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:38:45.212 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:38:45.212 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:38:45.212 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:38:45.212 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:38:45.212 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:38:45.212 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:38:45.212 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:38:45.212 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:38:45.212 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:38:45.213 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:38:45.223 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:38:45.238 +08:00 [INF] 关闭登录窗口
2025-10-22 00:38:45.241 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:38:45.263 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:38:45.285 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:38:51.435 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:38:51.567 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 00:38:51.675 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:38:52.875 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:38:52.971 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:56:33.898 +08:00 [DBG] Hosting starting
2025-10-22 00:56:33.917 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 00:56:33.918 +08:00 [INF] Hosting environment: Production
2025-10-22 00:56:33.918 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 00:56:33.918 +08:00 [DBG] Hosting started
2025-10-22 00:56:33.951 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 00:56:34.082 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:56:34.095 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:56:34.154 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:56:34.154 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 00:56:34.177 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 00:56:34.287 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:56:34.314 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.317 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.322 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.330 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:56:34.333 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 00:56:34.335 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.337 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.340 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.350 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.351 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.352 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.354 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.354 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.354 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:56:34.354 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:56:34.354 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.354 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.354 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.356 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.356 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.356 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.360 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:34.360 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:34.360 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.361 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.361 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:56:34.362 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:56:34.363 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:34.363 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.364 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.371 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:56:34.372 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.372 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.372 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.372 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:56:34.372 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:56:34.372 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.373 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.373 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.374 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.374 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.374 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.374 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.374 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.374 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 00:56:34.374 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 00:56:34.374 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.375 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.375 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.375 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 00:56:34.376 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.376 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.376 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:34.376 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:34.376 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.376 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.376 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:56:34.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 00:56:34.377 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:34.377 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.378 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.378 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 00:56:34.398 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 00:56:34.501 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:56:34.511 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:34.511 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:34.511 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.512 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.512 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:56:34.514 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 00:56:34.514 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:34.514 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.515 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.515 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 00:56:34.517 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:56:34.517 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:34.517 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:34.517 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.517 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.517 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:56:34.518 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 00:56:34.518 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:34.518 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.519 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.519 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 00:56:34.520 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:56:34.520 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:34.520 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:34.520 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.520 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.520 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:56:34.521 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 00:56:34.521 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:34.521 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:34.522 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:34.522 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 00:56:34.524 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 00:56:44.868 +08:00 [INF] === 开始登录流程 ===
2025-10-22 00:56:44.869 +08:00 [INF] 用户名: admin
2025-10-22 00:56:44.869 +08:00 [INF] 密码长度: 8
2025-10-22 00:56:44.869 +08:00 [INF] AuthService是否为null: False
2025-10-22 00:56:44.869 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 00:56:44.871 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 00:56:44.871 +08:00 [INF] 接收到的用户名: admin
2025-10-22 00:56:44.871 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 00:56:44.871 +08:00 [INF] 开始查询用户
2025-10-22 00:56:44.871 +08:00 [INF] UserRepository是否为null: False
2025-10-22 00:56:44.871 +08:00 [INF] Context是否为null: False
2025-10-22 00:56:44.871 +08:00 [INF] 测试数据库连接...
2025-10-22 00:56:44.872 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:44.872 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:44.872 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 00:56:44.873 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 00:56:44.877 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:56:44.880 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:44.880 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:44.880 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:44.880 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:44.880 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:56:44.882 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 00:56:44.882 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:44.882 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:44.883 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:44.883 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 00:56:44.884 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 00:56:44.897 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 00:56:44.899 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:44.900 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:44.900 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:44.900 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:44.901 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:56:44.903 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 00:56:44.907 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:44.928 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:44.928 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:44.929 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:44.929 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 00:56:44.930 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 00:56:44.930 +08:00 [INF] 用户是否激活: True
2025-10-22 00:56:44.930 +08:00 [INF] 登录失败次数: 0
2025-10-22 00:56:44.930 +08:00 [INF] 检查账户锁定状态
2025-10-22 00:56:44.932 +08:00 [INF] 开始验证密码
2025-10-22 00:56:44.932 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 00:56:44.932 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 00:56:44.932 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 00:56:44.932 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 00:56:44.932 +08:00 [INF] 密码哈希长度: 60
2025-10-22 00:56:44.932 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 00:56:45.106 +08:00 [INF] 密码验证结果: True
2025-10-22 00:56:45.106 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 00:56:45.107 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 00:56:45.108 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 00:56:45.113 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 00:56:45.117 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:45.120 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 00:56:45.126 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:45.127 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:45.127 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 00:56:45.129 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 00:56:45.145 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:45.145 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:45.145 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:56:45.146 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 00:56:45.148 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:45.149 +08:00 [DBG] Committing transaction.
2025-10-22 00:56:45.153 +08:00 [DBG] Committed transaction.
2025-10-22 00:56:45.154 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:45.156 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:45.157 +08:00 [DBG] Disposing transaction.
2025-10-22 00:56:45.160 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:45.160 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 00:56:45.160 +08:00 [INF] 用户信息更新完成
2025-10-22 00:56:45.160 +08:00 [INF] 用户登录成功 - admin
2025-10-22 00:56:45.160 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 00:56:45.161 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 00:56:45.161 +08:00 [INF] 成功: True
2025-10-22 00:56:45.161 +08:00 [INF] 消息: 登录成功
2025-10-22 00:56:45.161 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:56:45.161 +08:00 [INF] 用户 admin 登录成功
2025-10-22 00:56:45.163 +08:00 [INF] 上次登录时间: 2025-10-22 00:38:45
2025-10-22 00:56:45.163 +08:00 [INF] 触发登录成功事件
2025-10-22 00:56:45.163 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 00:56:45.163 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 00:56:45.164 +08:00 [INF] 用户ID: 1
2025-10-22 00:56:45.164 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:56:45.176 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 00:56:45.176 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 00:56:45.186 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 00:56:45.188 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:56:45.188 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:45.188 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:45.188 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:45.188 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:45.188 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:56:45.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 00:56:45.190 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:45.197 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:45.197 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:45.198 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:45.205 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 00:56:45.205 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 00:56:45.205 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 00:56:45.205 +08:00 [INF] 用户ID: 1
2025-10-22 00:56:45.205 +08:00 [INF] 用户对象是否为null: False
2025-10-22 00:56:45.205 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 00:56:45.205 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 00:56:45.205 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 00:56:45.207 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 00:56:45.208 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:56:45.208 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:45.208 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:45.208 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:45.209 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:45.209 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:56:45.210 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 00:56:45.212 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:45.223 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:45.223 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:45.224 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:45.224 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 00:56:45.254 +08:00 [INF] 所有页面加载完成
2025-10-22 00:56:45.254 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 00:56:45.255 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 00:56:45.255 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 00:56:45.255 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 00:56:45.255 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 00:56:45.255 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 00:56:45.255 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 00:56:45.255 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 00:56:45.255 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 00:56:45.255 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 00:56:45.255 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 00:56:45.255 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 00:56:45.255 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 00:56:45.266 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:45.282 +08:00 [INF] 关闭登录窗口
2025-10-22 00:56:45.287 +08:00 [INF] === 登录流程结束 ===
2025-10-22 00:56:45.319 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:48.167 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:48.198 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:49.413 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:49.498 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 00:56:49.505 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 00:56:49.505 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 00:56:49.526 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        ORDER BY e.StartTime DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:56:49.526 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:49.526 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:49.526 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:49.527 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:49.527 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 00:56:49.528 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 00:56:49.530 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:49.540 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:49.542 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:49.542 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:49.542 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:49.542 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:49.542 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:56:49.542 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:49.542 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:49.543 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:49.566 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:51.407 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:56:51.408 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:56:51.408 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:51.408 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:51.408 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 00:56:51.410 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 00:56:51.410 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:56:51.410 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:56:51.410 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:56:51.430 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:52.566 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:52.678 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:53.094 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:53.190 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:53.590 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:53.686 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:57.254 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:56:57.364 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:03.278 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:04.243 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:05.131 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:05.268 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:05.695 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:05.794 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:07.186 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-10-22 00:57:07.188 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
        SELECT u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Users AS u), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:57:07.188 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:57:07.188 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:57:07.188 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:57:07.188 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:57:07.188 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-22 00:57:07.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-22 00:57:07.190 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 00:57:07.190 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:57:07.190 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:57:07.190 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:57:07.229 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:07.286 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:11.509 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:11.605 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:24.363 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:24.442 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:24.456 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:24.853 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:25.092 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:25.299 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:25.761 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:25.849 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:27.075 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:27.194 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:27.461 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:27.574 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:27.852 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:28.060 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:32.362 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:42.688 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:57:45.502 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:01.761 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:04.784 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:58:04.784 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:58:04.784 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:58:04.784 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:58:04.784 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-22 00:58:04.786 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
2025-10-22 00:58:04.786 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:58:04.786 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:58:04.786 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:58:04.797 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:04.861 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:05.852 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:05.937 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:13.954 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:14.049 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:15.162 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:15.190 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:15.343 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:15.889 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Where(u => (int)u.Role == (int)__role_0)'
2025-10-22 00:58:15.891 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
        SELECT u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Users AS u
        WHERE u.Role == @__role_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 00:58:15.891 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 00:58:15.891 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 00:58:15.891 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:58:15.892 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:58:15.892 +08:00 [DBG] Executing DbCommand [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Role" = @__role_0
2025-10-22 00:58:15.893 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Role" = @__role_0
2025-10-22 00:58:15.893 +08:00 [DBG] A data reader was disposed.
2025-10-22 00:58:15.893 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 00:58:15.894 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 00:58:15.907 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:16.337 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:16.395 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:17.233 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:17.312 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:56.959 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:57.024 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 00:58:57.091 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:57.848 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 00:58:57.900 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 21:03:50.656 +08:00 [DBG] Hosting starting
2025-10-22 21:03:50.676 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 21:03:50.677 +08:00 [INF] Hosting environment: Production
2025-10-22 21:03:50.677 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 21:03:50.677 +08:00 [DBG] Hosting started
2025-10-22 21:03:50.712 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 21:03:50.857 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:03:50.870 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:03:50.930 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:03:50.930 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:03:50.953 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 21:03:51.066 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 21:03:51.094 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.097 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.102 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.111 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:03:51.114 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 21:03:51.116 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.118 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.121 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.130 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.132 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.133 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.135 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.135 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.135 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:03:51.135 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:03:51.135 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.135 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.135 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.137 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.137 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.137 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.142 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:03:51.142 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:03:51.142 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.142 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.143 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:03:51.144 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:03:51.145 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:03:51.145 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.146 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.153 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:03:51.155 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.155 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.155 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.155 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:03:51.155 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:03:51.155 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.156 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.156 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.157 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.157 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.158 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.158 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.158 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.158 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:03:51.158 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:03:51.158 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.158 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.158 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.159 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:03:51.159 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.159 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.160 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:03:51.160 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:03:51.160 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.160 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.160 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:03:51.161 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:03:51.161 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:03:51.161 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.161 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.161 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:03:51.183 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 21:03:51.302 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:03:51.313 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:03:51.313 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:03:51.313 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.313 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.314 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:03:51.315 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:03:51.315 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:03:51.315 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.316 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.316 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 21:03:51.317 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:03:51.318 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:03:51.318 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:03:51.318 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.318 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.318 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:03:51.319 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:03:51.319 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:03:51.319 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.319 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.320 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 21:03:51.320 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:03:51.320 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:03:51.320 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:03:51.320 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.321 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.321 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:03:51.321 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:03:51.322 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:03:51.322 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:03:51.322 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:03:51.323 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 21:03:51.324 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 21:04:50.978 +08:00 [INF] === 开始登录流程 ===
2025-10-22 21:04:50.979 +08:00 [INF] 用户名: admin
2025-10-22 21:04:50.979 +08:00 [INF] 密码长度: 8
2025-10-22 21:04:50.979 +08:00 [INF] AuthService是否为null: False
2025-10-22 21:04:50.979 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 21:04:50.981 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 21:04:50.981 +08:00 [INF] 接收到的用户名: admin
2025-10-22 21:04:50.981 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 21:04:50.981 +08:00 [INF] 开始查询用户
2025-10-22 21:04:50.981 +08:00 [INF] UserRepository是否为null: False
2025-10-22 21:04:50.981 +08:00 [INF] Context是否为null: False
2025-10-22 21:04:50.981 +08:00 [INF] 测试数据库连接...
2025-10-22 21:04:50.981 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:50.982 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:50.982 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 21:04:50.983 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 21:04:50.986 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:04:50.989 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:50.989 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:50.989 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:50.989 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:50.989 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 21:04:50.991 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 21:04:50.991 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:50.991 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:50.992 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:50.992 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 21:04:50.993 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 21:04:51.005 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:04:51.008 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:51.008 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:51.008 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.009 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.009 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 21:04:51.011 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 21:04:51.015 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:51.035 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:51.035 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.036 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.036 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 21:04:51.036 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 21:04:51.036 +08:00 [INF] 用户是否激活: True
2025-10-22 21:04:51.036 +08:00 [INF] 登录失败次数: 0
2025-10-22 21:04:51.036 +08:00 [INF] 检查账户锁定状态
2025-10-22 21:04:51.038 +08:00 [INF] 开始验证密码
2025-10-22 21:04:51.038 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 21:04:51.038 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 21:04:51.038 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 21:04:51.038 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 21:04:51.038 +08:00 [INF] 密码哈希长度: 60
2025-10-22 21:04:51.038 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 21:04:51.212 +08:00 [INF] 密码验证结果: True
2025-10-22 21:04:51.212 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 21:04:51.213 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 21:04:51.214 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 21:04:51.219 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 21:04:51.223 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:51.227 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 21:04:51.233 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.234 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.234 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 21:04:51.236 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 21:04:51.252 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:51.252 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:51.252 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 21:04:51.253 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 21:04:51.255 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:51.256 +08:00 [DBG] Committing transaction.
2025-10-22 21:04:51.261 +08:00 [DBG] Committed transaction.
2025-10-22 21:04:51.262 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.265 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.266 +08:00 [DBG] Disposing transaction.
2025-10-22 21:04:51.269 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:51.269 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 21:04:51.269 +08:00 [INF] 用户信息更新完成
2025-10-22 21:04:51.270 +08:00 [INF] 用户登录成功 - admin
2025-10-22 21:04:51.270 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 21:04:51.270 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 21:04:51.270 +08:00 [INF] 成功: True
2025-10-22 21:04:51.270 +08:00 [INF] 消息: 登录成功
2025-10-22 21:04:51.270 +08:00 [INF] 用户对象是否为null: False
2025-10-22 21:04:51.270 +08:00 [INF] 用户 admin 登录成功
2025-10-22 21:04:51.272 +08:00 [INF] 上次登录时间: 2025-10-22 00:56:45
2025-10-22 21:04:51.272 +08:00 [INF] 触发登录成功事件
2025-10-22 21:04:51.272 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 21:04:51.272 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 21:04:51.273 +08:00 [INF] 用户ID: 1
2025-10-22 21:04:51.273 +08:00 [INF] 用户对象是否为null: False
2025-10-22 21:04:51.285 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 21:04:51.285 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 21:04:51.295 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 21:04:51.297 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:04:51.297 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:51.297 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:51.297 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.297 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.297 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 21:04:51.299 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 21:04:51.299 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:51.306 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:51.306 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.307 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.313 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 21:04:51.314 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 21:04:51.314 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 21:04:51.314 +08:00 [INF] 用户ID: 1
2025-10-22 21:04:51.314 +08:00 [INF] 用户对象是否为null: False
2025-10-22 21:04:51.314 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 21:04:51.314 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 21:04:51.314 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 21:04:51.315 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 21:04:51.317 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:04:51.317 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:51.317 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:51.317 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.317 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.317 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:04:51.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:04:51.321 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:51.331 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:51.331 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:51.332 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:51.333 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 21:04:51.359 +08:00 [INF] 所有页面加载完成
2025-10-22 21:04:51.360 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 21:04:51.360 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 21:04:51.360 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 21:04:51.360 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 21:04:51.360 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 21:04:51.360 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 21:04:51.360 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 21:04:51.360 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 21:04:51.360 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 21:04:51.360 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 21:04:51.360 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 21:04:51.360 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 21:04:51.360 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 21:04:51.369 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:51.381 +08:00 [INF] 关闭登录窗口
2025-10-22 21:04:51.384 +08:00 [INF] === 登录流程结束 ===
2025-10-22 21:04:51.410 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:52.598 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:52.637 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:53.385 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 21:04:53.392 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 21:04:53.392 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 21:04:53.408 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        ORDER BY e.StartTime DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:04:53.409 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:53.409 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:53.409 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:53.409 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:53.409 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 21:04:53.411 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 21:04:53.413 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:53.423 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:53.424 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:53.424 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:53.424 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:53.424 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:53.424 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:53.424 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:53.425 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:53.425 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:53.426 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:53.426 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:53.426 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:53.427 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:53.427 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:04:53.428 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:04:53.428 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:53.428 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:53.428 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:53.447 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:53.469 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:55.382 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:55.830 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:56.468 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:56.949 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:04:57.067 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .Include(r => r.User)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 21:04:57.067 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 21:04:57.068 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 21:04:57.068 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 21:04:57.068 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 21:04:57.068 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 21:04:57.078 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 21:04:57.098 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t.UserId0, t.CreatedAt1, t.Email, t.IsActive0, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt, u.UserId AS UserId0, u.CreatedAt AS CreatedAt1, u.Email, u.IsActive AS IsActive0, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                INNER JOIN Users AS u ON e.UserId == u.UserId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, t.UserId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:04:57.098 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:57.098 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:57.098 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:57.099 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:57.099 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 21:04:57.101 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 21:04:57.103 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.111 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.121 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.121 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.121 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.121 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.122 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:04:57.124 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:57.125 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:57.125 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:57.127 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .Where(ar => ar.RecordId == __recordId_0)
    .OrderBy(ar => ar.Question.QuestionId)'
2025-10-22 21:04:57.127 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 21:04:57.127 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 21:04:57.131 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content, q0.IsCorrect, q0.OptionLabel, q0.OrderIndex, q0.QuestionId
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
        WHERE a.RecordId == @__recordId_0
        ORDER BY q.QuestionId ASC, a.AnswerId ASC, q0.OptionId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:04:57.132 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:04:57.132 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:04:57.132 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:57.132 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:57.132 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 21:04:57.133 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 21:04:57.134 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:04:57.134 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:04:57.134 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:04:57.151 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:05:31.595 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:05:32.617 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:05:33.005 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:05:33.275 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:05:35.199 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:14:06.070 +08:00 [DBG] Hosting starting
2025-10-22 21:14:06.089 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 21:14:06.090 +08:00 [INF] Hosting environment: Production
2025-10-22 21:14:06.091 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 21:14:06.091 +08:00 [DBG] Hosting started
2025-10-22 21:14:06.123 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 21:14:06.261 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:06.274 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:06.334 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:06.334 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:06.357 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 21:14:06.469 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 21:14:06.496 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.499 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.504 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.512 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:06.515 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 21:14:06.517 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.518 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.522 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.531 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.533 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.533 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.535 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.535 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.535 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:06.535 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:14:06.536 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.536 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.536 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.537 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.537 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.537 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.541 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:06.541 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:06.541 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.542 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.542 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:06.543 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:06.544 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:06.544 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.545 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.552 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:14:06.553 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.553 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.553 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.553 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:06.553 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:14:06.553 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.554 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.554 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.555 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.555 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.555 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.555 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.555 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.555 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:06.555 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:14:06.555 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.556 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.556 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.556 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:06.556 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.557 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.557 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:06.557 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:06.557 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.557 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.558 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:06.558 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:06.558 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:06.558 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.559 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.559 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:14:06.579 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 21:14:06.679 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:14:06.688 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:06.689 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:06.689 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.689 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.689 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:14:06.690 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:14:06.691 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:06.691 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.691 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.692 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 21:14:06.692 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:14:06.692 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:06.693 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:06.693 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.693 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.693 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:14:06.694 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:14:06.694 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:06.694 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.694 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.694 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 21:14:06.695 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:14:06.695 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:06.695 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:06.695 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.695 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.695 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:14:06.696 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:14:06.696 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:06.696 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:06.697 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:06.697 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 21:14:06.698 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 21:14:47.656 +08:00 [DBG] Hosting starting
2025-10-22 21:14:47.674 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 21:14:47.675 +08:00 [INF] Hosting environment: Production
2025-10-22 21:14:47.675 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 21:14:47.676 +08:00 [DBG] Hosting started
2025-10-22 21:14:47.707 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 21:14:47.844 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:47.856 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:47.914 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:47.914 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:14:47.937 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 21:14:48.047 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 21:14:48.075 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.079 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.083 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.091 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:48.095 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 21:14:48.096 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.098 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.101 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.110 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.112 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.113 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.114 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.115 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.115 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:48.115 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:14:48.115 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.115 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.115 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.116 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.116 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.116 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.120 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:48.120 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:48.120 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.121 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.121 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:48.122 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:48.123 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:48.123 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.124 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.131 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:14:48.133 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.133 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.133 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.133 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:48.133 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:14:48.133 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.133 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.133 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.134 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.134 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.135 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.135 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.135 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.135 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:14:48.135 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:14:48.135 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.135 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.135 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.136 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:14:48.136 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.137 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.137 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:48.137 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:48.137 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.137 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.137 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:48.138 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:14:48.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:48.138 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.138 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.139 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:14:48.158 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 21:14:48.258 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:14:48.268 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:48.268 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:48.268 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.268 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.269 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:14:48.270 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:14:48.271 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:48.271 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.271 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.272 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 21:14:48.273 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:14:48.273 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:48.273 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:48.273 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.273 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.273 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:14:48.274 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:14:48.274 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:48.274 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.275 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.275 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 21:14:48.276 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:14:48.276 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:14:48.276 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:14:48.276 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.276 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.276 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:14:48.277 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:14:48.277 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:14:48.277 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:14:48.278 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:14:48.278 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 21:14:48.279 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 21:15:15.239 +08:00 [INF] === 开始登录流程 ===
2025-10-22 21:15:15.240 +08:00 [INF] 用户名: admin
2025-10-22 21:15:15.240 +08:00 [INF] 密码长度: 8
2025-10-22 21:15:15.240 +08:00 [INF] AuthService是否为null: False
2025-10-22 21:15:15.240 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 21:15:15.242 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 21:15:15.242 +08:00 [INF] 接收到的用户名: admin
2025-10-22 21:15:15.242 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 21:15:15.242 +08:00 [INF] 开始查询用户
2025-10-22 21:15:15.242 +08:00 [INF] UserRepository是否为null: False
2025-10-22 21:15:15.242 +08:00 [INF] Context是否为null: False
2025-10-22 21:15:15.242 +08:00 [INF] 测试数据库连接...
2025-10-22 21:15:15.243 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.243 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.243 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 21:15:15.244 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 21:15:15.247 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:15:15.250 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:15.250 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:15.250 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.251 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.251 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 21:15:15.252 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 21:15:15.253 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:15.253 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.253 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.253 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 21:15:15.254 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 21:15:15.267 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:15:15.270 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:15.270 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:15.270 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.271 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.271 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 21:15:15.273 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 21:15:15.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:15.297 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:15.297 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.298 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.298 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 21:15:15.298 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 21:15:15.298 +08:00 [INF] 用户是否激活: True
2025-10-22 21:15:15.298 +08:00 [INF] 登录失败次数: 0
2025-10-22 21:15:15.299 +08:00 [INF] 检查账户锁定状态
2025-10-22 21:15:15.300 +08:00 [INF] 开始验证密码
2025-10-22 21:15:15.300 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 21:15:15.300 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 21:15:15.300 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 21:15:15.300 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 21:15:15.300 +08:00 [INF] 密码哈希长度: 60
2025-10-22 21:15:15.300 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 21:15:15.476 +08:00 [INF] 密码验证结果: True
2025-10-22 21:15:15.476 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 21:15:15.477 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 21:15:15.478 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 21:15:15.491 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 21:15:15.494 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:15.497 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 21:15:15.504 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.504 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.504 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 21:15:15.506 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 21:15:15.522 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:15.522 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:15.522 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 21:15:15.523 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 21:15:15.525 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:15.526 +08:00 [DBG] Committing transaction.
2025-10-22 21:15:15.530 +08:00 [DBG] Committed transaction.
2025-10-22 21:15:15.531 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.533 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.534 +08:00 [DBG] Disposing transaction.
2025-10-22 21:15:15.537 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:15.537 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 21:15:15.537 +08:00 [INF] 用户信息更新完成
2025-10-22 21:15:15.537 +08:00 [INF] 用户登录成功 - admin
2025-10-22 21:15:15.537 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 21:15:15.538 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 21:15:15.538 +08:00 [INF] 成功: True
2025-10-22 21:15:15.538 +08:00 [INF] 消息: 登录成功
2025-10-22 21:15:15.538 +08:00 [INF] 用户对象是否为null: False
2025-10-22 21:15:15.538 +08:00 [INF] 用户 admin 登录成功
2025-10-22 21:15:15.539 +08:00 [INF] 上次登录时间: 2025-10-22 21:04:51
2025-10-22 21:15:15.539 +08:00 [INF] 触发登录成功事件
2025-10-22 21:15:15.540 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 21:15:15.540 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 21:15:15.541 +08:00 [INF] 用户ID: 1
2025-10-22 21:15:15.541 +08:00 [INF] 用户对象是否为null: False
2025-10-22 21:15:15.552 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 21:15:15.552 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 21:15:15.562 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 21:15:15.564 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:15:15.564 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:15.564 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:15.564 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.564 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.564 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 21:15:15.566 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 21:15:15.566 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:15.573 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:15.573 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.573 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.580 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 21:15:15.581 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 21:15:15.581 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 21:15:15.581 +08:00 [INF] 用户ID: 1
2025-10-22 21:15:15.581 +08:00 [INF] 用户对象是否为null: False
2025-10-22 21:15:15.581 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 21:15:15.581 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 21:15:15.581 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 21:15:15.582 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 21:15:15.583 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:15:15.584 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:15.584 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:15.584 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.584 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.584 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:15:15.585 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:15:15.588 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:15.597 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:15.597 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:15.598 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:15.599 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 21:15:15.627 +08:00 [INF] 所有页面加载完成
2025-10-22 21:15:15.627 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 21:15:15.627 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 21:15:15.627 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 21:15:15.627 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 21:15:15.627 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 21:15:15.627 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 21:15:15.627 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 21:15:15.627 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 21:15:15.627 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 21:15:15.627 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 21:15:15.627 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 21:15:15.627 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 21:15:15.627 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 21:15:15.636 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:15.650 +08:00 [INF] 关闭登录窗口
2025-10-22 21:15:15.653 +08:00 [INF] === 登录流程结束 ===
2025-10-22 21:15:15.674 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:15.685 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:16.939 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 21:15:16.945 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 21:15:16.945 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 21:15:16.961 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        ORDER BY e.StartTime DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:15:16.962 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:16.962 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:16.962 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:16.962 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:16.962 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 21:15:16.964 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 21:15:16.966 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:16.975 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:16.977 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:16.977 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:16.977 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:16.977 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:16.977 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:16.977 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:16.977 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:16.978 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:16.978 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:16.978 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:16.978 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:16.979 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:16.979 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:15:16.980 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 21:15:16.980 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:16.980 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:16.980 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:17.012 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:17.027 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:18.513 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:18.598 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .Include(r => r.User)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 21:15:18.599 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 21:15:18.599 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 21:15:18.599 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 21:15:18.600 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 21:15:18.600 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 21:15:18.609 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 21:15:18.629 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t.UserId0, t.CreatedAt1, t.Email, t.IsActive0, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt, u.UserId AS UserId0, u.CreatedAt AS CreatedAt1, u.Email, u.IsActive AS IsActive0, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                INNER JOIN Users AS u ON e.UserId == u.UserId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, t.UserId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:15:18.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:18.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:18.630 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:18.630 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:18.630 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 21:15:18.632 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 21:15:18.634 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.642 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.651 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.651 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.651 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.651 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.652 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 21:15:18.654 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:18.655 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:18.655 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:18.657 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .Where(ar => ar.RecordId == __recordId_0)
    .OrderBy(ar => ar.Question.QuestionId)'
2025-10-22 21:15:18.657 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 21:15:18.657 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 21:15:18.662 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content, q0.IsCorrect, q0.OptionLabel, q0.OrderIndex, q0.QuestionId
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
        WHERE a.RecordId == @__recordId_0
        ORDER BY q.QuestionId ASC, a.AnswerId ASC, q0.OptionId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 21:15:18.662 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:15:18.662 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:15:18.662 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:18.662 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:18.662 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 21:15:18.663 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 21:15:18.663 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:15:18.663 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:15:18.664 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:15:18.683 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:26.673 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:28.830 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:28.940 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:29.471 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:29.640 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:30.263 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:30.335 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 21:15:30.449 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:31.520 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 21:15:31.598 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 21:35:53.073 +08:00 [DBG] Hosting starting
2025-10-22 21:35:53.092 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 21:35:53.093 +08:00 [INF] Hosting environment: Production
2025-10-22 21:35:53.093 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 21:35:53.093 +08:00 [DBG] Hosting started
2025-10-22 21:35:53.125 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 21:35:53.261 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:35:53.273 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:35:53.331 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:35:53.332 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 21:35:53.354 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 21:35:53.463 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 21:35:53.491 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.494 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.498 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.506 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:35:53.509 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 21:35:53.510 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.513 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.516 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.525 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.527 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.528 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.529 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.529 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.530 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:35:53.530 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:35:53.530 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.530 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.530 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.531 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.531 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.532 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.536 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:35:53.536 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:35:53.536 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.536 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.536 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:35:53.537 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:35:53.539 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:35:53.539 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.539 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.546 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:35:53.547 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.547 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.548 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.548 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:35:53.548 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:35:53.548 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.548 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.548 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.549 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.549 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.549 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.549 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.549 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.549 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 21:35:53.550 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 21:35:53.550 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.550 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.550 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.551 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 21:35:53.551 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.551 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.551 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:35:53.551 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:35:53.551 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.551 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.551 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:35:53.552 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 21:35:53.552 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:35:53.552 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.553 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.553 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 21:35:53.573 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 21:35:53.678 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:35:53.687 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:35:53.688 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:35:53.688 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.688 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.688 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:35:53.689 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 21:35:53.690 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:35:53.690 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.690 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.691 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 21:35:53.691 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:35:53.691 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:35:53.691 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:35:53.691 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.692 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.692 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:35:53.693 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 21:35:53.693 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:35:53.693 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.694 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.694 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 21:35:53.695 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 21:35:53.695 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 21:35:53.695 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 21:35:53.695 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.695 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.695 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:35:53.696 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 21:35:53.696 +08:00 [DBG] A data reader was disposed.
2025-10-22 21:35:53.696 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 21:35:53.696 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 21:35:53.697 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 21:35:53.698 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 22:34:51.790 +08:00 [INF] === 开始登录流程 ===
2025-10-22 22:34:51.790 +08:00 [INF] 用户名: admin
2025-10-22 22:34:51.790 +08:00 [INF] 密码长度: 8
2025-10-22 22:34:51.790 +08:00 [INF] AuthService是否为null: False
2025-10-22 22:34:51.790 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 22:34:51.792 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 22:34:51.792 +08:00 [INF] 接收到的用户名: admin
2025-10-22 22:34:51.792 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 22:34:51.792 +08:00 [INF] 开始查询用户
2025-10-22 22:34:51.792 +08:00 [INF] UserRepository是否为null: False
2025-10-22 22:34:51.792 +08:00 [INF] Context是否为null: False
2025-10-22 22:34:51.792 +08:00 [INF] 测试数据库连接...
2025-10-22 22:34:51.793 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:51.793 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:51.793 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 22:34:51.794 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 22:34:51.797 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:34:51.800 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:51.800 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:51.800 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:51.801 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:51.801 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 22:34:51.802 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 22:34:51.802 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:51.802 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:51.803 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:51.803 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 22:34:51.804 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 22:34:51.816 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:34:51.819 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:51.819 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:51.820 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:51.820 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:51.820 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 22:34:51.822 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 22:34:51.825 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:51.845 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:51.845 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:51.846 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:51.846 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 22:34:51.846 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 22:34:51.846 +08:00 [INF] 用户是否激活: True
2025-10-22 22:34:51.846 +08:00 [INF] 登录失败次数: 0
2025-10-22 22:34:51.846 +08:00 [INF] 检查账户锁定状态
2025-10-22 22:34:51.848 +08:00 [INF] 开始验证密码
2025-10-22 22:34:51.848 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 22:34:51.848 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 22:34:51.848 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 22:34:51.848 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 22:34:51.848 +08:00 [INF] 密码哈希长度: 60
2025-10-22 22:34:51.848 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 22:34:52.021 +08:00 [INF] 密码验证结果: True
2025-10-22 22:34:52.021 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 22:34:52.023 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:34:52.023 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:34:52.029 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:34:52.032 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:52.035 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:34:52.041 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:52.042 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:52.042 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:34:52.044 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:34:52.059 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:52.059 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:52.059 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 22:34:52.060 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 22:34:52.062 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:52.063 +08:00 [DBG] Committing transaction.
2025-10-22 22:34:52.068 +08:00 [DBG] Committed transaction.
2025-10-22 22:34:52.068 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:52.071 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:52.072 +08:00 [DBG] Disposing transaction.
2025-10-22 22:34:52.075 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:52.075 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:34:52.075 +08:00 [INF] 用户信息更新完成
2025-10-22 22:34:52.075 +08:00 [INF] 用户登录成功 - admin
2025-10-22 22:34:52.075 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 22:34:52.076 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 22:34:52.076 +08:00 [INF] 成功: True
2025-10-22 22:34:52.076 +08:00 [INF] 消息: 登录成功
2025-10-22 22:34:52.076 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:34:52.076 +08:00 [INF] 用户 admin 登录成功
2025-10-22 22:34:52.077 +08:00 [INF] 上次登录时间: 2025-10-22 21:15:15
2025-10-22 22:34:52.077 +08:00 [INF] 触发登录成功事件
2025-10-22 22:34:52.078 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 22:34:52.078 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 22:34:52.078 +08:00 [INF] 用户ID: 1
2025-10-22 22:34:52.078 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:34:52.090 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 22:34:52.090 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 22:34:52.099 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 22:34:52.101 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:34:52.101 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:52.101 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:52.101 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:52.102 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:52.102 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 22:34:52.103 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 22:34:52.103 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:52.110 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:52.110 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:52.111 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:52.118 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 22:34:52.118 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 22:34:52.118 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 22:34:52.118 +08:00 [INF] 用户ID: 1
2025-10-22 22:34:52.118 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:34:52.118 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 22:34:52.118 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 22:34:52.118 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 22:34:52.119 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 22:34:52.121 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:34:52.121 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:52.121 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:52.121 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:52.121 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:52.121 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:34:52.122 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:34:52.125 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:52.135 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:52.135 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:52.135 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:52.136 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 22:34:52.162 +08:00 [INF] 所有页面加载完成
2025-10-22 22:34:52.163 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 22:34:52.163 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 22:34:52.163 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 22:34:52.163 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 22:34:52.163 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 22:34:52.163 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 22:34:52.163 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 22:34:52.163 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 22:34:52.163 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 22:34:52.163 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 22:34:52.163 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 22:34:52.163 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 22:34:52.163 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 22:34:52.172 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:34:52.187 +08:00 [INF] 关闭登录窗口
2025-10-22 22:34:52.191 +08:00 [INF] === 登录流程结束 ===
2025-10-22 22:34:52.214 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:34:52.237 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:34:53.139 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 22:34:53.145 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 22:34:53.146 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:34:53.162 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        ORDER BY e.StartTime DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:34:53.163 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:53.163 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:53.163 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:53.163 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:53.164 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 22:34:53.165 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
ORDER BY "e"."StartTime" DESC
2025-10-22 22:34:53.167 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:53.176 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:53.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:53.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:53.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:53.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:53.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:53.178 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:53.178 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:53.179 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:53.180 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:53.180 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:53.180 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:53.180 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:53.180 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:34:53.181 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:34:53.181 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:53.181 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:53.182 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:53.230 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:34:54.826 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:34:54.922 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .Include(r => r.User)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 22:34:54.923 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:34:54.923 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 22:34:54.923 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 22:34:54.924 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:34:54.924 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 22:34:54.933 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 22:34:54.954 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t.UserId0, t.CreatedAt1, t.Email, t.IsActive0, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt, u.UserId AS UserId0, u.CreatedAt AS CreatedAt1, u.Email, u.IsActive AS IsActive0, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                INNER JOIN Users AS u ON e.UserId == u.UserId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, t.UserId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:34:54.954 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:54.954 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:54.954 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:54.955 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:54.955 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:34:54.956 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:34:54.959 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.966 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.976 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.976 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.976 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.976 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.977 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:34:54.979 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:54.979 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:54.980 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:54.982 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .Where(ar => ar.RecordId == __recordId_0)
    .OrderBy(ar => ar.Question.QuestionId)'
2025-10-22 22:34:54.982 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:34:54.982 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 22:34:54.987 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content, q0.IsCorrect, q0.OptionLabel, q0.OrderIndex, q0.QuestionId
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
        WHERE a.RecordId == @__recordId_0
        ORDER BY q.QuestionId ASC, a.AnswerId ASC, q0.OptionId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:34:54.987 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:34:54.987 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:34:54.987 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:54.987 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:54.987 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:34:54.988 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:34:54.989 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:34:54.989 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:34:54.989 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:34:55.027 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:35:18.997 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:35:22.298 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:35:23.391 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:35:23.470 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 22:35:23.801 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:35:25.174 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:35:25.225 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 22:43:03.315 +08:00 [DBG] Hosting starting
2025-10-22 22:43:03.334 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 22:43:03.335 +08:00 [INF] Hosting environment: Production
2025-10-22 22:43:03.335 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 22:43:03.335 +08:00 [DBG] Hosting started
2025-10-22 22:43:03.370 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 22:43:03.501 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:43:03.516 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:43:03.580 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:43:03.581 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:43:03.604 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 22:43:03.716 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 22:43:03.745 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.748 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.752 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.762 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:43:03.766 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (4ms).
2025-10-22 22:43:03.768 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.771 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.775 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.785 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.787 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.788 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.789 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.790 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.790 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:43:03.790 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 22:43:03.790 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.790 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.790 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.791 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.791 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.791 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.795 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:43:03.796 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:43:03.796 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.796 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.796 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:43:03.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:43:03.798 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:43:03.798 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.799 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.806 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 22:43:03.807 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.807 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.807 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:43:03.807 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 22:43:03.807 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.808 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.808 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.808 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.809 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.809 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.809 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.809 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:43:03.809 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 22:43:03.809 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.810 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.810 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.811 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:43:03.811 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.811 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.811 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:43:03.811 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:43:03.811 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.811 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.811 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:43:03.812 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:43:03.812 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:43:03.812 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.813 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.813 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 22:43:03.833 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 22:43:03.933 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:43:03.943 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:43:03.943 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:43:03.943 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.944 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.944 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 22:43:03.945 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 22:43:03.945 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:43:03.945 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.946 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.946 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 22:43:03.947 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:43:03.947 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:43:03.948 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:43:03.948 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.948 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.948 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 22:43:03.949 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 22:43:03.949 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:43:03.949 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.949 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.949 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 22:43:03.950 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:43:03.950 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:43:03.950 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:43:03.950 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.951 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.951 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 22:43:03.951 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 22:43:03.951 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:43:03.951 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:43:03.952 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:43:03.953 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 22:43:03.954 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 22:44:21.673 +08:00 [INF] === 开始登录流程 ===
2025-10-22 22:44:21.673 +08:00 [INF] 用户名: admin
2025-10-22 22:44:21.673 +08:00 [INF] 密码长度: 8
2025-10-22 22:44:21.673 +08:00 [INF] AuthService是否为null: False
2025-10-22 22:44:21.673 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 22:44:21.675 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 22:44:21.675 +08:00 [INF] 接收到的用户名: admin
2025-10-22 22:44:21.675 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 22:44:21.675 +08:00 [INF] 开始查询用户
2025-10-22 22:44:21.675 +08:00 [INF] UserRepository是否为null: False
2025-10-22 22:44:21.675 +08:00 [INF] Context是否为null: False
2025-10-22 22:44:21.675 +08:00 [INF] 测试数据库连接...
2025-10-22 22:44:21.676 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.677 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.677 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 22:44:21.677 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 22:44:21.681 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:44:21.684 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:21.684 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:21.684 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.684 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.684 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 22:44:21.686 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 22:44:21.686 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:21.686 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.686 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.686 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 22:44:21.688 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 22:44:21.700 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:44:21.702 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:21.702 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:21.703 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.703 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.704 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 22:44:21.706 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 22:44:21.709 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:21.728 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:21.728 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.729 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.729 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 22:44:21.729 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 22:44:21.729 +08:00 [INF] 用户是否激活: True
2025-10-22 22:44:21.729 +08:00 [INF] 登录失败次数: 0
2025-10-22 22:44:21.729 +08:00 [INF] 检查账户锁定状态
2025-10-22 22:44:21.731 +08:00 [INF] 开始验证密码
2025-10-22 22:44:21.731 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 22:44:21.731 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 22:44:21.731 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 22:44:21.731 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 22:44:21.731 +08:00 [INF] 密码哈希长度: 60
2025-10-22 22:44:21.731 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 22:44:21.904 +08:00 [INF] 密码验证结果: True
2025-10-22 22:44:21.904 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 22:44:21.906 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:44:21.906 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:44:21.912 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:44:21.915 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:21.918 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:44:21.924 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.925 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.925 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:44:21.927 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:44:21.942 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:21.942 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:21.942 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 22:44:21.943 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 22:44:21.945 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:21.946 +08:00 [DBG] Committing transaction.
2025-10-22 22:44:21.951 +08:00 [DBG] Committed transaction.
2025-10-22 22:44:21.952 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.955 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.956 +08:00 [DBG] Disposing transaction.
2025-10-22 22:44:21.958 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:21.959 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:44:21.959 +08:00 [INF] 用户信息更新完成
2025-10-22 22:44:21.959 +08:00 [INF] 用户登录成功 - admin
2025-10-22 22:44:21.959 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 22:44:21.959 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 22:44:21.959 +08:00 [INF] 成功: True
2025-10-22 22:44:21.959 +08:00 [INF] 消息: 登录成功
2025-10-22 22:44:21.959 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:44:21.959 +08:00 [INF] 用户 admin 登录成功
2025-10-22 22:44:21.961 +08:00 [INF] 上次登录时间: 2025-10-22 22:34:52
2025-10-22 22:44:21.961 +08:00 [INF] 触发登录成功事件
2025-10-22 22:44:21.961 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 22:44:21.962 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 22:44:21.962 +08:00 [INF] 用户ID: 1
2025-10-22 22:44:21.962 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:44:21.975 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 22:44:21.975 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 22:44:21.984 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 22:44:21.986 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:44:21.986 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:21.986 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:21.986 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:21.986 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.986 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 22:44:21.987 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 22:44:21.988 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:21.994 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:21.995 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:21.995 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:22.002 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 22:44:22.002 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 22:44:22.002 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 22:44:22.002 +08:00 [INF] 用户ID: 1
2025-10-22 22:44:22.002 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:44:22.002 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 22:44:22.002 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 22:44:22.002 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 22:44:22.003 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 22:44:22.005 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:44:22.005 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:22.005 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:22.005 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:22.005 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:22.005 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:44:22.006 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:44:22.009 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:22.019 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:22.019 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:22.020 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:22.021 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 22:44:22.044 +08:00 [INF] 所有页面加载完成
2025-10-22 22:44:22.045 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 22:44:22.045 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 22:44:22.045 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 22:44:22.045 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 22:44:22.045 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 22:44:22.045 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 22:44:22.045 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 22:44:22.045 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 22:44:22.045 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 22:44:22.045 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 22:44:22.045 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 22:44:22.045 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 22:44:22.045 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 22:44:22.054 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:22.067 +08:00 [INF] 关闭登录窗口
2025-10-22 22:44:22.070 +08:00 [INF] === 登录流程结束 ===
2025-10-22 22:44:22.091 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:22.113 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:23.122 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .Include(er => er.AnswerRecords)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 22:44:23.128 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 22:44:23.128 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:44:23.129 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 22:44:23.159 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt, a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        LEFT JOIN AnswerRecords AS a ON e.RecordId == a.RecordId
        ORDER BY e.StartTime DESC, e.RecordId ASC, u.UserId ASC, e0.PaperId ASC, a.AnswerId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:44:23.160 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:23.160 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:23.160 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:23.161 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:23.161 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:44:23.162 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:44:23.164 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.175 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.183 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.183 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.183 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.183 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.183 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:23.184 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:23.184 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:23.185 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:23.186 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:23.186 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:23.186 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:23.186 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:23.186 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:44:23.188 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:44:23.188 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:23.188 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:23.188 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:23.218 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:25.203 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:25.313 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:26.326 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:26.996 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:27.093 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:29.803 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:30.435 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:30.555 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .Include(r => r.User)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 22:44:30.555 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:44:30.556 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 22:44:30.556 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 22:44:30.556 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:44:30.556 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 22:44:30.561 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 22:44:30.573 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t.UserId0, t.CreatedAt1, t.Email, t.IsActive0, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt, u.UserId AS UserId0, u.CreatedAt AS CreatedAt1, u.Email, u.IsActive AS IsActive0, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                INNER JOIN Users AS u ON e.UserId == u.UserId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, t.UserId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:44:30.573 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:30.573 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:30.573 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:30.574 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:30.574 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:44:30.576 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:44:30.578 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.587 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.587 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.588 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.590 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.590 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.590 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.590 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:44:30.591 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:30.591 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:30.592 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:30.593 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .Where(ar => ar.RecordId == __recordId_0)
    .OrderBy(ar => ar.Question.QuestionId)'
2025-10-22 22:44:30.593 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:44:30.594 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 22:44:30.598 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content, q0.IsCorrect, q0.OptionLabel, q0.OrderIndex, q0.QuestionId
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
        WHERE a.RecordId == @__recordId_0
        ORDER BY q.QuestionId ASC, a.AnswerId ASC, q0.OptionId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:44:30.598 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:30.598 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:30.598 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:30.598 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:30.598 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:44:30.599 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:44:30.600 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:30.600 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:30.600 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:30.621 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:32.544 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:33.648 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:33.648 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:33.648 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:33.649 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:33.649 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:44:33.651 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:44:33.651 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:33.651 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:33.651 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:33.652 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:44:33.652 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:44:33.652 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:33.652 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:33.652 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:44:33.653 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:44:33.653 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:44:33.653 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:44:33.654 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:44:33.708 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:42.560 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:43.891 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:44:43.967 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:19.852 +08:00 [DBG] Hosting starting
2025-10-22 22:56:19.871 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 22:56:19.872 +08:00 [INF] Hosting environment: Production
2025-10-22 22:56:19.872 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 22:56:19.872 +08:00 [DBG] Hosting started
2025-10-22 22:56:19.905 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 22:56:20.040 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:56:20.053 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:56:20.113 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:56:20.113 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 22:56:20.137 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 22:56:20.254 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 22:56:20.281 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.284 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.289 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.297 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:56:20.301 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 22:56:20.302 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.304 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.307 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.318 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.319 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.320 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.322 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.323 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.323 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:56:20.323 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 22:56:20.323 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.323 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.323 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.324 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.324 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.325 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.329 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:20.329 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:20.329 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.330 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.330 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:56:20.331 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:56:20.332 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:20.332 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.333 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.340 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 22:56:20.341 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.341 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.341 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.342 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:56:20.342 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 22:56:20.342 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.342 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.342 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.343 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.343 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.343 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.344 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.344 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.344 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 22:56:20.344 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 22:56:20.344 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.344 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.344 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.345 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 22:56:20.345 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.346 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.346 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:20.346 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:20.346 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.346 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.346 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:56:20.347 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 22:56:20.347 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:20.347 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.348 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.348 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 22:56:20.368 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 22:56:20.466 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:20.476 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:20.476 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:20.476 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.476 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.476 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 22:56:20.478 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 22:56:20.478 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:20.478 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.479 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.479 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 22:56:20.480 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:20.480 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:20.480 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:20.480 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.480 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.480 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 22:56:20.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 22:56:20.481 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:20.481 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.482 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.482 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 22:56:20.483 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:20.483 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:20.483 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:20.483 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.483 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.483 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 22:56:20.484 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 22:56:20.484 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:20.484 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:20.485 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:20.486 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 22:56:20.487 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 22:56:32.111 +08:00 [INF] === 开始登录流程 ===
2025-10-22 22:56:32.111 +08:00 [INF] 用户名: admin
2025-10-22 22:56:32.111 +08:00 [INF] 密码长度: 8
2025-10-22 22:56:32.111 +08:00 [INF] AuthService是否为null: False
2025-10-22 22:56:32.111 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 22:56:32.114 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 22:56:32.114 +08:00 [INF] 接收到的用户名: admin
2025-10-22 22:56:32.114 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 22:56:32.114 +08:00 [INF] 开始查询用户
2025-10-22 22:56:32.114 +08:00 [INF] UserRepository是否为null: False
2025-10-22 22:56:32.114 +08:00 [INF] Context是否为null: False
2025-10-22 22:56:32.114 +08:00 [INF] 测试数据库连接...
2025-10-22 22:56:32.115 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.115 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.116 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 22:56:32.116 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 22:56:32.120 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:32.123 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:32.123 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:32.123 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.124 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.124 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 22:56:32.125 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 22:56:32.125 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:32.125 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.126 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.126 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 22:56:32.127 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 22:56:32.143 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:32.147 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:32.147 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:32.148 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.148 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.149 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 22:56:32.152 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 22:56:32.156 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:32.182 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:32.182 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.183 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.183 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 22:56:32.183 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 22:56:32.183 +08:00 [INF] 用户是否激活: True
2025-10-22 22:56:32.183 +08:00 [INF] 登录失败次数: 0
2025-10-22 22:56:32.183 +08:00 [INF] 检查账户锁定状态
2025-10-22 22:56:32.185 +08:00 [INF] 开始验证密码
2025-10-22 22:56:32.185 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 22:56:32.185 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 22:56:32.185 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 22:56:32.185 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 22:56:32.185 +08:00 [INF] 密码哈希长度: 60
2025-10-22 22:56:32.185 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 22:56:32.363 +08:00 [INF] 密码验证结果: True
2025-10-22 22:56:32.363 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 22:56:32.364 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:32.365 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:32.371 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:56:32.375 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:32.378 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:32.385 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.385 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.386 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:56:32.388 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:56:32.405 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:32.405 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:32.405 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 22:56:32.406 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 22:56:32.408 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:32.409 +08:00 [DBG] Committing transaction.
2025-10-22 22:56:32.413 +08:00 [DBG] Committed transaction.
2025-10-22 22:56:32.414 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.417 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.418 +08:00 [DBG] Disposing transaction.
2025-10-22 22:56:32.421 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:32.421 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:56:32.421 +08:00 [INF] 用户信息更新完成
2025-10-22 22:56:32.421 +08:00 [INF] 用户登录成功 - admin
2025-10-22 22:56:32.422 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 22:56:32.422 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 22:56:32.422 +08:00 [INF] 成功: True
2025-10-22 22:56:32.422 +08:00 [INF] 消息: 登录成功
2025-10-22 22:56:32.422 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:56:32.422 +08:00 [INF] 用户 admin 登录成功
2025-10-22 22:56:32.424 +08:00 [INF] 上次登录时间: 2025-10-22 22:44:21
2025-10-22 22:56:32.424 +08:00 [INF] 触发登录成功事件
2025-10-22 22:56:32.424 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 22:56:32.425 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 22:56:32.425 +08:00 [INF] 用户ID: 1
2025-10-22 22:56:32.425 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:56:32.437 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 22:56:32.437 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 22:56:32.448 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 22:56:32.450 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:56:32.450 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:32.450 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:32.450 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.450 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.450 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 22:56:32.452 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 22:56:32.452 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:32.460 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:32.460 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.461 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.471 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 22:56:32.471 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 22:56:32.471 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 22:56:32.471 +08:00 [INF] 用户ID: 1
2025-10-22 22:56:32.471 +08:00 [INF] 用户对象是否为null: False
2025-10-22 22:56:32.471 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 22:56:32.471 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 22:56:32.471 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 22:56:32.473 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 22:56:32.475 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:56:32.475 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:32.475 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:32.475 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.476 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.476 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:56:32.477 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:56:32.481 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:32.491 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:32.491 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:32.492 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:32.493 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 22:56:32.524 +08:00 [INF] 所有页面加载完成
2025-10-22 22:56:32.524 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 22:56:32.524 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 22:56:32.524 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 22:56:32.524 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 22:56:32.524 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 22:56:32.524 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 22:56:32.524 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 22:56:32.524 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 22:56:32.524 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 22:56:32.524 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 22:56:32.524 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 22:56:32.524 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 22:56:32.524 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 22:56:32.534 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:32.557 +08:00 [INF] 关闭登录窗口
2025-10-22 22:56:32.561 +08:00 [INF] === 登录流程结束 ===
2025-10-22 22:56:32.601 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:33.634 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .Include(er => er.AnswerRecords)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 22:56:33.641 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 22:56:33.642 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:56:33.642 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 22:56:33.676 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt, a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        LEFT JOIN AnswerRecords AS a ON e.RecordId == a.RecordId
        ORDER BY e.StartTime DESC, e.RecordId ASC, u.UserId ASC, e0.PaperId ASC, a.AnswerId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:56:33.677 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:33.677 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:33.677 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:33.677 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:33.677 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:56:33.678 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:56:33.680 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.690 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.694 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:33.700 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:33.700 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:33.701 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:33.702 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:33.702 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:33.702 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:33.702 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:33.702 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:56:33.704 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:56:33.704 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:33.704 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:33.704 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:33.748 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:35.056 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:35.120 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .Include(r => r.User)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 22:56:35.121 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:56:35.121 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 22:56:35.122 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 22:56:35.122 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:56:35.122 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 22:56:35.128 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 22:56:35.139 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t.UserId0, t.CreatedAt1, t.Email, t.IsActive0, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt, u.UserId AS UserId0, u.CreatedAt AS CreatedAt1, u.Email, u.IsActive AS IsActive0, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                INNER JOIN Users AS u ON e.UserId == u.UserId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, t.UserId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:35.139 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:35.139 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:35.139 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.140 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.140 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:56:35.142 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:56:35.144 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.154 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.154 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.155 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.157 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.158 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:35.158 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.159 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.161 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .Where(ar => ar.RecordId == __recordId_0 && !(ar.IsGraded))'
2025-10-22 22:56:35.161 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:56:35.164 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        WHERE (a.RecordId == @__recordId_0) && Not(a.IsGraded)), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:56:35.165 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:35.165 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:35.165 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.165 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.165 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:56:35.166 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:56:35.167 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:35.167 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.167 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.167 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .ThenInclude(p => p.PaperQuestions)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 22:56:35.168 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:56:35.168 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 22:56:35.173 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN PaperQuestions AS p ON t.PaperId0 == p.PaperId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, p.Id ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:35.173 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:35.173 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:35.173 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.174 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.174 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:56:35.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:56:35.176 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:35.178 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:35.178 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.179 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.179 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Where(ar => ar.RecordId == __recordId_0)
    .All(ar => ar.IsGraded)'
2025-10-22 22:56:35.180 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT NOT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM AnswerRecords AS a
                WHERE (a.RecordId == @__recordId_0) && Not(a.IsGraded))), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:35.180 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:35.180 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:35.180 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.180 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.180 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:56:35.182 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:56:35.182 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:35.182 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.182 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.182 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:35.182 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:35.194 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:35.194 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 0 entities written to the database.
2025-10-22 22:56:35.194 +08:00 [INF] 自动评分完成，记录ID: 1，客观题得分: 0
2025-10-22 22:56:35.195 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .Where(ar => ar.RecordId == __recordId_0)
    .OrderBy(ar => ar.Question.QuestionId)'
2025-10-22 22:56:35.195 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:56:35.196 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 22:56:35.200 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content, q0.IsCorrect, q0.OptionLabel, q0.OrderIndex, q0.QuestionId
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
        WHERE a.RecordId == @__recordId_0
        ORDER BY q.QuestionId ASC, a.AnswerId ASC, q0.OptionId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:56:35.200 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:35.200 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:35.200 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.200 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.201 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:56:35.202 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:56:35.202 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:35.202 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:35.203 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:35.230 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:37.505 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:38.046 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:38.156 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:38.326 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:39.527 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:39.683 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:40.034 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:41.171 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:41.310 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:41.570 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:44.952 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:45.231 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:45.460 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:45.942 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:46.294 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:48.185 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:48.395 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:49.380 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:50.043 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:50.279 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:50.488 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:51.077 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:51.542 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:51.587 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .FirstOrDefault(ar => ar.RecordId == __recordId_0 && ar.QuestionId == __questionId_1)'
2025-10-22 22:56:51.589 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AnswerRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<AnswerRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
            SELECT TOP(1) a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
            FROM AnswerRecords AS a
            WHERE (a.RecordId == @__recordId_0) && (a.QuestionId == @__questionId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:51.590 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:51.590 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:51.590 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.590 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.590 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:56:51.592 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:56:51.592 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:51.592 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.593 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.594 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:51.594 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:51.594 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:51.595 +08:00 [DBG] The foreign key property 'AnswerRecord.GraderId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:56:51.599 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:51.599 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.599 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.599 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:56:51.600 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:56:51.603 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:51.603 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:51.603 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:56:51.603 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:56:51.603 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:51.603 +08:00 [DBG] Committing transaction.
2025-10-22 22:56:51.607 +08:00 [DBG] Committed transaction.
2025-10-22 22:56:51.607 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.611 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.611 +08:00 [DBG] Disposing transaction.
2025-10-22 22:56:51.611 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:51.611 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:56:51.612 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Where(ar => ar.RecordId == __recordId_0 && ar.IsGraded)'
2025-10-22 22:56:51.614 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
        FROM AnswerRecords AS a
        WHERE (a.RecordId == @__recordId_0) && a.IsGraded), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 22:56:51.614 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:51.614 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:51.614 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.614 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.614 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:56:51.616 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:56:51.616 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:51.616 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.616 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.618 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .FirstOrDefault(er => er.RecordId == __recordId_0)'
2025-10-22 22:56:51.618 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 22:56:51.618 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 22:56:51.618 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 22:56:51.618 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 22:56:51.626 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.UserId0, t.CreatedAt0, t.Email, t.IsActive, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt1, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive0, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId AS UserId0, u.CreatedAt AS CreatedAt0, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt1, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive AS IsActive0, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN Users AS u ON e.UserId == u.UserId
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.UserId0 ASC, t.PaperId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 22:56:51.626 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:51.626 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:51.626 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.626 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.627 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:56:51.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:56:51.628 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:51.628 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.629 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.629 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:51.629 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:51.629 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:51.630 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:51.630 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.630 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.630 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:56:51.631 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:56:51.632 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:51.632 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:51.633 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:56:51.633 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:56:51.633 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:51.633 +08:00 [DBG] Committing transaction.
2025-10-22 22:56:51.638 +08:00 [DBG] Committed transaction.
2025-10-22 22:56:51.638 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:51.641 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:51.641 +08:00 [DBG] Disposing transaction.
2025-10-22 22:56:51.641 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:51.641 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:56:51.641 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=12, Score=0
2025-10-22 22:56:51.663 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:52.841 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:53.023 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:53.776 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:53.929 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:54.069 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:54.319 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:54.438 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:54.791 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:54.845 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:54.846 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:54.846 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.846 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.846 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:56:54.847 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:56:54.847 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:54.848 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.848 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.848 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:54.848 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:54.848 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:54.848 +08:00 [DBG] The foreign key property 'AnswerRecord.GraderId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:56:54.849 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:54.849 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.849 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.849 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:56:54.850 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:56:54.850 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:54.850 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:54.850 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 11)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:56:54.850 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 11)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:56:54.850 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:54.850 +08:00 [DBG] Committing transaction.
2025-10-22 22:56:54.854 +08:00 [DBG] Committed transaction.
2025-10-22 22:56:54.854 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.857 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.857 +08:00 [DBG] Disposing transaction.
2025-10-22 22:56:54.857 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:54.857 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:56:54.857 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:54.857 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:54.857 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.857 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.857 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:56:54.858 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:56:54.858 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:54.858 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.859 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.859 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:54.859 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:54.859 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.859 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.859 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:56:54.860 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:56:54.861 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:54.861 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.861 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.861 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:54.861 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:54.861 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:54.862 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:54.862 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.862 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.862 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:56:54.863 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:56:54.863 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:54.863 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:54.863 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:56:54.863 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:56:54.863 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:54.863 +08:00 [DBG] Committing transaction.
2025-10-22 22:56:54.867 +08:00 [DBG] Committed transaction.
2025-10-22 22:56:54.867 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:54.871 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:54.871 +08:00 [DBG] Disposing transaction.
2025-10-22 22:56:54.871 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:54.871 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:56:54.871 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=14, Score=1
2025-10-22 22:56:54.888 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:56.075 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:56.224 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:57.021 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:57.167 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:57.284 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:57.669 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:57.776 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:57.978 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:58.022 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:58.022 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:58.023 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.023 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.023 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:56:58.025 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:56:58.025 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:58.025 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.026 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.026 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:58.026 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:58.026 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:58.026 +08:00 [DBG] The foreign key property 'AnswerRecord.GraderId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:56:58.026 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:58.026 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.026 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.027 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:56:58.027 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:56:58.027 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:58.027 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:58.027 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:56:58.028 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:56:58.028 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:58.028 +08:00 [DBG] Committing transaction.
2025-10-22 22:56:58.033 +08:00 [DBG] Committed transaction.
2025-10-22 22:56:58.033 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.036 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.036 +08:00 [DBG] Disposing transaction.
2025-10-22 22:56:58.036 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:58.036 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:56:58.036 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:58.036 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:58.036 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.037 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.037 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:56:58.038 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:56:58.038 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:58.038 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.039 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.039 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:58.039 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:58.039 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.039 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.039 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:56:58.041 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:56:58.041 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:58.041 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.042 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.042 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:58.042 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:56:58.042 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:56:58.042 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:56:58.042 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.043 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.043 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:56:58.044 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:56:58.044 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:56:58.044 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:56:58.044 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:56:58.044 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:56:58.044 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:56:58.044 +08:00 [DBG] Committing transaction.
2025-10-22 22:56:58.050 +08:00 [DBG] Committed transaction.
2025-10-22 22:56:58.050 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:56:58.053 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:56:58.053 +08:00 [DBG] Disposing transaction.
2025-10-22 22:56:58.053 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:56:58.053 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:56:58.053 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=48, Score=2
2025-10-22 22:56:58.086 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:58.873 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:58.979 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:59.741 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:56:59.834 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:00.501 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:00.589 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:00.589 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:00.589 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.589 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.589 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:00.590 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:00.590 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:00.591 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.591 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.591 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:00.591 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:00.591 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:00.591 +08:00 [DBG] The foreign key property 'AnswerRecord.GraderId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:00.592 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:00.592 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.592 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.592 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:00.593 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:00.593 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:00.593 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:00.593 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:00.593 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:00.593 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:00.593 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:00.597 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:00.597 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.599 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.599 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:00.599 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:00.599 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:00.600 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:00.600 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:00.600 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.600 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.600 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:00.601 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:00.601 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:00.601 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.601 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.602 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:00.602 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:00.602 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.602 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.602 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:00.603 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:00.603 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:00.603 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.604 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.604 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:00.604 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:00.604 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:00.604 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:00.604 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.605 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.605 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:00.605 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:00.606 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:00.606 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:00.606 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:00.606 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:00.606 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:00.606 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:00.611 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:00.611 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:00.613 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:00.613 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:00.613 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:00.613 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:00.613 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=49, Score=0
2025-10-22 22:57:00.650 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:02.281 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:02.356 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.356 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.356 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.356 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.356 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.358 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.358 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.358 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.358 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.358 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.358 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.358 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.359 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.359 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.359 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.359 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.360 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.360 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.360 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.360 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.360 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.360 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.360 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.365 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.365 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.368 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.368 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.368 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.368 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.368 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.368 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.368 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.368 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.368 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.369 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.369 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.369 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.370 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.370 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.370 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.370 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.370 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.370 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.371 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.371 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.371 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.372 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.372 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.372 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.372 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.372 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.372 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.372 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.372 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.373 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.373 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.373 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.373 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.373 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.373 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.373 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.378 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.378 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.381 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.381 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.381 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.381 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.381 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=12, Score=0
2025-10-22 22:57:02.382 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.382 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.382 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.382 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.382 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.383 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.383 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.383 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.384 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.384 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.384 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.384 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.384 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.384 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.385 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.385 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.385 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.385 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.385 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.385 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 11)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.386 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 11)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.386 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.386 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.390 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.390 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.394 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.394 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.394 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.394 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.394 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.394 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.394 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.394 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.394 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.395 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.395 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.395 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.396 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.396 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.396 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.396 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.396 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.396 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.397 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.397 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.397 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.398 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.398 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.398 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.398 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.398 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.398 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.398 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.398 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.399 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.399 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.399 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.399 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.399 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.399 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.400 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.404 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.404 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.406 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.406 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.406 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.406 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.406 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=14, Score=1
2025-10-22 22:57:02.406 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.406 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.406 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.407 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.407 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.408 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.408 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.408 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.408 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.408 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.408 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.408 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.409 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.409 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.409 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.409 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.410 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.410 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.410 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.410 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.410 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.410 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.410 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.414 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.414 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.417 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.417 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.417 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.417 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.417 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.417 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.417 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.417 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.417 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.418 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.418 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.418 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.419 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.419 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.419 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.419 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.419 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.419 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.420 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.420 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.420 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.421 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.421 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.421 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.421 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.421 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.421 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.422 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.422 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.422 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.422 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.422 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.422 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.423 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.423 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.427 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.427 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.430 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.430 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.430 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.430 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.430 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=48, Score=2
2025-10-22 22:57:02.430 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.430 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.430 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.430 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.430 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.431 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 22:57:02.431 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.431 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.432 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.432 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.432 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.432 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.432 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.432 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.432 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.432 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.433 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.433 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.433 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.433 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.433 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 22:57:02.433 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.433 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.438 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.438 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.441 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.441 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.441 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.441 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.441 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.441 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.441 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.441 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.441 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.442 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 22:57:02.442 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.442 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.443 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.443 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.443 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.443 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.443 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.443 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.444 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 22:57:02.444 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.444 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.445 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.445 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.445 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.445 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:02.445 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:02.445 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.446 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.446 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:02.446 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:02.446 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:02.446 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:02.446 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.447 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 22:57:02.447 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:02.447 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:02.452 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:02.452 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:02.455 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:02.455 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:02.455 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:02.455 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:02.455 +08:00 [INF] 人工评分成功：RecordId=1, QuestionId=49, Score=0
2025-10-22 22:57:02.497 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:03.749 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:06.440 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:06.596 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:06.918 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:06.973 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:07.865 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:07.975 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:08.474 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:08.642 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:08.907 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:08.990 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:09.491 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:09.908 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:09.975 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:10.365 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:10.627 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:10.979 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:11.048 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:11.688 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:11.765 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:11.765 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:11.765 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.765 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.765 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:11.767 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:11.767 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:11.767 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.768 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.768 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:11.768 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:11.768 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.768 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.768 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:11.769 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:11.769 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:11.769 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.770 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.770 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:11.770 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:11.770 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.770 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.770 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:11.771 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:11.771 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:11.771 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.771 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.771 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:11.772 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:11.772 +08:00 [DBG] The unchanged property 'ExamRecord.GradedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:11.772 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:11.772 +08:00 [DBG] The unchanged property 'ExamRecord.TotalScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:11.772 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:11.772 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.772 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.772 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:11.773 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:11.773 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:11.773 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:11.773 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0, "TotalScore" = @p1
WHERE "RecordId" = @p2;
SELECT changes();
2025-10-22 22:57:11.773 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0, "TotalScore" = @p1
WHERE "RecordId" = @p2;
SELECT changes();
2025-10-22 22:57:11.773 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:11.773 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:11.777 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:11.777 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:11.779 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:11.779 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:11.779 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:11.779 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:11.779 +08:00 [INF] 自动评分完成，记录ID: 1，客观题得分: 0
2025-10-22 22:57:11.785 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:13.010 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.010 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.010 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.011 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.011 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:13.012 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:13.012 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.012 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.013 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.013 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.013 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.013 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.013 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.013 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:13.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:13.014 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.015 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.015 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.015 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.015 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.015 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.015 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.015 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:13.016 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:13.016 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.016 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.017 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.017 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:13.017 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:13.017 +08:00 [DBG] The unchanged property 'ExamRecord.GradedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:13.017 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:13.017 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:13.017 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.018 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.018 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:13.018 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:13.018 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.019 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.019 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 22:57:13.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 22:57:13.019 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.019 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:13.024 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:13.024 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.026 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.026 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:13.026 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:13.026 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:13.026 +08:00 [INF] 自动评分完成，记录ID: 1，客观题得分: 0
2025-10-22 22:57:13.053 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:13.413 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.413 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.413 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.413 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.413 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:13.414 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:13.414 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.414 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.415 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.415 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.415 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.415 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.415 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.415 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:13.416 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:13.417 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.417 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.417 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.417 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.417 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.417 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.418 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.418 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:13.418 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:13.418 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.418 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.419 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.419 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:13.419 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:13.419 +08:00 [DBG] The unchanged property 'ExamRecord.GradedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:13.419 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:13.419 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:13.419 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.420 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.420 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:13.420 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:13.420 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.420 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.420 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 22:57:13.421 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 22:57:13.421 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.421 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:13.426 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:13.426 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.428 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.428 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:13.428 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:13.428 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:13.428 +08:00 [INF] 自动评分完成，记录ID: 1，客观题得分: 0
2025-10-22 22:57:13.438 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:13.627 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.627 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.627 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.627 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.627 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:13.629 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:13.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.629 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.629 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.630 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.630 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.630 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:13.631 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:13.631 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.631 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.631 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.631 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.631 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.632 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.632 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.632 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:13.632 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:13.633 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.633 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.633 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.633 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:13.633 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:13.633 +08:00 [DBG] The unchanged property 'ExamRecord.GradedAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:13.633 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:13.634 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:13.634 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.634 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.634 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:13.634 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:13.635 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:13.635 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:13.635 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 22:57:13.635 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "GradedAt" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 22:57:13.635 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:13.635 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:13.640 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:13.640 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:13.642 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:13.642 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:13.642 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:13.642 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 22:57:13.642 +08:00 [INF] 自动评分完成，记录ID: 1，客观题得分: 0
2025-10-22 22:57:13.643 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:17.603 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:17.709 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:18.369 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:19.231 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:19.351 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:19.907 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:20.467 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:21.090 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:23.509 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:24.303 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:24.421 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:24.421 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:24.421 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:24.421 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:24.421 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:57:24.423 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:57:24.423 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:24.423 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:24.423 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:24.424 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:24.424 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:24.424 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:24.424 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:24.424 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:57:24.425 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:57:24.425 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:24.425 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:24.426 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:24.494 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:26.010 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:26.089 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:26.865 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:26.936 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:26.936 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:26.936 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:26.936 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:26.936 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:57:26.938 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:57:26.938 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:26.938 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:26.939 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:26.939 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:26.939 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:26.939 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:26.939 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:26.939 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:57:26.941 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:57:26.941 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:26.941 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:26.941 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:26.987 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:33.862 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:34.606 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:35.253 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:35.803 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:35.803 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:35.803 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:35.804 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:35.804 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:57:35.806 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:57:35.806 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:35.806 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:35.807 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:35.807 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:35.807 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:35.807 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:35.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:35.808 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:57:35.809 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:57:35.809 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:35.809 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:35.809 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:35.825 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:37.376 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:38.024 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:38.126 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.126 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.126 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.126 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.126 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:57:38.128 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 22:57:38.128 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.128 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.129 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.129 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.129 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.129 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.130 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.130 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:38.131 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 22:57:38.131 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.131 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.131 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.131 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.131 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.131 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.132 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.132 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:38.133 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 22:57:38.133 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.133 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.133 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.134 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.134 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.134 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.134 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.134 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:38.135 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 22:57:38.135 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.135 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.136 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.136 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 22:57:38.136 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'ExamRecord.CorrectCount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'ExamRecord.ObjectiveScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'ExamRecord.TotalScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.IsCorrect' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.Score' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.136 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 22:57:38.136 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 22:57:38.136 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.136 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.136 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 22:57:38.137 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 22:57:38.138 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.138 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.138 +08:00 [DBG] Executing DbCommand [Parameters=[@p4='?', @p0='?', @p1='?', @p2='?', @p3='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsCorrect" = @p1, "IsGraded" = @p2, "Score" = @p3
WHERE "AnswerId" = @p4;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p4='?', @p0='?', @p1='?', @p2='?', @p3='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsCorrect" = @p1, "IsGraded" = @p2, "Score" = @p3
WHERE "AnswerId" = @p4;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.138 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.138 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.138 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.138 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.138 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.138 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.138 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.138 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.138 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.138 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.138 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.138 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.138 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.138 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.138 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.138 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.138 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.138 +08:00 [DBG] Executing DbCommand [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "ObjectiveScore" = @p1, "TotalScore" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "ObjectiveScore" = @p1, "TotalScore" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 22:57:38.138 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.138 +08:00 [DBG] Committing transaction.
2025-10-22 22:57:38.146 +08:00 [DBG] Committed transaction.
2025-10-22 22:57:38.146 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.149 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.149 +08:00 [DBG] Disposing transaction.
2025-10-22 22:57:38.149 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.149 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.149 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.149 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.149 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.149 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.149 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 22:57:38.149 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 7 entities written to the database.
2025-10-22 22:57:38.149 +08:00 [INF] 自动评分完成，记录ID: 2，客观题得分: 2
2025-10-22 22:57:38.149 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:38.149 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:38.149 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.149 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.150 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:57:38.150 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 22:57:38.151 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:38.151 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:38.151 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:38.188 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:39.367 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:39.459 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:40.168 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:40.622 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:40.869 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:41.253 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:41.470 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:41.718 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:42.930 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:43.630 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:43.671 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:43.988 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:44.049 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:44.284 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:44.468 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:45.430 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:46.055 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:57:50.392 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:50.392 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:50.392 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:50.392 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:50.392 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:57:50.394 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 22:57:50.394 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:50.394 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:50.395 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:50.395 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 22:57:50.395 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 22:57:50.395 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:50.395 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:50.395 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:57:50.396 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 22:57:50.396 +08:00 [DBG] A data reader was disposed.
2025-10-22 22:57:50.396 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 22:57:50.396 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 22:57:50.434 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 22:58:08.433 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:06.905 +08:00 [DBG] Hosting starting
2025-10-22 23:13:06.926 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 23:13:06.927 +08:00 [INF] Hosting environment: Production
2025-10-22 23:13:06.928 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 23:13:06.928 +08:00 [DBG] Hosting started
2025-10-22 23:13:06.964 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 23:13:07.102 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:13:07.117 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:13:07.177 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:13:07.178 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:13:07.204 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 23:13:07.327 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 23:13:07.355 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.358 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.362 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.371 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:13:07.374 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 23:13:07.376 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.378 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.382 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.393 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.394 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.395 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.397 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.397 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.397 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:13:07.397 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 23:13:07.397 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.397 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.397 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.399 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.399 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.399 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.403 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:07.404 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:07.404 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.404 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.404 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:13:07.406 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:13:07.407 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:07.407 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.407 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.414 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 23:13:07.416 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.416 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.416 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.416 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:13:07.416 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 23:13:07.416 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.416 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.416 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.417 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.417 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.418 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.418 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.418 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.418 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:13:07.418 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 23:13:07.418 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.419 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.419 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.419 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:13:07.420 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.420 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.420 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:07.420 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:07.420 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.420 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.420 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:13:07.421 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:13:07.421 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:07.421 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.422 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.422 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 23:13:07.443 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 23:13:07.550 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:07.562 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:07.562 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:07.562 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.562 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.562 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 23:13:07.564 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 23:13:07.564 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:07.564 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.565 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.565 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 23:13:07.566 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:07.566 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:07.566 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:07.566 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.567 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.567 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 23:13:07.568 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 23:13:07.568 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:07.568 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.569 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.569 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 23:13:07.570 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:07.570 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:07.570 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:07.570 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.570 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.570 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 23:13:07.571 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 23:13:07.571 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:07.571 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:07.572 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:07.573 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 23:13:07.574 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 23:13:18.356 +08:00 [INF] === 开始登录流程 ===
2025-10-22 23:13:18.356 +08:00 [INF] 用户名: admin
2025-10-22 23:13:18.356 +08:00 [INF] 密码长度: 8
2025-10-22 23:13:18.356 +08:00 [INF] AuthService是否为null: False
2025-10-22 23:13:18.357 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 23:13:18.358 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 23:13:18.359 +08:00 [INF] 接收到的用户名: admin
2025-10-22 23:13:18.359 +08:00 [INF] 接收到的密码长度: 8
2025-10-22 23:13:18.359 +08:00 [INF] 开始查询用户
2025-10-22 23:13:18.359 +08:00 [INF] UserRepository是否为null: False
2025-10-22 23:13:18.359 +08:00 [INF] Context是否为null: False
2025-10-22 23:13:18.359 +08:00 [INF] 测试数据库连接...
2025-10-22 23:13:18.359 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.360 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.360 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 23:13:18.360 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 23:13:18.364 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:18.367 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:18.367 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:18.367 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.367 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.367 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:13:18.369 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:13:18.369 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:18.369 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.369 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.370 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 23:13:18.371 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 23:13:18.383 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:18.386 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:18.386 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:18.387 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.387 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.388 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:13:18.390 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__username_0='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:13:18.393 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:18.414 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:18.414 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.416 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.416 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 23:13:18.416 +08:00 [INF] 用户ID: 1, 用户名: admin, 角色: Admin
2025-10-22 23:13:18.416 +08:00 [INF] 用户是否激活: True
2025-10-22 23:13:18.416 +08:00 [INF] 登录失败次数: 0
2025-10-22 23:13:18.416 +08:00 [INF] 检查账户锁定状态
2025-10-22 23:13:18.418 +08:00 [INF] 开始验证密码
2025-10-22 23:13:18.418 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 23:13:18.418 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 23:13:18.418 +08:00 [INF] 密码哈希前20字符: $2a$12$yMZFMLalryKcO...
2025-10-22 23:13:18.418 +08:00 [INF] 开始验证密码 - 用户: admin
2025-10-22 23:13:18.418 +08:00 [INF] 密码哈希长度: 60
2025-10-22 23:13:18.418 +08:00 [INF] 密码哈希前缀: $2a$12$yMZ
2025-10-22 23:13:18.591 +08:00 [INF] 密码验证结果: True
2025-10-22 23:13:18.591 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 23:13:18.592 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:13:18.593 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:13:18.599 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:18.602 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:18.605 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:13:18.611 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.612 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.612 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:13:18.614 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:13:18.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:18.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:18.630 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:13:18.631 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:13:18.633 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:18.634 +08:00 [DBG] Committing transaction.
2025-10-22 23:13:18.639 +08:00 [DBG] Committed transaction.
2025-10-22 23:13:18.640 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.644 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.644 +08:00 [DBG] Disposing transaction.
2025-10-22 23:13:18.647 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:18.647 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:13:18.647 +08:00 [INF] 用户信息更新完成
2025-10-22 23:13:18.647 +08:00 [INF] 用户登录成功 - admin
2025-10-22 23:13:18.648 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 23:13:18.648 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 23:13:18.648 +08:00 [INF] 成功: True
2025-10-22 23:13:18.648 +08:00 [INF] 消息: 登录成功
2025-10-22 23:13:18.648 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:13:18.648 +08:00 [INF] 用户 admin 登录成功
2025-10-22 23:13:18.650 +08:00 [INF] 上次登录时间: 2025-10-22 22:56:32
2025-10-22 23:13:18.650 +08:00 [INF] 触发登录成功事件
2025-10-22 23:13:18.650 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 23:13:18.650 +08:00 [INF] 登录成功的用户: admin (Admin)
2025-10-22 23:13:18.651 +08:00 [INF] 用户ID: 1
2025-10-22 23:13:18.651 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:13:18.662 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 23:13:18.662 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 23:13:18.672 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 23:13:18.674 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:13:18.674 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:18.674 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:18.674 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.675 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.675 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:13:18.676 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:13:18.676 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:18.683 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:18.683 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.684 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.691 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 23:13:18.692 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 23:13:18.692 +08:00 [INF] 接收到的用户: admin (Admin)
2025-10-22 23:13:18.692 +08:00 [INF] 用户ID: 1
2025-10-22 23:13:18.692 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:13:18.692 +08:00 [INF] 设置后的CurrentUser: admin (Admin)
2025-10-22 23:13:18.692 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 23:13:18.692 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 23:13:18.693 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 23:13:18.695 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:13:18.695 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:18.695 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:18.695 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.695 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.695 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:13:18.697 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:13:18.699 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:18.710 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:18.710 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:18.710 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:18.711 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 23:13:18.740 +08:00 [INF] 所有页面加载完成
2025-10-22 23:13:18.741 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 23:13:18.741 +08:00 [INF] 当前用户: admin (Admin)
2025-10-22 23:13:18.741 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 23:13:18.741 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 23:13:18.741 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 23:13:18.741 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 23:13:18.741 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 23:13:18.741 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 23:13:18.741 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 23:13:18.741 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 23:13:18.741 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 23:13:18.741 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 23:13:18.741 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 23:13:18.750 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:18.764 +08:00 [INF] 关闭登录窗口
2025-10-22 23:13:18.768 +08:00 [INF] === 登录流程结束 ===
2025-10-22 23:13:18.800 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:20.135 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .Include(er => er.AnswerRecords)
    .Where(er => (int)er.Status == 3 || (int)er.Status == 5)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 23:13:20.141 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 23:13:20.141 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:13:20.142 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 23:13:20.175 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt, a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        LEFT JOIN AnswerRecords AS a ON e.RecordId == a.RecordId
        WHERE e.Status IN (3, 5)
        ORDER BY e.StartTime DESC, e.RecordId ASC, u.UserId ASC, e0.PaperId ASC, a.AnswerId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:13:20.177 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:20.177 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:20.177 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:20.177 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:20.177 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:13:20.179 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:13:20.181 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.192 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.196 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.202 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:20.203 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:20.203 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:20.204 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:20.205 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:20.205 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:20.205 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:20.205 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:20.205 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:13:20.207 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:13:20.207 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:20.207 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:20.207 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:20.240 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:23.157 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:23.236 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .Include(r => r.User)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 23:13:23.236 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:13:23.237 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 23:13:23.237 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 23:13:23.237 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:13:23.237 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 23:13:23.245 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 23:13:23.257 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t.UserId0, t.CreatedAt1, t.Email, t.IsActive0, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt, u.UserId AS UserId0, u.CreatedAt AS CreatedAt1, u.Email, u.IsActive AS IsActive0, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                INNER JOIN Users AS u ON e.UserId == u.UserId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, t.UserId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:23.258 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:23.258 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:23.258 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:23.258 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:23.258 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:13:23.260 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:13:23.263 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.273 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.273 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.274 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:23.277 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:23.277 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:23.278 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:23.279 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .Where(ar => ar.RecordId == __recordId_0)
    .OrderBy(ar => ar.Question.QuestionId)'
2025-10-22 23:13:23.280 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:13:23.280 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 23:13:23.285 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content, q0.IsCorrect, q0.OptionLabel, q0.OrderIndex, q0.QuestionId
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
        WHERE a.RecordId == @__recordId_0
        ORDER BY q.QuestionId ASC, a.AnswerId ASC, q0.OptionId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:13:23.285 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:23.285 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:23.285 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:23.285 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:23.285 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 23:13:23.287 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 23:13:23.287 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:23.287 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:23.288 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:23.316 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:28.783 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:28.864 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:30.028 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:30.099 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 23:13:30.152 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:31.044 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:31.169 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:31.356 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:31.946 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:32.100 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:32.199 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:32.346 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:32.484 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:32.622 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:32.936 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:33.108 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:33.312 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:33.494 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:33.654 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:33.747 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:33.810 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:33.996 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.138 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.199 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.214 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.416 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.495 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.620 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.731 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:34.746 +08:00 [INF] === 开始登录流程 ===
2025-10-22 23:13:34.746 +08:00 [INF] 用户名: student
2025-10-22 23:13:34.746 +08:00 [INF] 密码长度: 10
2025-10-22 23:13:34.746 +08:00 [INF] AuthService是否为null: False
2025-10-22 23:13:34.746 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 23:13:34.747 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 23:13:34.747 +08:00 [INF] 接收到的用户名: student
2025-10-22 23:13:34.747 +08:00 [INF] 接收到的密码长度: 10
2025-10-22 23:13:34.747 +08:00 [INF] 开始查询用户
2025-10-22 23:13:34.747 +08:00 [INF] UserRepository是否为null: False
2025-10-22 23:13:34.747 +08:00 [INF] Context是否为null: False
2025-10-22 23:13:34.747 +08:00 [INF] 测试数据库连接...
2025-10-22 23:13:34.747 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.747 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.747 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 23:13:34.748 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.748 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.748 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.748 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.748 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:13:34.749 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:13:34.750 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.750 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.750 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.750 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 23:13:34.751 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.751 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.751 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.751 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.751 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:13:34.752 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:13:34.752 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.752 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.753 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.753 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 23:13:34.753 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-22 23:13:34.753 +08:00 [INF] 用户是否激活: True
2025-10-22 23:13:34.753 +08:00 [INF] 登录失败次数: 0
2025-10-22 23:13:34.753 +08:00 [INF] 检查账户锁定状态
2025-10-22 23:13:34.753 +08:00 [INF] 开始验证密码
2025-10-22 23:13:34.753 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 23:13:34.753 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 23:13:34.753 +08:00 [INF] 密码哈希前20字符: $2a$12$iXseHsdkCBsHc...
2025-10-22 23:13:34.753 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-22 23:13:34.753 +08:00 [INF] 密码哈希长度: 60
2025-10-22 23:13:34.753 +08:00 [INF] 密码哈希前缀: $2a$12$iXs
2025-10-22 23:13:34.922 +08:00 [INF] 密码验证结果: True
2025-10-22 23:13:34.922 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 23:13:34.922 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:13:34.922 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:13:34.929 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:34.929 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.933 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:13:34.933 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.933 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.933 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:13:34.934 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:13:34.935 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.935 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.935 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:13:34.935 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:13:34.935 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.935 +08:00 [DBG] Committing transaction.
2025-10-22 23:13:34.939 +08:00 [DBG] Committed transaction.
2025-10-22 23:13:34.939 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.941 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.941 +08:00 [DBG] Disposing transaction.
2025-10-22 23:13:34.941 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.941 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:13:34.941 +08:00 [INF] 用户信息更新完成
2025-10-22 23:13:34.941 +08:00 [INF] 用户登录成功 - student
2025-10-22 23:13:34.941 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 23:13:34.941 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 23:13:34.941 +08:00 [INF] 成功: True
2025-10-22 23:13:34.941 +08:00 [INF] 消息: 登录成功
2025-10-22 23:13:34.941 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:13:34.941 +08:00 [INF] 用户 student 登录成功
2025-10-22 23:13:34.941 +08:00 [INF] 上次登录时间: 2025-10-22 00:17:29
2025-10-22 23:13:34.941 +08:00 [INF] 触发登录成功事件
2025-10-22 23:13:34.941 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 23:13:34.941 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-22 23:13:34.941 +08:00 [INF] 用户ID: 2
2025-10-22 23:13:34.941 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:13:34.942 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 23:13:34.942 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 23:13:34.942 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-22 23:13:34.943 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.943 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.943 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.944 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.944 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:13:34.945 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:13:34.945 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.945 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.945 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.947 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 23:13:34.947 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 23:13:34.947 +08:00 [INF] 接收到的用户: student (Student)
2025-10-22 23:13:34.947 +08:00 [INF] 用户ID: 2
2025-10-22 23:13:34.947 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:13:34.947 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-22 23:13:34.947 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 23:13:34.947 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 23:13:34.947 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.947 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.947 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.948 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.948 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:13:34.948 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:13:34.948 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.948 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.949 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.949 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 23:13:34.952 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-22 23:13:34.952 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-22 23:13:34.953 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-22 23:13:34.953 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.Creator)
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .Where(p => p.IsPublished)
    .OrderByDescending(p => p.CreatedAt)'
2025-10-22 23:13:34.954 +08:00 [DBG] Including navigation: 'ExamPaper.Creator'.
2025-10-22 23:13:34.954 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 23:13:34.954 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 23:13:34.960 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, t.Id, t.OrderIndex, t.PaperId, t.QuestionId, t.Score, t.QuestionId0, t.Analysis, t.Answer, t.BankId, t.Content, t.CreatedAt, t.Difficulty, t.IsActive, t.QuestionType, t.Score0, t.Tags, t.Title, t.UpdatedAt
        FROM ExamPapers AS e
        INNER JOIN Users AS u ON e.CreatorId == u.UserId
        LEFT JOIN Projection Mapping:
        (
            SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
            FROM PaperQuestions AS p
            INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
        ) AS t ON e.PaperId == t.PaperId
        WHERE e.IsPublished
        ORDER BY e.CreatedAt DESC, e.PaperId ASC, u.UserId ASC, t.Id ASC, t.QuestionId0 ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:13:34.960 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.960 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.960 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.961 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.961 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 23:13:34.962 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 23:13:34.963 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:34.965 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.965 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.965 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.965 +08:00 [INF] 成功获取 1 个已发布的试卷
2025-10-22 23:13:34.966 +08:00 [INF] 成功加载 1 个可参加的考试
2025-10-22 23:13:34.972 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .Count()'
2025-10-22 23:13:34.973 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM NotificationRecipients AS n
            WHERE n.ReceiverId == @__receiverId_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:34.973 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.973 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.973 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.973 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.973 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 23:13:34.974 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 23:13:34.974 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.974 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.975 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.975 +08:00 [DBG] Compiling query expression: 
'DbSet<NotificationRecipient>()
    .Include(r => r.Notification)
    .ThenInclude(n => n.Sender)
    .Where(r => r.ReceiverId == __receiverId_0)
    .OrderByDescending(r => r.Notification.CreatedAt)
    .Skip(__p_1)
    .Take(__p_2)'
2025-10-22 23:13:34.976 +08:00 [DBG] Including navigation: 'NotificationRecipient.Notification'.
2025-10-22 23:13:34.976 +08:00 [DBG] Including navigation: 'Notification.Sender'.
2025-10-22 23:13:34.981 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<NotificationRecipient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT t.NotificationRecipientId, t.CreatedAt, t.DeliveryStatus, t.NotificationId, t.ReadAt, t.ReceiverId, t.NotificationId0, t.Content, t.CreatedAt0, t.Priority, t.Scope, t.SenderId, t.Status, t.Title, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
        FROM Projection Mapping:
        (
            SELECT n.NotificationRecipientId, n.CreatedAt, n.DeliveryStatus, n.NotificationId, n.ReadAt, n.ReceiverId, n0.NotificationId AS NotificationId0, n0.Content, n0.CreatedAt AS CreatedAt0, n0.Priority, n0.Scope, n0.SenderId, n0.Status, n0.Title
            FROM NotificationRecipients AS n
            INNER JOIN Notifications AS n0 ON n.NotificationId == n0.NotificationId
            WHERE n.ReceiverId == @__receiverId_0
            ORDER BY n0.CreatedAt DESC
            OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
        ) AS t
        INNER JOIN Users AS u ON t.SenderId == u.UserId
        ORDER BY t.CreatedAt0 DESC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, NotificationRecipient>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:13:34.982 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:34.982 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:34.982 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.982 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.982 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 23:13:34.983 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 23:13:34.983 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:34.983 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:34.984 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:34.989 +08:00 [INF] 所有页面加载完成
2025-10-22 23:13:34.989 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 23:13:34.989 +08:00 [INF] 当前用户: student (Student)
2025-10-22 23:13:34.989 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 23:13:34.989 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 23:13:34.989 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 23:13:34.989 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 23:13:34.989 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 23:13:34.989 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 23:13:34.989 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 23:13:34.989 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 23:13:34.989 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 23:13:34.989 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 23:13:34.989 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 23:13:35.008 +08:00 [INF] 关闭登录窗口
2025-10-22 23:13:35.010 +08:00 [INF] === 登录流程结束 ===
2025-10-22 23:13:35.029 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:36.137 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:36.311 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:36.512 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:36.757 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:37.443 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:37.508 +08:00 [INF] 学生 2 请求开始考试 1
2025-10-22 23:13:37.508 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=TakeExam, Result=True
2025-10-22 23:13:37.510 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 23:13:37.510 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()
    .Include(p => p.PaperQuestions)
    .ThenInclude(pq => pq.Question)
    .FirstOrDefault(p => p.PaperId == __paperId_0)'
2025-10-22 23:13:37.510 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 23:13:37.510 +08:00 [DBG] Including navigation: 'PaperQuestion.Question'.
2025-10-22 23:13:37.515 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamPaper>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamPaper>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.PaperId, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt, t.CreatorId, t.Description, t.Duration, t.EndTime, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime, t.Status, t.TotalScore, t.UpdatedAt, t0.Id, t0.OrderIndex, t0.PaperId, t0.QuestionId, t0.Score, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
                FROM ExamPapers AS e
                WHERE e.PaperId == @__paperId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
                FROM PaperQuestions AS p
                INNER JOIN Questions AS q ON p.QuestionId == q.QuestionId
            ) AS t0 ON t.PaperId == t0.PaperId
            ORDER BY t.PaperId ASC, t0.Id ASC, t0.QuestionId0 ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:37.515 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:37.515 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:37.515 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:37.516 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:37.516 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:37.517 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:37.518 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:37.518 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:37.518 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:37.518 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 23:13:37.518 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 23:13:37.518 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 23:13:37.519 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .FirstOrDefault(r => r.UserId == __userId_0 && r.PaperId == __paperId_1)'
2025-10-22 23:13:37.520 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (Nullable<DateTime>), 3], [Property: ExamRecord.GradedAt (Nullable<DateTime>), 4], [Property: ExamRecord.GraderId (Nullable<int>) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (Nullable<DateTime>), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (Nullable<DateTime>), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16], }
            SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
            FROM ExamRecords AS e
            WHERE (e.UserId == @__userId_0) && (e.PaperId == @__paperId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:37.520 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:37.520 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:37.520 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:37.521 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:37.521 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 23:13:37.522 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 23:13:37.522 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:37.522 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:37.522 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:37.522 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Graded", AllowRetake: true
2025-10-22 23:13:37.522 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 23:13:37.555 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:38.504 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:38.571 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 23:13:38.571 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.571 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.571 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.571 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.571 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:38.573 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:38.573 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.573 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.574 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.574 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 23:13:38.574 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 23:13:38.574 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 23:13:38.574 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.574 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.574 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.574 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.574 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 23:13:38.575 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 23:13:38.575 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.575 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.576 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.576 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Graded", AllowRetake: true
2025-10-22 23:13:38.576 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 23:13:38.577 +08:00 [INF] 开始检查用户考试资格 - UserId: 2, PaperId: 1
2025-10-22 23:13:38.577 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.577 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.577 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.577 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.577 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:38.579 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:38.579 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.579 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.579 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.579 +08:00 [INF] 试卷信息 - Name: 测试, IsPublished: true, Status: 已发布
2025-10-22 23:13:38.579 +08:00 [INF] 试卷发布状态检查通过
2025-10-22 23:13:38.579 +08:00 [INF] 考试时间窗口检查通过 - 开始时间: "2025-10-21T00:00:00.0000000", 结束时间: "2025-10-28T00:00:00.0000000"
2025-10-22 23:13:38.579 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.579 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.579 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.580 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.580 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 23:13:38.580 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?', @__paperId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE ("e"."UserId" = @__userId_0) AND ("e"."PaperId" = @__paperId_1)
LIMIT 1
2025-10-22 23:13:38.580 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.580 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.581 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.581 +08:00 [INF] 找到现有考试记录 - RecordId: 1, Status: "Graded", AllowRetake: true
2025-10-22 23:13:38.581 +08:00 [INF] 用户考试资格检查通过 - UserId: 2, PaperId: 1
2025-10-22 23:13:38.582 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.582 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.582 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.582 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.582 +08:00 [DBG] Executing DbCommand [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:38.583 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__paperId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."PaperId", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime", "t"."Status", "t"."TotalScore", "t"."UpdatedAt", "t0"."Id", "t0"."OrderIndex", "t0"."PaperId", "t0"."QuestionId", "t0"."Score", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
    FROM "ExamPapers" AS "e"
    WHERE "e"."PaperId" = @__paperId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."PaperId" = "t0"."PaperId"
ORDER BY "t"."PaperId", "t0"."Id", "t0"."QuestionId0"
2025-10-22 23:13:38.583 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.583 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.583 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.595 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'RecordId.ExamRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.597 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.597 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:13:38.597 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:13:38.599 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:13:38.599 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.600 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.600 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:13:38.600 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:13:38.603 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.603 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.603 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.603 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ExamRecords" ("CorrectCount", "CreatedAt", "EndTime", "GradedAt", "GraderId", "IsPassed", "ObjectiveScore", "PaperId", "RemainingTime", "StartTime", "Status", "SubjectiveScore", "SubmitTime", "TotalCount", "TotalScore", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
SELECT "RecordId"
FROM "ExamRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.609 +08:00 [DBG] The foreign key property 'ExamRecord.RecordId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.611 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.611 +08:00 [DBG] Committing transaction.
2025-10-22 23:13:38.617 +08:00 [DBG] Committed transaction.
2025-10-22 23:13:38.617 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.621 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.621 +08:00 [DBG] Disposing transaction.
2025-10-22 23:13:38.622 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.622 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] 'ExamDbContext' generated a temporary value for the property 'AnswerId.AnswerRecord'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.624 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:13:38.624 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:13:38.625 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:13:38.625 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.625 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.625 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:13:38.626 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:13:38.627 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.627 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.627 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.627 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.628 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.628 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.628 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.628 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.628 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.628 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.629 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.629 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.629 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.629 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.629 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.629 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.629 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.629 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.629 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.629 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.629 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.629 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.629 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.629 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AnswerRecords" ("AnswerTime", "Comment", "GradeTime", "GraderId", "IsCorrect", "IsGraded", "QuestionId", "RecordId", "Score", "UserAnswer")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
SELECT "AnswerId"
FROM "AnswerRecords"
WHERE changes() = 1 AND "rowid" = last_insert_rowid();
2025-10-22 23:13:38.629 +08:00 [DBG] The foreign key property 'AnswerRecord.AnswerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:38.629 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.629 +08:00 [DBG] Committing transaction.
2025-10-22 23:13:38.634 +08:00 [DBG] Committed transaction.
2025-10-22 23:13:38.635 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.638 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.638 +08:00 [DBG] Disposing transaction.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:38.638 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 9 entities written to the database.
2025-10-22 23:13:38.639 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .ThenInclude(p => p.PaperQuestions)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __examRecord_RecordId_0)'
2025-10-22 23:13:38.639 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:13:38.639 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 23:13:38.639 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 23:13:38.639 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:13:38.639 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 23:13:38.640 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 23:13:38.659 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__examRecord_RecordId_0
            ) AS t
            LEFT JOIN PaperQuestions AS p ON t.PaperId0 == p.PaperId
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, p.Id ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:38.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:38.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:38.659 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.659 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.659 +08:00 [DBG] Executing DbCommand [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:13:38.661 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__examRecord_RecordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__examRecord_RecordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:13:38.662 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:38.662 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:38.663 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:38.663 +08:00 [INF] 用户 2 开始考试，试卷ID: 1，记录ID: 7
2025-10-22 23:13:38.701 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:42.701 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=1, Option=B, beforeSelected=1
2025-10-22 23:13:42.702 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=1, Option=B
2025-10-22 23:13:42.702 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=1, Option=B, afterSelected=1
2025-10-22 23:13:42.703 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:44.459 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:44.563 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=1, Option=D, beforeSelected=1
2025-10-22 23:13:44.850 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=1, Option=D
2025-10-22 23:13:44.850 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=1, Option=D, afterSelected=1
2025-10-22 23:13:44.861 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:46.723 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:46.804 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .FirstOrDefault(ar => ar.RecordId == __recordId_0 && ar.QuestionId == __questionId_1)'
2025-10-22 23:13:46.806 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AnswerRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<AnswerRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
            SELECT TOP(1) a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
            FROM AnswerRecords AS a
            WHERE (a.RecordId == @__recordId_0) && (a.QuestionId == @__questionId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:13:46.806 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:46.806 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:46.806 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:46.807 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:46.807 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:13:46.808 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:13:46.808 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:46.808 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:46.809 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:46.809 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:13:46.809 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:13:46.809 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:46.809 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:46.809 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:46.809 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:13:46.809 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:46.810 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:46.810 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:13:46.810 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:13:46.811 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:46.811 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:46.811 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:13:46.811 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:13:46.811 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:46.811 +08:00 [DBG] Committing transaction.
2025-10-22 23:13:46.815 +08:00 [DBG] Committed transaction.
2025-10-22 23:13:46.815 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:46.817 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:46.817 +08:00 [DBG] Disposing transaction.
2025-10-22 23:13:46.817 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:46.817 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:13:46.817 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 1
2025-10-22 23:13:46.827 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:48.794 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:49.048 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:49.127 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:49.369 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:49.451 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:49.696 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:49.779 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:50.727 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:50.799 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:50.799 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:50.799 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:50.800 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:50.800 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:13:50.801 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:13:50.801 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:50.801 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:50.802 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:50.802 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:13:50.802 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:13:50.802 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:50.802 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:50.802 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:50.802 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:13:50.802 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:50.802 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:50.802 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:13:50.803 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:13:50.803 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:50.803 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:50.803 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:13:50.803 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:13:50.803 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:50.803 +08:00 [DBG] Committing transaction.
2025-10-22 23:13:50.807 +08:00 [DBG] Committed transaction.
2025-10-22 23:13:50.807 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:50.810 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:50.810 +08:00 [DBG] Disposing transaction.
2025-10-22 23:13:50.810 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:50.810 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:13:50.810 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 6
2025-10-22 23:13:50.839 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:54.973 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:55.053 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=3, Option=A, beforeSelected=1
2025-10-22 23:13:55.053 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=3, Option=A
2025-10-22 23:13:55.053 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=3, Option=A, afterSelected=1
2025-10-22 23:13:55.053 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:55.498 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:55.585 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=3, Option=C, beforeSelected=1
2025-10-22 23:13:55.585 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=3, Option=C
2025-10-22 23:13:55.585 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=3, Option=C, afterSelected=1
2025-10-22 23:13:55.585 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:56.065 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:56.185 +08:00 [INF] UI: SingleChoiceOption_Click begin: QIndex=3, Option=A, beforeSelected=1
2025-10-22 23:13:56.185 +08:00 [DBG] VM: SelectSingleOption short-circuit: QIndex=3, Option=A
2025-10-22 23:13:56.185 +08:00 [INF] UI: SingleChoiceOption_Click end: QIndex=3, Option=A, afterSelected=1
2025-10-22 23:13:56.185 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:58.087 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:13:58.135 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:58.135 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:58.135 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:58.136 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:58.136 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:13:58.137 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:13:58.137 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:58.137 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:58.138 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:58.138 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:13:58.138 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:13:58.138 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:58.138 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:58.139 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:13:58.139 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:13:58.139 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:58.139 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:58.139 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:13:58.140 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:13:58.140 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:13:58.140 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:13:58.140 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:13:58.140 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 1)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:13:58.140 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:13:58.140 +08:00 [DBG] Committing transaction.
2025-10-22 23:13:58.144 +08:00 [DBG] Committed transaction.
2025-10-22 23:13:58.144 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:13:58.147 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:13:58.147 +08:00 [DBG] Disposing transaction.
2025-10-22 23:13:58.147 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:13:58.147 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:13:58.147 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 4
2025-10-22 23:13:58.159 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:02.128 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:02.232 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:03.013 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:03.093 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:03.093 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:03.093 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:03.094 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:03.094 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:03.095 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:03.095 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:03.095 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:03.096 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:03.096 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:03.096 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:03.096 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:03.096 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:03.096 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:03.096 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:03.096 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:03.097 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:03.097 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:03.097 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:03.097 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:03.097 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:03.097 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:03.098 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:03.098 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:03.098 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:03.101 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:03.101 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:03.103 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:03.103 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:03.104 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:03.104 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:03.104 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 8
2025-10-22 23:14:03.116 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:08.892 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 23:14:08.894 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamRecord.CorrectCount (int) Required, 1], [Property: ExamRecord.CreatedAt (DateTime) Required, 2], [Property: ExamRecord.EndTime (Nullable<DateTime>), 3], [Property: ExamRecord.GradedAt (Nullable<DateTime>), 4], [Property: ExamRecord.GraderId (Nullable<int>) FK Index, 5], [Property: ExamRecord.IsPassed (bool) Required, 6], [Property: ExamRecord.ObjectiveScore (decimal) Required, 7], [Property: ExamRecord.PaperId (int) Required FK Index, 8], [Property: ExamRecord.RemainingTime (int) Required, 9], [Property: ExamRecord.StartTime (Nullable<DateTime>), 10], [Property: ExamRecord.Status (ExamStatus) Required, 11], [Property: ExamRecord.SubjectiveScore (decimal) Required, 12], [Property: ExamRecord.SubmitTime (Nullable<DateTime>), 13], [Property: ExamRecord.TotalCount (int) Required, 14], [Property: ExamRecord.TotalScore (decimal) Required, 15], [Property: ExamRecord.UserId (int) Required FK Index, 16], }
            SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId
            FROM ExamRecords AS e
            WHERE e.RecordId == @__recordId_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:14:08.894 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:08.894 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:08.894 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:08.895 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:08.895 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE "e"."RecordId" = @__recordId_0
LIMIT 1
2025-10-22 23:14:08.896 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE "e"."RecordId" = @__recordId_0
LIMIT 1
2025-10-22 23:14:08.896 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:08.897 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:08.897 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:08.897 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:08.897 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:08.897 +08:00 [DBG] The unchanged property 'ExamRecord.RemainingTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:08.897 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:08.897 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:08.897 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:08.898 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:08.898 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:08.898 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:08.899 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:08.899 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:08.899 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "RemainingTime" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 23:14:08.899 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "RemainingTime" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 23:14:08.899 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:08.899 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:08.903 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:08.903 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:08.905 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:08.905 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:08.905 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:08.905 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:09.463 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:09.551 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:10.374 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:10.715 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:10.787 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:10.787 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:10.788 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:10.788 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:10.788 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:10.789 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:10.789 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:10.789 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:10.790 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:10.790 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:10.790 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:10.792 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:10.792 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:10.792 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:10.792 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:10.792 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:10.793 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:10.793 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:10.793 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:10.793 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:10.793 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:10.794 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:10.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 4)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:10.794 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:10.794 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:10.797 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:10.798 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:10.800 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:10.800 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:10.800 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:10.800 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:10.800 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 10
2025-10-22 23:14:10.822 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:11.606 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:11.695 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:12.471 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:12.719 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:13.045 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:13.136 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:13.349 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:14.616 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:14.679 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:14.679 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:14.679 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:14.680 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:14.680 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:14.681 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:14.681 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:14.681 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:14.682 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:14.682 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:14.682 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:14.682 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:14.682 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:14.682 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:14.682 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:14.682 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:14.682 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:14.682 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:14.683 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:14.683 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:14.683 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:14.683 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:14.683 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 5)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:14.683 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:14.683 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:14.688 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:14.688 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:14.690 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:14.690 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:14.690 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:14.690 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:14.690 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 12
2025-10-22 23:14:14.708 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:15.366 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:15.463 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:15.839 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:15.964 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:15.992 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:16.006 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:16.139 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:17.021 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:17.327 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:17.439 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:17.549 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:17.605 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:18.495 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:18.547 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:18.547 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:18.547 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:18.548 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:18.548 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:18.549 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:18.549 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:18.549 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:18.550 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:18.550 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:18.550 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:18.550 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:18.551 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:18.551 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:18.551 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:18.551 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:18.551 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:18.551 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:18.552 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:18.552 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:18.552 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:18.552 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:18.552 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:18.552 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:18.552 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:18.556 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:18.556 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:18.558 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:18.558 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:18.558 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:18.558 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:18.558 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 14
2025-10-22 23:14:18.581 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:19.024 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:19.093 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:19.607 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:19.720 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:19.899 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:19.921 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:20.080 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:20.150 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:20.344 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:20.512 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:20.873 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:20.956 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:22.334 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:22.409 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:22.409 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:22.409 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:22.409 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:22.410 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:22.411 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:22.411 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:22.411 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:22.412 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:22.412 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:22.412 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:22.412 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:22.412 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:22.412 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:22.412 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:22.412 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:22.412 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:22.412 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:22.413 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:22.413 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:22.413 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:22.413 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:22.413 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:22.414 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:22.414 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:22.417 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:22.417 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:22.419 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:22.419 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:22.419 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:22.419 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:22.419 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 49
2025-10-22 23:14:22.435 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:23.098 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:23.183 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:24.016 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:24.197 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:24.363 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:24.554 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:24.811 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:24.934 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:25.185 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:27.563 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:27.660 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:28.618 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.618 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.618 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.618 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.618 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:28.620 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:14:28.620 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.620 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.621 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.621 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:28.621 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:28.621 +08:00 [DBG] The unchanged property 'AnswerRecord.AnswerTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.621 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.621 +08:00 [DBG] The unchanged property 'AnswerRecord.UserAnswer' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.621 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:28.621 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.621 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.621 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:28.622 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:28.622 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.622 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.622 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.623 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?' (Size = 6)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "UserAnswer" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.623 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.623 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:28.626 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:28.626 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.629 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.629 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:28.629 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.629 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:28.629 +08:00 [DBG] 保存答案成功，记录ID: 7，题目ID: 48
2025-10-22 23:14:28.630 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.630 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.630 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.630 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.630 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE "e"."RecordId" = @__recordId_0
LIMIT 1
2025-10-22 23:14:28.631 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId"
FROM "ExamRecords" AS "e"
WHERE "e"."RecordId" = @__recordId_0
LIMIT 1
2025-10-22 23:14:28.631 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.631 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.632 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.632 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:28.632 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:28.632 +08:00 [DBG] The unchanged property 'ExamRecord.EndTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.632 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.632 +08:00 [DBG] The unchanged property 'ExamRecord.Status' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.632 +08:00 [DBG] The unchanged property 'ExamRecord.SubmitTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.632 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:28.632 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.632 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.632 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:28.633 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:28.633 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.633 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.633 +08:00 [DBG] Executing DbCommand [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "EndTime" = @p0, "Status" = @p1, "SubmitTime" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 23:14:28.634 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "EndTime" = @p0, "Status" = @p1, "SubmitTime" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 23:14:28.634 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.634 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:28.637 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:28.637 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.639 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.639 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:28.639 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.639 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:28.640 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .Where(ar => ar.RecordId == __recordId_0 && !(ar.IsGraded))'
2025-10-22 23:14:28.640 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:14:28.644 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        WHERE (a.RecordId == @__recordId_0) && Not(a.IsGraded)), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:14:28.644 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.644 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.644 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.645 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.645 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:14:28.646 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:14:28.646 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.646 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.646 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.647 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .ThenInclude(p => p.PaperQuestions)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 23:14:28.647 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:14:28.647 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 23:14:28.651 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN PaperQuestions AS p ON t.PaperId0 == p.PaperId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, p.Id ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:14:28.651 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.651 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.652 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.652 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.652 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:14:28.653 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:14:28.653 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.653 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.653 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.654 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Where(ar => ar.RecordId == __recordId_0)
    .All(ar => ar.IsGraded)'
2025-10-22 23:14:28.655 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT NOT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM AnswerRecords AS a
                WHERE (a.RecordId == @__recordId_0) && Not(a.IsGraded))), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:14:28.655 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.655 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.655 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.656 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.656 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:14:28.656 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:14:28.656 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.656 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.657 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.657 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:28.657 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'ExamRecord.CorrectCount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'ExamRecord.ObjectiveScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'ExamRecord.TotalScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.IsCorrect' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.Score' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.GradeTime' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.657 +08:00 [DBG] The unchanged property 'AnswerRecord.IsGraded' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:28.657 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:28.657 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.658 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.658 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:28.658 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:28.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.659 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.659 +08:00 [DBG] Executing DbCommand [Parameters=[@p4='?', @p0='?', @p1='?', @p2='?', @p3='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsCorrect" = @p1, "IsGraded" = @p2, "Score" = @p3
WHERE "AnswerId" = @p4;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p4='?', @p0='?', @p1='?', @p2='?', @p3='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsCorrect" = @p1, "IsGraded" = @p2, "Score" = @p3
WHERE "AnswerId" = @p4;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.659 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.659 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.659 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.659 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "GradeTime" = @p0, "IsGraded" = @p1
WHERE "AnswerId" = @p2;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.659 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:28.659 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:28.659 +08:00 [DBG] Executing DbCommand [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "ObjectiveScore" = @p1, "TotalScore" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "ObjectiveScore" = @p1, "TotalScore" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 23:14:28.659 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:28.659 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:28.664 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:28.664 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:28.666 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:28.666 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:28.666 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.666 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.666 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.666 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.666 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.666 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.666 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:28.666 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 7 entities written to the database.
2025-10-22 23:14:28.666 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 3
2025-10-22 23:14:28.667 +08:00 [INF] 考试提交成功，记录ID: 7
2025-10-22 23:14:28.683 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:29.310 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:30.378 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:30.451 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 23:14:30.605 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:31.136 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:31.548 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:32.581 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:32.596 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:32.765 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:32.919 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.090 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.152 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.338 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.431 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.596 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.616 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.821 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:33.933 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:34.032 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:34.127 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:34.349 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:34.488 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:34.587 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:34.711 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:34.923 +08:00 [INF] === 开始登录流程 ===
2025-10-22 23:14:34.923 +08:00 [INF] 用户名: teacher
2025-10-22 23:14:34.923 +08:00 [INF] 密码长度: 7
2025-10-22 23:14:34.923 +08:00 [INF] AuthService是否为null: False
2025-10-22 23:14:34.923 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 23:14:34.923 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 23:14:34.923 +08:00 [INF] 接收到的用户名: teacher
2025-10-22 23:14:34.923 +08:00 [INF] 接收到的密码长度: 7
2025-10-22 23:14:34.923 +08:00 [INF] 开始查询用户
2025-10-22 23:14:34.923 +08:00 [INF] UserRepository是否为null: False
2025-10-22 23:14:34.923 +08:00 [INF] Context是否为null: False
2025-10-22 23:14:34.923 +08:00 [INF] 测试数据库连接...
2025-10-22 23:14:34.923 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:34.924 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:34.924 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 23:14:34.924 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:34.924 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:34.924 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:34.924 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:34.924 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:14:34.926 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:14:34.926 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:34.926 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:34.926 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:34.926 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 23:14:34.927 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:34.927 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:34.927 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:34.927 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:34.927 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:14:34.928 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:14:34.928 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:34.928 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:34.928 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:34.928 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:34.928 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 23:14:34.928 +08:00 [INF] 用户ID: 3, 用户名: teacher, 角色: Teacher
2025-10-22 23:14:34.928 +08:00 [INF] 用户是否激活: True
2025-10-22 23:14:34.928 +08:00 [INF] 登录失败次数: 0
2025-10-22 23:14:34.928 +08:00 [INF] 检查账户锁定状态
2025-10-22 23:14:34.929 +08:00 [INF] 开始验证密码
2025-10-22 23:14:34.929 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 23:14:34.929 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 23:14:34.929 +08:00 [INF] 密码哈希前20字符: $2a$12$P//.sCdhJ9kzi...
2025-10-22 23:14:34.929 +08:00 [INF] 开始验证密码 - 用户: teacher
2025-10-22 23:14:34.929 +08:00 [INF] 密码哈希长度: 60
2025-10-22 23:14:34.929 +08:00 [INF] 密码哈希前缀: $2a$12$P//
2025-10-22 23:14:35.100 +08:00 [INF] 密码验证结果: False
2025-10-22 23:14:35.100 +08:00 [WRN] 密码验证失败，失败次数增加到: 1
2025-10-22 23:14:35.100 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:35.100 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:35.100 +08:00 [DBG] The unchanged property 'User.LoginFailCount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:35.100 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:35.101 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:35.101 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:35.101 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:35.101 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:35.102 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:35.102 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:35.102 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:35.102 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LoginFailCount" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:14:35.103 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LoginFailCount" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:14:35.103 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:35.103 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:35.106 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:35.107 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:35.109 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:35.109 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:35.109 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:35.109 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:35.109 +08:00 [WRN] 登录失败：密码错误 - teacher
2025-10-22 23:14:35.109 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 23:14:35.109 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 23:14:35.109 +08:00 [INF] 成功: False
2025-10-22 23:14:35.109 +08:00 [INF] 消息: 用户名或密码错误
2025-10-22 23:14:35.109 +08:00 [INF] 用户对象是否为null: True
2025-10-22 23:14:35.109 +08:00 [WRN] 用户 teacher 登录失败: 用户名或密码错误
2025-10-22 23:14:35.109 +08:00 [INF] === 登录流程结束 ===
2025-10-22 23:14:35.122 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:36.488 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:36.602 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:36.699 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:36.728 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:36.921 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:36.944 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:37.025 +08:00 [INF] === 开始登录流程 ===
2025-10-22 23:14:37.025 +08:00 [INF] 用户名: teacher
2025-10-22 23:14:37.025 +08:00 [INF] 密码长度: 10
2025-10-22 23:14:37.025 +08:00 [INF] AuthService是否为null: False
2025-10-22 23:14:37.025 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 23:14:37.025 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 23:14:37.025 +08:00 [INF] 接收到的用户名: teacher
2025-10-22 23:14:37.025 +08:00 [INF] 接收到的密码长度: 10
2025-10-22 23:14:37.025 +08:00 [INF] 开始查询用户
2025-10-22 23:14:37.025 +08:00 [INF] UserRepository是否为null: False
2025-10-22 23:14:37.025 +08:00 [INF] Context是否为null: False
2025-10-22 23:14:37.025 +08:00 [INF] 测试数据库连接...
2025-10-22 23:14:37.026 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.026 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.026 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 23:14:37.026 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:37.026 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:37.026 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.026 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.026 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:14:37.028 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:14:37.028 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:37.028 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.029 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.029 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 23:14:37.029 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:37.029 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:37.029 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.029 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.029 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:14:37.030 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:14:37.031 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:37.031 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.031 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.031 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 23:14:37.031 +08:00 [INF] 用户ID: 3, 用户名: teacher, 角色: Teacher
2025-10-22 23:14:37.031 +08:00 [INF] 用户是否激活: True
2025-10-22 23:14:37.031 +08:00 [INF] 登录失败次数: 1
2025-10-22 23:14:37.031 +08:00 [INF] 检查账户锁定状态
2025-10-22 23:14:37.031 +08:00 [INF] 开始验证密码
2025-10-22 23:14:37.031 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 23:14:37.031 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 23:14:37.031 +08:00 [INF] 密码哈希前20字符: $2a$12$P//.sCdhJ9kzi...
2025-10-22 23:14:37.031 +08:00 [INF] 开始验证密码 - 用户: teacher
2025-10-22 23:14:37.031 +08:00 [INF] 密码哈希长度: 60
2025-10-22 23:14:37.031 +08:00 [INF] 密码哈希前缀: $2a$12$P//
2025-10-22 23:14:37.206 +08:00 [INF] 密码验证结果: True
2025-10-22 23:14:37.206 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 23:14:37.206 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:14:37.206 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:14:37.207 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:37.207 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:37.207 +08:00 [DBG] The unchanged property 'User.LoginFailCount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:14:37.207 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:14:37.207 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.208 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.208 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:14:37.209 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:14:37.209 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:37.209 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:37.209 +08:00 [DBG] Executing DbCommand [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0, "LoginFailCount" = @p1
WHERE "UserId" = @p2;
SELECT changes();
2025-10-22 23:14:37.210 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p2='?', @p0='?', @p1='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0, "LoginFailCount" = @p1
WHERE "UserId" = @p2;
SELECT changes();
2025-10-22 23:14:37.210 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:37.210 +08:00 [DBG] Committing transaction.
2025-10-22 23:14:37.214 +08:00 [DBG] Committed transaction.
2025-10-22 23:14:37.214 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.217 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.217 +08:00 [DBG] Disposing transaction.
2025-10-22 23:14:37.217 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:14:37.217 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:14:37.217 +08:00 [INF] 用户信息更新完成
2025-10-22 23:14:37.217 +08:00 [INF] 用户登录成功 - teacher
2025-10-22 23:14:37.217 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 23:14:37.217 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 23:14:37.217 +08:00 [INF] 成功: True
2025-10-22 23:14:37.217 +08:00 [INF] 消息: 登录成功
2025-10-22 23:14:37.217 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:14:37.217 +08:00 [INF] 用户 teacher 登录成功
2025-10-22 23:14:37.217 +08:00 [INF] 上次登录时间: 2025-10-21 23:42:30
2025-10-22 23:14:37.217 +08:00 [INF] 触发登录成功事件
2025-10-22 23:14:37.217 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 23:14:37.217 +08:00 [INF] 登录成功的用户: teacher (Teacher)
2025-10-22 23:14:37.217 +08:00 [INF] 用户ID: 3
2025-10-22 23:14:37.217 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:14:37.219 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 23:14:37.219 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 23:14:37.222 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:37.222 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:37.222 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.222 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.223 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:14:37.224 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:14:37.224 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:37.224 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.225 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.227 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 23:14:37.227 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 23:14:37.227 +08:00 [INF] 接收到的用户: teacher (Teacher)
2025-10-22 23:14:37.227 +08:00 [INF] 用户ID: 3
2025-10-22 23:14:37.227 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:14:37.227 +08:00 [INF] 设置后的CurrentUser: teacher (Teacher)
2025-10-22 23:14:37.227 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 23:14:37.227 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 23:14:37.227 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:37.227 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:37.227 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.228 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.228 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:37.229 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:37.229 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:37.229 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:37.229 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:37.229 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 23:14:37.240 +08:00 [INF] 所有页面加载完成
2025-10-22 23:14:37.240 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 23:14:37.240 +08:00 [INF] 当前用户: teacher (Teacher)
2025-10-22 23:14:37.240 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 23:14:37.240 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 23:14:37.240 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 23:14:37.240 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 23:14:37.240 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 23:14:37.240 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 23:14:37.240 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 23:14:37.240 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 23:14:37.240 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 23:14:37.240 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 23:14:37.240 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 23:14:37.245 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:37.257 +08:00 [INF] 关闭登录窗口
2025-10-22 23:14:37.259 +08:00 [INF] === 登录流程结束 ===
2025-10-22 23:14:37.278 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:37.279 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:38.270 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:38.271 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:38.398 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:38.398 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:39.253 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:39.253 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:39.253 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:39.253 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:39.253 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:39.255 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:39.255 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:39.255 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:39.255 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:39.255 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:39.256 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:39.256 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:39.256 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:39.256 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:39.257 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:39.257 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:39.257 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:39.257 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:39.272 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:39.272 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:39.397 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:39.398 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:40.749 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:40.749 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:40.792 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:40.792 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:40.792 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:40.792 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:40.792 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:40.794 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:40.794 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:40.794 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:40.795 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:40.795 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:40.795 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:40.795 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:40.795 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:40.795 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:40.796 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:40.796 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:40.796 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:40.797 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:40.813 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:40.813 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:41.363 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:41.363 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:41.363 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:41.364 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:41.364 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:41.365 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:41.365 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:41.365 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:41.366 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:41.366 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:41.366 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:41.366 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:41.366 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:41.366 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:41.367 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:41.367 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:41.367 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:41.368 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:41.389 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:41.390 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:42.638 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:42.639 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:42.666 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:42.667 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:43.848 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:43.848 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:44.192 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:44.192 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:44.710 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:44.711 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:44.795 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:44.795 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:44.918 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:44.919 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:45.103 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:45.103 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:45.430 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:45.430 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:45.681 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:45.681 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:46.115 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:46.116 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:46.171 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:46.172 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:46.308 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:46.308 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:46.407 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:46.408 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:46.469 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:46.470 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:46.504 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:46.504 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:46.909 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:46.909 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:47.559 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:47.560 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:48.027 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:48.027 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:48.090 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:48.090 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:48.509 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:48.509 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:48.758 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:48.758 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:49.314 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:49.314 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:49.372 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:49.372 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:49.372 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.372 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.372 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:49.374 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:49.374 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:49.374 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.374 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.374 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:49.374 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:49.374 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.375 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.375 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:49.375 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:49.375 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:49.376 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.376 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.380 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:49.380 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:49.795 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:49.795 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:49.795 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.796 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.796 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:49.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:49.797 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:49.797 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.798 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.798 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:49.798 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:49.798 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.798 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.798 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:49.799 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:49.799 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:49.799 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:49.800 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:49.808 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:49.809 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:50.003 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:50.003 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:50.003 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:50.004 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:50.004 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:50.007 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:14:50.007 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:50.007 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:50.008 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:50.008 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:50.008 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:50.008 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:50.008 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:50.008 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:50.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:14:50.009 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:50.009 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:50.010 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:50.041 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:50.042 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:54.574 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:54.575 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:54.746 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:54.746 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:57.184 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:57.184 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:14:57.268 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:57.269 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:57.269 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:57.269 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:57.269 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:14:57.271 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:14:57.271 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:57.271 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:57.272 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:57.272 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:14:57.272 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:14:57.272 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:57.272 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:57.272 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 23:14:57.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 23:14:57.273 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:14:57.273 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:14:57.274 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:14:57.314 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:14:57.314 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:18.880 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:18.881 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:20.686 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:20.687 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:32.439 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:32.439 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:33.634 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:33.635 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:43.290 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:43.290 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:44.353 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:44.354 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:44.439 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 23:15:44.522 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:44.522 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:45.574 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:45.574 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:46.352 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:46.353 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:46.553 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:46.554 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:46.911 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:46.912 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.036 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.037 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.147 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.147 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.336 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.337 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.477 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.477 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.554 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.554 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.664 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.665 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.755 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.756 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:47.859 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:47.860 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.026 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.027 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.222 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.222 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.403 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.403 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.484 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.484 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.517 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.517 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.680 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.681 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.813 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.813 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:48.876 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:48.876 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:49.140 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:49.140 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:49.233 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:49.233 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:49.388 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:49.388 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:49.532 +08:00 [INF] === 开始登录流程 ===
2025-10-22 23:15:49.532 +08:00 [INF] 用户名: student
2025-10-22 23:15:49.532 +08:00 [INF] 密码长度: 10
2025-10-22 23:15:49.532 +08:00 [INF] AuthService是否为null: False
2025-10-22 23:15:49.532 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 23:15:49.532 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 23:15:49.532 +08:00 [INF] 接收到的用户名: student
2025-10-22 23:15:49.532 +08:00 [INF] 接收到的密码长度: 10
2025-10-22 23:15:49.532 +08:00 [INF] 开始查询用户
2025-10-22 23:15:49.532 +08:00 [INF] UserRepository是否为null: False
2025-10-22 23:15:49.532 +08:00 [INF] Context是否为null: False
2025-10-22 23:15:49.532 +08:00 [INF] 测试数据库连接...
2025-10-22 23:15:49.532 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.532 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.532 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 23:15:49.533 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.533 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.533 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.533 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.533 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:15:49.534 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:15:49.534 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.534 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.535 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.535 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 23:15:49.535 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.535 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.535 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.536 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.536 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:15:49.537 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:15:49.537 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.537 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.537 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.537 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 23:15:49.537 +08:00 [INF] 用户ID: 2, 用户名: student, 角色: Student
2025-10-22 23:15:49.537 +08:00 [INF] 用户是否激活: True
2025-10-22 23:15:49.537 +08:00 [INF] 登录失败次数: 0
2025-10-22 23:15:49.537 +08:00 [INF] 检查账户锁定状态
2025-10-22 23:15:49.537 +08:00 [INF] 开始验证密码
2025-10-22 23:15:49.537 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 23:15:49.537 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 23:15:49.537 +08:00 [INF] 密码哈希前20字符: $2a$12$iXseHsdkCBsHc...
2025-10-22 23:15:49.537 +08:00 [INF] 开始验证密码 - 用户: student
2025-10-22 23:15:49.537 +08:00 [INF] 密码哈希长度: 60
2025-10-22 23:15:49.537 +08:00 [INF] 密码哈希前缀: $2a$12$iXs
2025-10-22 23:15:49.709 +08:00 [INF] 密码验证结果: True
2025-10-22 23:15:49.709 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 23:15:49.709 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:15:49.709 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:15:49.709 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:15:49.709 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:15:49.709 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:15:49.709 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.710 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.710 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:15:49.711 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:15:49.711 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.711 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.711 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:15:49.711 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:15:49.711 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.711 +08:00 [DBG] Committing transaction.
2025-10-22 23:15:49.716 +08:00 [DBG] Committed transaction.
2025-10-22 23:15:49.716 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.718 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.719 +08:00 [DBG] Disposing transaction.
2025-10-22 23:15:49.719 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:15:49.719 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:15:49.719 +08:00 [INF] 用户信息更新完成
2025-10-22 23:15:49.719 +08:00 [INF] 用户登录成功 - student
2025-10-22 23:15:49.719 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 23:15:49.719 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 23:15:49.719 +08:00 [INF] 成功: True
2025-10-22 23:15:49.719 +08:00 [INF] 消息: 登录成功
2025-10-22 23:15:49.719 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:15:49.719 +08:00 [INF] 用户 student 登录成功
2025-10-22 23:15:49.719 +08:00 [INF] 上次登录时间: 2025-10-22 23:13:34
2025-10-22 23:15:49.719 +08:00 [INF] 触发登录成功事件
2025-10-22 23:15:49.719 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 23:15:49.719 +08:00 [INF] 登录成功的用户: student (Student)
2025-10-22 23:15:49.719 +08:00 [INF] 用户ID: 2
2025-10-22 23:15:49.719 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:15:49.720 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 23:15:49.720 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 23:15:49.720 +08:00 [INF] PermissionService.HasPermission: Role=Student, Operation=ViewOwnGrades, Result=True
2025-10-22 23:15:49.721 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.721 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.721 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.722 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.722 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:15:49.723 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:15:49.723 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.723 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.723 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.725 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 23:15:49.725 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 23:15:49.725 +08:00 [INF] 接收到的用户: student (Student)
2025-10-22 23:15:49.725 +08:00 [INF] 用户ID: 2
2025-10-22 23:15:49.725 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:15:49.725 +08:00 [INF] 设置后的CurrentUser: student (Student)
2025-10-22 23:15:49.725 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 23:15:49.725 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 23:15:49.725 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.725 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.725 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.725 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.725 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:15:49.726 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:15:49.726 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.726 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.727 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.727 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 23:15:49.728 +08:00 [INF] StudentExamListViewModel 在构造时获取到当前用户: student (ID=2)
2025-10-22 23:15:49.728 +08:00 [INF] 开始加载学生可参加的考试列表，用户ID: 2
2025-10-22 23:15:49.728 +08:00 [INF] 开始获取已发布的试卷列表
2025-10-22 23:15:49.728 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.728 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.728 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.729 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.729 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 23:15:49.730 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "t"."Id", "t"."OrderIndex", "t"."PaperId", "t"."QuestionId", "t"."Score", "t"."QuestionId0", "t"."Analysis", "t"."Answer", "t"."BankId", "t"."Content", "t"."CreatedAt", "t"."Difficulty", "t"."IsActive", "t"."QuestionType", "t"."Score0", "t"."Tags", "t"."Title", "t"."UpdatedAt"
FROM "ExamPapers" AS "e"
INNER JOIN "Users" AS "u" ON "e"."CreatorId" = "u"."UserId"
LEFT JOIN (
    SELECT "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "PaperQuestions" AS "p"
    INNER JOIN "Questions" AS "q" ON "p"."QuestionId" = "q"."QuestionId"
) AS "t" ON "e"."PaperId" = "t"."PaperId"
WHERE "e"."IsPublished"
ORDER BY "e"."CreatedAt" DESC, "e"."PaperId", "u"."UserId", "t"."Id", "t"."QuestionId0"
2025-10-22 23:15:49.730 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.730 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.731 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.731 +08:00 [INF] 成功获取 1 个已发布的试卷
2025-10-22 23:15:49.731 +08:00 [INF] 成功加载 1 个可参加的考试
2025-10-22 23:15:49.734 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.734 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.734 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.734 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.734 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 23:15:49.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "NotificationRecipients" AS "n"
WHERE "n"."ReceiverId" = @__receiverId_0
2025-10-22 23:15:49.735 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.735 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.735 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.735 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:15:49.735 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:15:49.735 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.736 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.736 +08:00 [DBG] Executing DbCommand [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 23:15:49.737 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__receiverId_0='?', @__p_2='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."NotificationRecipientId", "t"."CreatedAt", "t"."DeliveryStatus", "t"."NotificationId", "t"."ReadAt", "t"."ReceiverId", "t"."NotificationId0", "t"."Content", "t"."CreatedAt0", "t"."Priority", "t"."Scope", "t"."SenderId", "t"."Status", "t"."Title", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM (
    SELECT "n"."NotificationRecipientId", "n"."CreatedAt", "n"."DeliveryStatus", "n"."NotificationId", "n"."ReadAt", "n"."ReceiverId", "n0"."NotificationId" AS "NotificationId0", "n0"."Content", "n0"."CreatedAt" AS "CreatedAt0", "n0"."Priority", "n0"."Scope", "n0"."SenderId", "n0"."Status", "n0"."Title"
    FROM "NotificationRecipients" AS "n"
    INNER JOIN "Notifications" AS "n0" ON "n"."NotificationId" = "n0"."NotificationId"
    WHERE "n"."ReceiverId" = @__receiverId_0
    ORDER BY "n0"."CreatedAt" DESC
    LIMIT @__p_2 OFFSET @__p_1
) AS "t"
INNER JOIN "Users" AS "u" ON "t"."SenderId" = "u"."UserId"
ORDER BY "t"."CreatedAt0" DESC
2025-10-22 23:15:49.737 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:15:49.737 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:15:49.737 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:15:49.741 +08:00 [INF] 所有页面加载完成
2025-10-22 23:15:49.741 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 23:15:49.741 +08:00 [INF] 当前用户: student (Student)
2025-10-22 23:15:49.741 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 23:15:49.741 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 23:15:49.741 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 23:15:49.741 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 23:15:49.741 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 23:15:49.741 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 23:15:49.741 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 23:15:49.741 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 23:15:49.741 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 23:15:49.741 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 23:15:49.741 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 23:15:49.765 +08:00 [INF] 关闭登录窗口
2025-10-22 23:15:49.766 +08:00 [INF] === 登录流程结束 ===
2025-10-22 23:15:49.778 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:49.778 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:49.786 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:49.786 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:50.738 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:50.738 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:50.895 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:50.896 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:52.449 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:52.449 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:52.903 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:52.903 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:53.533 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:53.533 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:53.651 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:53.652 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:54.469 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:54.470 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:54.543 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 23:15:54.626 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:54.627 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:55.718 +08:00 [INF] PermissionService.HasPermission: Role=Admin, Operation=SendNotification, Result=True
2025-10-22 23:15:55.718 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:15:55.811 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 23:22:08.997 +08:00 [DBG] Hosting starting
2025-10-22 23:22:09.016 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-22 23:22:09.017 +08:00 [INF] Hosting environment: Production
2025-10-22 23:22:09.017 +08:00 [INF] Content root path: E:\Project\exam_trae
2025-10-22 23:22:09.017 +08:00 [DBG] Hosting started
2025-10-22 23:22:09.057 +08:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-22 23:22:09.198 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:22:09.212 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:22:09.273 +08:00 [DBG] No relationship from 'ExamRecord' to 'User' has been configured by convention because there are multiple properties on one entity type {'Grader', 'User'} that could be matched with the properties on the other entity type {'ExamRecords'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:22:09.273 +08:00 [DBG] No relationship from 'User' to 'ExamRecord' has been configured by convention because there are multiple properties on one entity type {'ExamRecords'} that could be matched with the properties on the other entity type {'Grader', 'User'}. This message can be disregarded if explicit configuration has been specified in 'OnModelCreating'.
2025-10-22 23:22:09.297 +08:00 [DBG] The index {'NotificationId'} was not created on entity type 'NotificationRecipient' as the properties are already covered by the index {'NotificationId', 'ReceiverId'}.
2025-10-22 23:22:09.410 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 23:22:09.439 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.442 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.447 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.455 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:22:09.458 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-22 23:22:09.460 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.462 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.466 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.475 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.477 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.477 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.479 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.479 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.480 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:22:09.480 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 23:22:09.480 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.480 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.480 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.481 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.482 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.486 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:22:09.486 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:22:09.486 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.486 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.486 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:22:09.488 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:22:09.489 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:22:09.489 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.489 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.496 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 23:22:09.497 +08:00 [DBG] Migrating using database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.498 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.498 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.498 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:22:09.498 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 23:22:09.498 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.498 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.498 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.499 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.499 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.499 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.499 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.500 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.500 +08:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-22 23:22:09.500 +08:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-22 23:22:09.500 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.500 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.500 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.501 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-10-22 23:22:09.501 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.501 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.501 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:22:09.501 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:22:09.501 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.502 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.502 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:22:09.503 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-22 23:22:09.503 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:22:09.503 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.503 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.503 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-10-22 23:22:09.523 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 2)'
2025-10-22 23:22:09.620 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 2)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:22:09.631 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:22:09.631 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:22:09.631 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.632 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.632 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 23:22:09.633 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 2)
2025-10-22 23:22:09.634 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:22:09.634 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.634 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.634 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 0)'
2025-10-22 23:22:09.635 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 0)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:22:09.635 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:22:09.635 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:22:09.635 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.636 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.636 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 23:22:09.637 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 0)
2025-10-22 23:22:09.637 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:22:09.637 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.638 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.638 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(u => (int)u.Role == 1)'
2025-10-22 23:22:09.638 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM Users AS u
                WHERE u.Role == 1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:22:09.638 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:22:09.638 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:22:09.638 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.639 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.639 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 23:22:09.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Users" AS "u"
    WHERE "u"."Role" = 1)
2025-10-22 23:22:09.640 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:22:09.640 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:22:09.640 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:22:09.641 +08:00 [DBG] 'ExamDbContext' disposed.
2025-10-22 23:22:09.642 +08:00 [INF] Entity Framework Core 5.0.17 initialized 'ExamDbContext' using provider 'Microsoft.EntityFrameworkCore.Sqlite' with options: MigrationsAssembly=ExamSystem.Infrastructure 
2025-10-22 23:23:20.409 +08:00 [INF] === 开始登录流程 ===
2025-10-22 23:23:20.409 +08:00 [INF] 用户名: teacher
2025-10-22 23:23:20.409 +08:00 [INF] 密码长度: 10
2025-10-22 23:23:20.409 +08:00 [INF] AuthService是否为null: False
2025-10-22 23:23:20.409 +08:00 [INF] 调用AuthService.LoginAsync方法
2025-10-22 23:23:20.411 +08:00 [INF] === AuthService.LoginAsync 开始 ===
2025-10-22 23:23:20.411 +08:00 [INF] 接收到的用户名: teacher
2025-10-22 23:23:20.411 +08:00 [INF] 接收到的密码长度: 10
2025-10-22 23:23:20.411 +08:00 [INF] 开始查询用户
2025-10-22 23:23:20.411 +08:00 [INF] UserRepository是否为null: False
2025-10-22 23:23:20.411 +08:00 [INF] Context是否为null: False
2025-10-22 23:23:20.411 +08:00 [INF] 测试数据库连接...
2025-10-22 23:23:20.412 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.413 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.413 +08:00 [INF] 数据库连接测试结果: True
2025-10-22 23:23:20.413 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Count()'
2025-10-22 23:23:20.417 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<int>(
    asyncEnumerable: new SingleQueryingEnumerable<int>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT COUNT(*)
            FROM Users AS u), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, int>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:23:20.420 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:20.420 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:20.420 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.420 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.420 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:23:20.422 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Users" AS "u"
2025-10-22 23:23:20.422 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:20.422 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.423 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.423 +08:00 [INF] 数据库中用户总数: 3
2025-10-22 23:23:20.424 +08:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Username == __username_0)'
2025-10-22 23:23:20.436 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.UserId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required, 1], [Property: User.Email (string) Index MaxLength(200), 2], [Property: User.IsActive (bool) Required, 3], [Property: User.LastLoginAt (Nullable<DateTime>), 4], [Property: User.LockoutEnd (Nullable<DateTime>), 5], [Property: User.LoginFailCount (int) Required, 6], [Property: User.PasswordHash (string) Required MaxLength(255), 7], [Property: User.Phone (string) MaxLength(20), 8], [Property: User.RealName (string) MaxLength(100), 9], [Property: User.Role (UserRole) Required, 10], [Property: User.Username (string) Required Index MaxLength(50), 11], }
            SELECT TOP(1) u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
            FROM Users AS u
            WHERE u.Username == @__username_0), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:23:20.439 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:20.439 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:20.440 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.440 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.441 +08:00 [DBG] Executing DbCommand [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:23:20.443 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__username_0='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0
LIMIT 1
2025-10-22 23:23:20.447 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:20.468 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:20.468 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.469 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.469 +08:00 [INF] 用户查询结果: 找到用户
2025-10-22 23:23:20.470 +08:00 [INF] 用户ID: 3, 用户名: teacher, 角色: Teacher
2025-10-22 23:23:20.470 +08:00 [INF] 用户是否激活: True
2025-10-22 23:23:20.470 +08:00 [INF] 登录失败次数: 0
2025-10-22 23:23:20.470 +08:00 [INF] 检查账户锁定状态
2025-10-22 23:23:20.471 +08:00 [INF] 开始验证密码
2025-10-22 23:23:20.471 +08:00 [INF] 存储的密码哈希长度: 60
2025-10-22 23:23:20.471 +08:00 [INF] 密码哈希是否为空: False
2025-10-22 23:23:20.471 +08:00 [INF] 密码哈希前20字符: $2a$12$P//.sCdhJ9kzi...
2025-10-22 23:23:20.471 +08:00 [INF] 开始验证密码 - 用户: teacher
2025-10-22 23:23:20.471 +08:00 [INF] 密码哈希长度: 60
2025-10-22 23:23:20.471 +08:00 [INF] 密码哈希前缀: $2a$12$P//
2025-10-22 23:23:20.650 +08:00 [INF] 密码验证结果: True
2025-10-22 23:23:20.650 +08:00 [INF] 密码验证成功，更新用户信息
2025-10-22 23:23:20.651 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:20.652 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:20.658 +08:00 [DBG] The unchanged property 'User.LastLoginAt' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:23:20.663 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:20.666 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:20.673 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.673 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.674 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:23:20.676 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:23:20.694 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:20.694 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:20.694 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:23:20.695 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "LastLoginAt" = @p0
WHERE "UserId" = @p1;
SELECT changes();
2025-10-22 23:23:20.698 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:20.699 +08:00 [DBG] Committing transaction.
2025-10-22 23:23:20.704 +08:00 [DBG] Committed transaction.
2025-10-22 23:23:20.704 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.708 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.708 +08:00 [DBG] Disposing transaction.
2025-10-22 23:23:20.712 +08:00 [DBG] An entity of type 'User' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:20.712 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:23:20.712 +08:00 [INF] 用户信息更新完成
2025-10-22 23:23:20.712 +08:00 [INF] 用户登录成功 - teacher
2025-10-22 23:23:20.712 +08:00 [INF] === AuthService.LoginAsync 结束 ===
2025-10-22 23:23:20.713 +08:00 [INF] === 登录服务返回结果 ===
2025-10-22 23:23:20.713 +08:00 [INF] 成功: True
2025-10-22 23:23:20.713 +08:00 [INF] 消息: 登录成功
2025-10-22 23:23:20.713 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:23:20.713 +08:00 [INF] 用户 teacher 登录成功
2025-10-22 23:23:20.715 +08:00 [INF] 上次登录时间: 2025-10-22 23:14:37
2025-10-22 23:23:20.715 +08:00 [INF] 触发登录成功事件
2025-10-22 23:23:20.715 +08:00 [INF] === LoginWindow.OnLoginSuccess ===
2025-10-22 23:23:20.716 +08:00 [INF] 登录成功的用户: teacher (Teacher)
2025-10-22 23:23:20.717 +08:00 [INF] 用户ID: 3
2025-10-22 23:23:20.717 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:23:20.729 +08:00 [INF] MainWindow 构造函数完成，延迟加载页面直到用户登录
2025-10-22 23:23:20.729 +08:00 [INF] 获取到MainWindow实例，准备设置用户信息
2025-10-22 23:23:20.740 +08:00 [DBG] Compiling query expression: 
'DbSet<QuestionBank>()'
2025-10-22 23:23:20.742 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<QuestionBank>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: QuestionBank.BankId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: QuestionBank.CreatedAt (DateTime) Required, 1], [Property: QuestionBank.CreatorId (int) Required FK Index, 2], [Property: QuestionBank.Description (string) MaxLength(500), 3], [Property: QuestionBank.IsActive (bool) Required, 4], [Property: QuestionBank.Name (string) Required MaxLength(100), 5], [Property: QuestionBank.UpdatedAt (DateTime) Required, 6], }
        SELECT q.BankId, q.CreatedAt, q.CreatorId, q.Description, q.IsActive, q.Name, q.UpdatedAt
        FROM QuestionBanks AS q), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, QuestionBank>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:23:20.743 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:20.743 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:20.743 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.743 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.743 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:23:20.745 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "q"."BankId", "q"."CreatedAt", "q"."CreatorId", "q"."Description", "q"."IsActive", "q"."Name", "q"."UpdatedAt"
FROM "QuestionBanks" AS "q"
2025-10-22 23:23:20.745 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionBank' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:20.749 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:20.749 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.750 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.759 +08:00 [INF] 在LoadPages中为QuestionBankViewModel设置用户信息
2025-10-22 23:23:20.760 +08:00 [INF] === QuestionBankViewModel.SetCurrentUser ===
2025-10-22 23:23:20.760 +08:00 [INF] 接收到的用户: teacher (Teacher)
2025-10-22 23:23:20.760 +08:00 [INF] 用户ID: 3
2025-10-22 23:23:20.760 +08:00 [INF] 用户对象是否为null: False
2025-10-22 23:23:20.760 +08:00 [INF] 设置后的CurrentUser: teacher (Teacher)
2025-10-22 23:23:20.760 +08:00 [INF] CurrentUser是否为null: False
2025-10-22 23:23:20.760 +08:00 [INF] QuestionBankViewModel: 用户信息设置完成
2025-10-22 23:23:20.761 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamPaper>()'
2025-10-22 23:23:20.764 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamPaper>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: ExamPaper.PaperId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ExamPaper.AllowRetake (bool) Required, 1], [Property: ExamPaper.AllowViewAnswer (bool) Required, 2], [Property: ExamPaper.CreatedAt (DateTime) Required, 3], [Property: ExamPaper.CreatorId (int) Required FK Index, 4], [Property: ExamPaper.Description (string) MaxLength(500), 5], [Property: ExamPaper.Duration (int) Required, 6], [Property: ExamPaper.EndTime (Nullable<DateTime>), 7], [Property: ExamPaper.IsActive (bool) Required, 8], [Property: ExamPaper.IsPublished (bool) Required, 9], [Property: ExamPaper.IsRandomOrder (bool) Required, 10], [Property: ExamPaper.Name (string) Required MaxLength(100), 11], [Property: ExamPaper.PassScore (decimal) Required, 12], [Property: ExamPaper.StartTime (Nullable<DateTime>), 13], [Property: ExamPaper.Status (string) Required MaxLength(20), 14], [Property: ExamPaper.TotalScore (decimal) Required, 15], [Property: ExamPaper.UpdatedAt (DateTime) Required, 16], }
        SELECT e.PaperId, e.AllowRetake, e.AllowViewAnswer, e.CreatedAt, e.CreatorId, e.Description, e.Duration, e.EndTime, e.IsActive, e.IsPublished, e.IsRandomOrder, e.Name, e.PassScore, e.StartTime, e.Status, e.TotalScore, e.UpdatedAt
        FROM ExamPapers AS e), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamPaper>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:23:20.764 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:20.764 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:20.764 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.764 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.764 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:23:20.766 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:23:20.769 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamPaper' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:20.782 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:20.782 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:20.783 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:20.784 +08:00 [INF] 加载试卷列表成功，共 1 个试卷
2025-10-22 23:23:20.825 +08:00 [INF] 所有页面加载完成
2025-10-22 23:23:20.825 +08:00 [INF] === UpdateViewModelsWithCurrentUser ===
2025-10-22 23:23:20.825 +08:00 [INF] 当前用户: teacher (Teacher)
2025-10-22 23:23:20.825 +08:00 [INF] QuestionBankFrame是否为null: False
2025-10-22 23:23:20.825 +08:00 [INF] QuestionBankFrame.Content是否为null: True
2025-10-22 23:23:20.825 +08:00 [WRN] QuestionBankFrame.Content为null
2025-10-22 23:23:20.825 +08:00 [INF] ExamPaperFrame是否为null: False
2025-10-22 23:23:20.825 +08:00 [INF] ExamPaperFrame.Content是否为null: True
2025-10-22 23:23:20.825 +08:00 [WRN] ExamPaperFrame.Content不是ExamPaperView类型或为null
2025-10-22 23:23:20.825 +08:00 [INF] ExamFrame是否为null: False
2025-10-22 23:23:20.825 +08:00 [INF] ExamFrame.Content是否为null: True
2025-10-22 23:23:20.825 +08:00 [INF] ExamFrame.Content不是StudentExamListView类型（可能为教师/管理员视图）
2025-10-22 23:23:20.825 +08:00 [INF] 所有ViewModel的用户信息已更新
2025-10-22 23:23:20.825 +08:00 [INF] 用户信息设置完成，显示主窗口
2025-10-22 23:23:20.835 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:20.850 +08:00 [INF] 关闭登录窗口
2025-10-22 23:23:20.853 +08:00 [INF] === 登录流程结束 ===
2025-10-22 23:23:20.896 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:21.678 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .Include(er => er.AnswerRecords)
    .Where(er => (int)er.Status == 4 || (int)er.Status == 3 || (int)er.Status == 5)
    .OrderByDescending(er => er.StartTime)'
2025-10-22 23:23:21.684 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 23:23:21.685 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:23:21.685 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 23:23:21.719 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<ExamRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId, u.CreatedAt, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime, e0.Status, e0.TotalScore, e0.UpdatedAt, a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
        FROM ExamRecords AS e
        INNER JOIN Users AS u ON e.UserId == u.UserId
        INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
        LEFT JOIN AnswerRecords AS a ON e.RecordId == a.RecordId
        WHERE e.Status IN (4, 3, 5)
        ORDER BY e.StartTime DESC, e.RecordId ASC, u.UserId ASC, e0.PaperId ASC, a.AnswerId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:23:21.721 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:21.721 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:21.721 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:21.721 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:21.721 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:23:21.723 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:23:21.725 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.737 +08:00 [DBG] Context 'ExamDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.740 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.745 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.745 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'ExamRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] Context 'ExamDbContext' started tracking 'AnswerRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:21.746 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:21.746 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:21.747 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:21.748 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:21.748 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:21.748 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:21.748 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:21.748 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:23:21.749 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:23:21.749 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:21.749 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:21.750 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:21.782 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:21.785 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:24.143 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:24.213 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .Include(r => r.User)
    .Include(r => r.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 23:23:24.213 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:23:24.213 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 23:23:24.214 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 23:23:24.214 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:23:24.214 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 23:23:24.219 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation either via 'Include' or through projection but no 'QuerySplittingBehavior' has been configured. By default Entity Framework will use 'QuerySplittingBehavior.SingleQuery' which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'
2025-10-22 23:23:24.231 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t.UserId0, t.CreatedAt1, t.Email, t.IsActive0, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt, t0.OptionId, t0.Content0, t0.IsCorrect0, t0.OptionLabel, t0.OrderIndex, t0.QuestionId1
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt, u.UserId AS UserId0, u.CreatedAt AS CreatedAt1, u.Email, u.IsActive AS IsActive0, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                INNER JOIN Users AS u ON e.UserId == u.UserId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content AS Content0, q0.IsCorrect AS IsCorrect0, q0.OptionLabel, q0.OrderIndex, q0.QuestionId AS QuestionId1
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
                LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, t.UserId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC, t0.OptionId ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:23:24.232 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:24.232 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:24.232 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.233 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.233 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:23:24.235 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t"."UserId0", "t"."CreatedAt1", "t"."Email", "t"."IsActive0", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt", "t0"."OptionId", "t0"."Content0", "t0"."IsCorrect0", "t0"."OptionLabel", "t0"."OrderIndex", "t0"."QuestionId1"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt1", "u"."Email", "u"."IsActive" AS "IsActive0", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content" AS "Content0", "q0"."IsCorrect" AS "IsCorrect0", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId" AS "QuestionId1"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
    LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."PaperId0", "t"."UserId0", "t0"."AnswerId", "t0"."QuestionId0", "t0"."OptionId"
2025-10-22 23:23:24.238 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.249 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'QuestionOption' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] Context 'ExamDbContext' started tracking 'Question' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.252 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:24.252 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.253 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.255 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .Where(ar => ar.RecordId == __recordId_0 && !(ar.IsGraded))'
2025-10-22 23:23:24.255 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:23:24.258 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        WHERE (a.RecordId == @__recordId_0) && Not(a.IsGraded)), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:23:24.259 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:24.259 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:24.259 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.259 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.260 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:24.261 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:24.261 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:24.261 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.261 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.262 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(r => r.ExamPaper)
    .ThenInclude(p => p.PaperQuestions)
    .FirstOrDefault(r => r.RecordId == __recordId_0)'
2025-10-22 23:23:24.262 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:23:24.262 +08:00 [DBG] Including navigation: 'ExamPaper.PaperQuestions'.
2025-10-22 23:23:24.267 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt0, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, p.Id, p.OrderIndex, p.PaperId, p.QuestionId, p.Score
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt0, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN PaperQuestions AS p ON t.PaperId0 == p.PaperId
            ORDER BY t.RecordId ASC, t.PaperId0 ASC, p.Id ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:23:24.267 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:24.268 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:24.268 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.268 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.268 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:24.269 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:24.270 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] Context 'ExamDbContext' started tracking 'PaperQuestion' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.272 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:24.272 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.273 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.273 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Where(ar => ar.RecordId == __recordId_0)
    .All(ar => ar.IsGraded)'
2025-10-22 23:23:24.274 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT NOT EXISTS (
                Projection Mapping:
                SELECT 1
                FROM AnswerRecords AS a
                WHERE (a.RecordId == @__recordId_0) && Not(a.IsGraded))), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:23:24.274 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:24.274 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:24.274 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.274 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.274 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:24.275 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:24.275 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:24.275 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.276 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.276 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:24.276 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:24.280 +08:00 [DBG] The unchanged property 'ExamRecord.CorrectCount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:23:24.280 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.281 +08:00 [DBG] The unchanged property 'ExamRecord.ObjectiveScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:23:24.282 +08:00 [DBG] The unchanged property 'ExamRecord.TotalScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:23:24.287 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:24.287 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.287 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.287 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:23:24.288 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:23:24.289 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:24.289 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:24.289 +08:00 [DBG] Executing DbCommand [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "ObjectiveScore" = @p1, "TotalScore" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 23:23:24.289 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p3='?', @p0='?', @p1='?', @p2='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "ObjectiveScore" = @p1, "TotalScore" = @p2
WHERE "RecordId" = @p3;
SELECT changes();
2025-10-22 23:23:24.289 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:24.289 +08:00 [DBG] Committing transaction.
2025-10-22 23:23:24.293 +08:00 [DBG] Committed transaction.
2025-10-22 23:23:24.293 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.295 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.295 +08:00 [DBG] Disposing transaction.
2025-10-22 23:23:24.296 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:24.296 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:23:24.296 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 0
2025-10-22 23:23:24.297 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Include(ar => ar.Question)
    .ThenInclude(q => q.Options)
    .Where(ar => ar.RecordId == __recordId_0)
    .OrderBy(ar => ar.Question.QuestionId)'
2025-10-22 23:23:24.297 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:23:24.297 +08:00 [DBG] Including navigation: 'Question.Options'.
2025-10-22 23:23:24.301 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score, q.Tags, q.Title, q.UpdatedAt, q0.OptionId, q0.Content, q0.IsCorrect, q0.OptionLabel, q0.OrderIndex, q0.QuestionId
        FROM AnswerRecords AS a
        INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
        LEFT JOIN QuestionOptions AS q0 ON q.QuestionId == q0.QuestionId
        WHERE a.RecordId == @__recordId_0
        ORDER BY q.QuestionId ASC, a.AnswerId ASC, q0.OptionId ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:23:24.301 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:24.301 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:24.301 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.302 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.302 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 23:23:24.303 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt", "q0"."OptionId", "q0"."Content", "q0"."IsCorrect", "q0"."OptionLabel", "q0"."OrderIndex", "q0"."QuestionId"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
LEFT JOIN "QuestionOptions" AS "q0" ON "q"."QuestionId" = "q0"."QuestionId"
WHERE "a"."RecordId" = @__recordId_0
ORDER BY "q"."QuestionId", "a"."AnswerId", "q0"."OptionId"
2025-10-22 23:23:24.303 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:24.303 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:24.304 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:24.340 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:27.388 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:28.033 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:28.386 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:28.514 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:28.902 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:29.011 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:29.262 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:29.331 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:30.303 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:31.266 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:32.104 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:32.141 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:32.464 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:33.847 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:34.084 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:36.254 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:36.378 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:37.141 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:37.702 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:37.811 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:38.962 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:38.999 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:40.061 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:40.216 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:40.540 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:40.776 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:41.471 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:41.626 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:43.368 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:43.893 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:45.335 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:46.650 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:46.720 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .FirstOrDefault(ar => ar.RecordId == __recordId_0 && ar.QuestionId == __questionId_1)'
2025-10-22 23:23:46.722 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<AnswerRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<AnswerRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
            SELECT TOP(1) a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
            FROM AnswerRecords AS a
            WHERE (a.RecordId == @__recordId_0) && (a.QuestionId == @__questionId_1)), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:23:46.722 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:46.722 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:46.722 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.723 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.723 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:23:46.724 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?', @__questionId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND ("a"."QuestionId" = @__questionId_1)
LIMIT 1
2025-10-22 23:23:46.724 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:46.724 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.725 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.726 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:46.726 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:46.726 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:46.727 +08:00 [DBG] The foreign key property 'AnswerRecord.GraderId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:23:46.731 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:46.731 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.731 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.731 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:23:46.732 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:23:46.734 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:46.734 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:46.734 +08:00 [DBG] Executing DbCommand [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 23:23:46.735 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p10='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
UPDATE "AnswerRecords" SET "AnswerTime" = @p0, "Comment" = @p1, "GradeTime" = @p2, "GraderId" = @p3, "IsCorrect" = @p4, "IsGraded" = @p5, "QuestionId" = @p6, "RecordId" = @p7, "Score" = @p8, "UserAnswer" = @p9
WHERE "AnswerId" = @p10;
SELECT changes();
2025-10-22 23:23:46.735 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:46.735 +08:00 [DBG] Committing transaction.
2025-10-22 23:23:46.739 +08:00 [DBG] Committed transaction.
2025-10-22 23:23:46.739 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.743 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.743 +08:00 [DBG] Disposing transaction.
2025-10-22 23:23:46.743 +08:00 [DBG] An entity of type 'AnswerRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:46.743 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:23:46.744 +08:00 [DBG] Compiling query expression: 
'DbSet<AnswerRecord>()
    .Where(ar => ar.RecordId == __recordId_0 && ar.IsGraded)'
2025-10-22 23:23:46.745 +08:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AnswerRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: AnswerRecord.AnswerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: AnswerRecord.AnswerTime (Nullable<DateTime>), 1], [Property: AnswerRecord.Comment (string), 2], [Property: AnswerRecord.GradeTime (Nullable<DateTime>), 3], [Property: AnswerRecord.GraderId (Nullable<int>) FK Index, 4], [Property: AnswerRecord.IsCorrect (bool) Required, 5], [Property: AnswerRecord.IsGraded (bool) Required, 6], [Property: AnswerRecord.QuestionId (int) Required FK Index, 7], [Property: AnswerRecord.RecordId (int) Required FK Index, 8], [Property: AnswerRecord.Score (decimal) Required, 9], [Property: AnswerRecord.UserAnswer (string), 10], }
        SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer
        FROM AnswerRecords AS a
        WHERE (a.RecordId == @__recordId_0) && a.IsGraded), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AnswerRecord>, 
    ExamSystem.Data.ExamDbContext, 
    False, 
    False
)'
2025-10-22 23:23:46.745 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:46.745 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:46.745 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.746 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.746 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 23:23:46.747 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "AnswerRecords" AS "a"
WHERE ("a"."RecordId" = @__recordId_0) AND "a"."IsGraded"
2025-10-22 23:23:46.747 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:46.747 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.748 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.749 +08:00 [DBG] Compiling query expression: 
'DbSet<ExamRecord>()
    .Include(er => er.AnswerRecords)
    .ThenInclude(ar => ar.Question)
    .Include(er => er.User)
    .Include(er => er.ExamPaper)
    .FirstOrDefault(er => er.RecordId == __recordId_0)'
2025-10-22 23:23:46.749 +08:00 [DBG] Including navigation: 'ExamRecord.AnswerRecords'.
2025-10-22 23:23:46.749 +08:00 [DBG] Including navigation: 'ExamRecord.User'.
2025-10-22 23:23:46.749 +08:00 [DBG] Including navigation: 'ExamRecord.ExamPaper'.
2025-10-22 23:23:46.749 +08:00 [DBG] Including navigation: 'AnswerRecord.Question'.
2025-10-22 23:23:46.772 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<ExamRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<ExamRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.SelectExpression(
            Projection Mapping:
            SELECT t.RecordId, t.CorrectCount, t.CreatedAt, t.EndTime, t.GradedAt, t.GraderId, t.IsPassed, t.ObjectiveScore, t.PaperId, t.RemainingTime, t.StartTime, t.Status, t.SubjectiveScore, t.SubmitTime, t.TotalCount, t.TotalScore, t.UserId, t.UserId0, t.CreatedAt0, t.Email, t.IsActive, t.LastLoginAt, t.LockoutEnd, t.LoginFailCount, t.PasswordHash, t.Phone, t.RealName, t.Role, t.Username, t.PaperId0, t.AllowRetake, t.AllowViewAnswer, t.CreatedAt1, t.CreatorId, t.Description, t.Duration, t.EndTime0, t.IsActive0, t.IsPublished, t.IsRandomOrder, t.Name, t.PassScore, t.StartTime0, t.Status0, t.TotalScore0, t.UpdatedAt, t0.AnswerId, t0.AnswerTime, t0.Comment, t0.GradeTime, t0.GraderId, t0.IsCorrect, t0.IsGraded, t0.QuestionId, t0.RecordId, t0.Score, t0.UserAnswer, t0.QuestionId0, t0.Analysis, t0.Answer, t0.BankId, t0.Content, t0.CreatedAt, t0.Difficulty, t0.IsActive, t0.QuestionType, t0.Score0, t0.Tags, t0.Title, t0.UpdatedAt
            FROM Projection Mapping:
            (
                SELECT TOP(1) e.RecordId, e.CorrectCount, e.CreatedAt, e.EndTime, e.GradedAt, e.GraderId, e.IsPassed, e.ObjectiveScore, e.PaperId, e.RemainingTime, e.StartTime, e.Status, e.SubjectiveScore, e.SubmitTime, e.TotalCount, e.TotalScore, e.UserId, u.UserId AS UserId0, u.CreatedAt AS CreatedAt0, u.Email, u.IsActive, u.LastLoginAt, u.LockoutEnd, u.LoginFailCount, u.PasswordHash, u.Phone, u.RealName, u.Role, u.Username, e0.PaperId AS PaperId0, e0.AllowRetake, e0.AllowViewAnswer, e0.CreatedAt AS CreatedAt1, e0.CreatorId, e0.Description, e0.Duration, e0.EndTime AS EndTime0, e0.IsActive AS IsActive0, e0.IsPublished, e0.IsRandomOrder, e0.Name, e0.PassScore, e0.StartTime AS StartTime0, e0.Status AS Status0, e0.TotalScore AS TotalScore0, e0.UpdatedAt
                FROM ExamRecords AS e
                INNER JOIN Users AS u ON e.UserId == u.UserId
                INNER JOIN ExamPapers AS e0 ON e.PaperId == e0.PaperId
                WHERE e.RecordId == @__recordId_0
            ) AS t
            LEFT JOIN Projection Mapping:
            (
                SELECT a.AnswerId, a.AnswerTime, a.Comment, a.GradeTime, a.GraderId, a.IsCorrect, a.IsGraded, a.QuestionId, a.RecordId, a.Score, a.UserAnswer, q.QuestionId AS QuestionId0, q.Analysis, q.Answer, q.BankId, q.Content, q.CreatedAt, q.Difficulty, q.IsActive, q.QuestionType, q.Score AS Score0, q.Tags, q.Title, q.UpdatedAt
                FROM AnswerRecords AS a
                INNER JOIN Questions AS q ON a.QuestionId == q.QuestionId
            ) AS t0 ON t.RecordId == t0.RecordId
            ORDER BY t.RecordId ASC, t.UserId0 ASC, t.PaperId0 ASC, t0.AnswerId ASC, t0.QuestionId0 ASC), 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, ExamRecord>, 
        ExamSystem.Data.ExamDbContext, 
        False, 
        False
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-22 23:23:46.772 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:46.772 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:46.772 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.773 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.773 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 23:23:46.775 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."UserId0", "t"."CreatedAt0", "t"."Email", "t"."IsActive", "t"."LastLoginAt", "t"."LockoutEnd", "t"."LoginFailCount", "t"."PasswordHash", "t"."Phone", "t"."RealName", "t"."Role", "t"."Username", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt1", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive0", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "t0"."AnswerId", "t0"."AnswerTime", "t0"."Comment", "t0"."GradeTime", "t0"."GraderId", "t0"."IsCorrect", "t0"."IsGraded", "t0"."QuestionId", "t0"."RecordId", "t0"."Score", "t0"."UserAnswer", "t0"."QuestionId0", "t0"."Analysis", "t0"."Answer", "t0"."BankId", "t0"."Content", "t0"."CreatedAt", "t0"."Difficulty", "t0"."IsActive", "t0"."QuestionType", "t0"."Score0", "t0"."Tags", "t0"."Title", "t0"."UpdatedAt"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId" AS "UserId0", "u"."CreatedAt" AS "CreatedAt0", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt1", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive" AS "IsActive0", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId" AS "QuestionId0", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score" AS "Score0", "q"."Tags", "q"."Title", "q"."UpdatedAt"
    FROM "AnswerRecords" AS "a"
    INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
) AS "t0" ON "t"."RecordId" = "t0"."RecordId"
ORDER BY "t"."RecordId", "t"."UserId0", "t"."PaperId0", "t0"."AnswerId", "t0"."QuestionId0"
2025-10-22 23:23:46.775 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:46.775 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.776 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.776 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:46.777 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:46.777 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:46.777 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:46.777 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.777 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.777 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:23:46.778 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:23:46.779 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:46.779 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:46.779 +08:00 [DBG] Executing DbCommand [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 23:23:46.780 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p16='?', @p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "CorrectCount" = @p0, "CreatedAt" = @p1, "EndTime" = @p2, "GradedAt" = @p3, "GraderId" = @p4, "IsPassed" = @p5, "ObjectiveScore" = @p6, "PaperId" = @p7, "RemainingTime" = @p8, "StartTime" = @p9, "Status" = @p10, "SubjectiveScore" = @p11, "SubmitTime" = @p12, "TotalCount" = @p13, "TotalScore" = @p14, "UserId" = @p15
WHERE "RecordId" = @p16;
SELECT changes();
2025-10-22 23:23:46.780 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:46.780 +08:00 [DBG] Committing transaction.
2025-10-22 23:23:46.784 +08:00 [DBG] Committed transaction.
2025-10-22 23:23:46.784 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:46.787 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:46.787 +08:00 [DBG] Disposing transaction.
2025-10-22 23:23:46.787 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:46.787 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:23:46.787 +08:00 [INF] 人工评分成功：RecordId=7, QuestionId=14, Score=2
2025-10-22 23:23:46.822 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:50.590 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:50.719 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:50.719 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:50.719 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.719 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.719 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:50.721 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:50.721 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:50.721 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.722 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.722 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:50.722 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:50.722 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.722 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.722 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:50.723 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:50.723 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:50.723 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.724 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.724 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:50.724 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:50.724 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.724 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.724 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:50.725 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:50.725 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:50.725 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.726 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.726 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:50.726 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:50.726 +08:00 [DBG] The unchanged property 'ExamRecord.TotalScore' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-22 23:23:50.726 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:50.726 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:50.726 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.727 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.727 +08:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-22 23:23:50.727 +08:00 [DBG] Began transaction with isolation level 'Serializable'.
2025-10-22 23:23:50.727 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:50.727 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:50.727 +08:00 [DBG] Executing DbCommand [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "TotalScore" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 23:23:50.728 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?', @p0='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "ExamRecords" SET "TotalScore" = @p0
WHERE "RecordId" = @p1;
SELECT changes();
2025-10-22 23:23:50.728 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:50.728 +08:00 [DBG] Committing transaction.
2025-10-22 23:23:50.731 +08:00 [DBG] Committed transaction.
2025-10-22 23:23:50.731 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:50.734 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:50.734 +08:00 [DBG] Disposing transaction.
2025-10-22 23:23:50.734 +08:00 [DBG] An entity of type 'ExamRecord' tracked by 'ExamDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-22 23:23:50.734 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 1 entities written to the database.
2025-10-22 23:23:50.734 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 0
2025-10-22 23:23:50.734 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:51.293 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:51.293 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:51.293 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:51.294 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:51.294 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:51.296 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:51.296 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:51.296 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:51.296 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:51.297 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:51.297 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:51.297 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:51.297 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:51.297 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:51.298 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:51.298 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:51.298 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:51.299 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:51.299 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:51.299 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:51.299 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:51.299 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:51.299 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:51.300 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:51.300 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:51.300 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:51.301 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:51.301 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:51.301 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:51.301 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:51.301 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 0 entities written to the database.
2025-10-22 23:23:51.301 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 0
2025-10-22 23:23:51.302 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:52.209 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.209 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.209 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.210 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.210 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:52.211 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:52.212 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.212 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.212 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.212 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.212 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.212 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.213 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.213 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:52.214 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:52.214 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.214 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.215 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.215 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.215 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.215 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.215 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.215 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:52.216 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:52.216 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.216 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.217 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.217 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:52.217 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:52.217 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:52.217 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 0 entities written to the database.
2025-10-22 23:23:52.217 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 0
2025-10-22 23:23:52.218 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:52.651 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.651 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.651 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.652 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.652 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:52.653 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:52.653 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.653 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.654 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.654 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.654 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.654 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.654 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.654 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:52.656 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:52.656 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.656 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.656 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.657 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.657 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.657 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.657 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.657 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:52.658 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:52.658 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.658 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.658 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.658 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:52.658 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:52.659 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:52.659 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 0 entities written to the database.
2025-10-22 23:23:52.659 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 0
2025-10-22 23:23:52.670 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:52.893 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.893 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.893 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.894 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.894 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:52.895 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:52.895 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.895 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.896 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.896 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.896 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.896 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.896 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.897 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:52.897 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:52.898 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.898 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.898 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.898 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:52.898 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:52.898 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.898 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.899 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:52.899 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:52.899 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:52.899 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:52.900 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:52.900 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:52.900 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:52.900 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:52.900 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 0 entities written to the database.
2025-10-22 23:23:52.900 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 0
2025-10-22 23:23:52.901 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:53.126 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:53.126 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:53.126 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:53.126 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:53.126 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:53.128 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer", "q"."QuestionId", "q"."Analysis", "q"."Answer", "q"."BankId", "q"."Content", "q"."CreatedAt", "q"."Difficulty", "q"."IsActive", "q"."QuestionType", "q"."Score", "q"."Tags", "q"."Title", "q"."UpdatedAt"
FROM "AnswerRecords" AS "a"
INNER JOIN "Questions" AS "q" ON "a"."QuestionId" = "q"."QuestionId"
WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded")
2025-10-22 23:23:53.128 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:53.128 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:53.129 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:53.129 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:53.129 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:53.129 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:53.129 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:53.129 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:53.130 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RecordId", "t"."CorrectCount", "t"."CreatedAt", "t"."EndTime", "t"."GradedAt", "t"."GraderId", "t"."IsPassed", "t"."ObjectiveScore", "t"."PaperId", "t"."RemainingTime", "t"."StartTime", "t"."Status", "t"."SubjectiveScore", "t"."SubmitTime", "t"."TotalCount", "t"."TotalScore", "t"."UserId", "t"."PaperId0", "t"."AllowRetake", "t"."AllowViewAnswer", "t"."CreatedAt0", "t"."CreatorId", "t"."Description", "t"."Duration", "t"."EndTime0", "t"."IsActive", "t"."IsPublished", "t"."IsRandomOrder", "t"."Name", "t"."PassScore", "t"."StartTime0", "t"."Status0", "t"."TotalScore0", "t"."UpdatedAt", "p"."Id", "p"."OrderIndex", "p"."PaperId", "p"."QuestionId", "p"."Score"
FROM (
    SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "e0"."PaperId" AS "PaperId0", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt" AS "CreatedAt0", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime" AS "EndTime0", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime" AS "StartTime0", "e0"."Status" AS "Status0", "e0"."TotalScore" AS "TotalScore0", "e0"."UpdatedAt"
    FROM "ExamRecords" AS "e"
    INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
    WHERE "e"."RecordId" = @__recordId_0
    LIMIT 1
) AS "t"
LEFT JOIN "PaperQuestions" AS "p" ON "t"."PaperId0" = "p"."PaperId"
ORDER BY "t"."RecordId", "t"."PaperId0", "p"."Id"
2025-10-22 23:23:53.130 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:53.130 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:53.131 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:53.131 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:53.131 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:53.131 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:53.132 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:53.132 +08:00 [DBG] Executing DbCommand [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:53.133 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__recordId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT NOT EXISTS (
    SELECT 1
    FROM "AnswerRecords" AS "a"
    WHERE ("a"."RecordId" = @__recordId_0) AND NOT ("a"."IsGraded"))
2025-10-22 23:23:53.133 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:53.133 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:53.133 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:53.133 +08:00 [DBG] SaveChanges starting for 'ExamDbContext'.
2025-10-22 23:23:53.133 +08:00 [DBG] DetectChanges starting for 'ExamDbContext'.
2025-10-22 23:23:53.134 +08:00 [DBG] DetectChanges completed for 'ExamDbContext'.
2025-10-22 23:23:53.134 +08:00 [DBG] SaveChanges completed for 'ExamDbContext' with 0 entities written to the database.
2025-10-22 23:23:53.134 +08:00 [INF] 自动评分完成，记录ID: 7，客观题得分: 0
2025-10-22 23:23:53.155 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:59.826 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:23:59.950 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:59.951 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:59.951 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:59.951 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:59.951 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:23:59.953 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."RecordId", "e"."CorrectCount", "e"."CreatedAt", "e"."EndTime", "e"."GradedAt", "e"."GraderId", "e"."IsPassed", "e"."ObjectiveScore", "e"."PaperId", "e"."RemainingTime", "e"."StartTime", "e"."Status", "e"."SubjectiveScore", "e"."SubmitTime", "e"."TotalCount", "e"."TotalScore", "e"."UserId", "u"."UserId", "u"."CreatedAt", "u"."Email", "u"."IsActive", "u"."LastLoginAt", "u"."LockoutEnd", "u"."LoginFailCount", "u"."PasswordHash", "u"."Phone", "u"."RealName", "u"."Role", "u"."Username", "e0"."PaperId", "e0"."AllowRetake", "e0"."AllowViewAnswer", "e0"."CreatedAt", "e0"."CreatorId", "e0"."Description", "e0"."Duration", "e0"."EndTime", "e0"."IsActive", "e0"."IsPublished", "e0"."IsRandomOrder", "e0"."Name", "e0"."PassScore", "e0"."StartTime", "e0"."Status", "e0"."TotalScore", "e0"."UpdatedAt", "a"."AnswerId", "a"."AnswerTime", "a"."Comment", "a"."GradeTime", "a"."GraderId", "a"."IsCorrect", "a"."IsGraded", "a"."QuestionId", "a"."RecordId", "a"."Score", "a"."UserAnswer"
FROM "ExamRecords" AS "e"
INNER JOIN "Users" AS "u" ON "e"."UserId" = "u"."UserId"
INNER JOIN "ExamPapers" AS "e0" ON "e"."PaperId" = "e0"."PaperId"
LEFT JOIN "AnswerRecords" AS "a" ON "e"."RecordId" = "a"."RecordId"
WHERE "e"."Status" IN (4, 3, 5)
ORDER BY "e"."StartTime" DESC, "e"."RecordId", "u"."UserId", "e0"."PaperId", "a"."AnswerId"
2025-10-22 23:23:59.953 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:59.953 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:59.953 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:59.954 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-22 23:23:59.954 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-22 23:23:59.954 +08:00 [DBG] Opening connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:59.954 +08:00 [DBG] Opened connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:59.954 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:23:59.955 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."PaperId", "e"."AllowRetake", "e"."AllowViewAnswer", "e"."CreatedAt", "e"."CreatorId", "e"."Description", "e"."Duration", "e"."EndTime", "e"."IsActive", "e"."IsPublished", "e"."IsRandomOrder", "e"."Name", "e"."PassScore", "e"."StartTime", "e"."Status", "e"."TotalScore", "e"."UpdatedAt"
FROM "ExamPapers" AS "e"
2025-10-22 23:23:59.955 +08:00 [DBG] A data reader was disposed.
2025-10-22 23:23:59.955 +08:00 [DBG] Closing connection to database 'main' on server 'E:\Project\exam_trae\exam_system.db'.
2025-10-22 23:23:59.955 +08:00 [DBG] Closed connection to database 'main' on server 'exam_system.db'.
2025-10-22 23:23:59.987 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:24:01.126 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:24:01.224 +08:00 [INF] 用户已退出登录，清空当前用户状态
2025-10-22 23:24:01.281 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:24:02.454 +08:00 [INF] PermissionService.HasPermission: Role=Teacher, Operation=SendNotification, Result=True
2025-10-22 23:24:02.490 +08:00 [DBG] 'ExamDbContext' disposed.
